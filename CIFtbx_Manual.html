<!DOCTYPE html>
<html>
<head>
                                                                                                                                                                                                                                                                         </head>
<body>
<font face="Arial,Helvetica,Times" size="3">
<center>
<font size="+2"><img src="CIFtbx_logo.gif" alt="CIFtbx"></font><br />
<font size="+3">
<b>Manual</b><br />
</font>
by<br />
Herbert J. Bernstein<br />
and<br />
Sydney R. Hall<br />
Copyright &copy; 1997, 1998, 2024<br />
All Rights Reserved
<p>
</center>
<h2 align="center">Preface</h2>
<p> 
The Crystallographic Information File (CIF) format is one of the most commonly used electronic data handling 
protocols in chemistry and crystallography for exchanging and archiving structural and diffraction information. 
Because the CIF syntax requirements and data definitions are coordinated and supported by the International 
Union of Crystallography as part of their publishing and archival activities, there is established support 
for this format both in database entry and in retrieval tasks. This spawned the need to develop more comprehensive 
software for generating, reading and manipulating CIF data for a wide
range of scientific domains.  Two good starting points to find appropriate CIF resources are the IUCr web site 
<a href="https://www.iucr.org/resources/cif">https://www.iucr.org/resources/cif</a> and searches in GitHub <a href="http://github.com">http://github.com</a>
for the phrases &quot;Crystallographic Information File&quot; and &quot;Crystallographic Information Framework&quot;
<p> 
This book is an instruction and reference manual for programmers employing the 
CIFtbx library of Fortran functions to develop CIF applications.  
The most recent releases of the <i>CIFtbx</i> library are open source software.  You
may redistribute this software and/or modify this software under the
terms of the GNU General Public License as published by the Free
Software Foundation; either version 2 of the License
<A href="https://www.gnu.org/licenses/old-licenses/gpl-2.0.en.html">https://www.gnu.org/licenses/old-licenses/gpl-2.0.en.html</a>, or (at your
option) any later version.

Alternatively you may redistribute and/or modify the <i>CIFtbx</i> API (but not
the programs) under the terms of the GNU Lesser General Public License
as published by the Free Software Foundation; either version 2.1 of the
License
<A href="https://www.gnu.org/licenses/old-licenses/lgpl-2.1.en.html">https://www.gnu.org/licenses/old-licenses/lgpl-2.1.en.html</a>,
 or (at your option) 
any later version.

This book itself is part of <i>CIFtbx</i> version 4.1.1 library release, and as such may be redistributed and/or modified under the terms
of the GPL.  In addition, this book, as a document, alternatively may be distributed, remixed, adapted, and build upon in any medium 
or format, even for commercial purposes under the terms of the CC BY-SA 4.0 license published by Creative Commons (CC)
<a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode.en">https://creativecommons.org/licenses/by-sa/4.0/legalcode.en</a>

<p> 
The <i>CIFtbx</i> library and this manual are intended for both novices and experts of CIF applications. 
The toolbox has already been used in the development of CIF manipulation programs such as Cyclops 
<a href="#Bernstein_Hall_1998">[Bernstein, Hall, 1998]</a>, 
CIFIO <a href="#Hall_1993">[Hall, 1993], 
CIF2CIF <a href="#Bernstein_1997">[Bernstein, 1997]</a>, 
pdb2cif <a href="Bernstein_Bernstein_Bourne_1998">[Bernstein, Bernstein, Bourne, 1998]</a>
and cif2pdb <a href="#Bernstein_Bernstein_1996">[Bernstein, Bernstein, 1996]</a>. 
Extracts from some of these applications are used herein to illustrate various programming approaches. 
<p> 
This edition of the manual is for use with <i>CIFtbx</i> version 4.1.1. Scientific papers on <i>CIFtbx</i>
<a href="#Hall_1993a">[Hall, 1993a]</a>
<a href="#Hall_Bernstein_1996">[Hall, Bernstein, 1996]</a>
provide background information on earlier versions of the tool box but lack the detail 
of a reference manual. The <i>CIFtbx</i> tools described in this manual are appropriate for 
many current CIF applications and dictionaries. This includes the access and application 
of data definitions in dictionaries based on the definition language DDL1
<a href="#Hall_Cook_1995">[Hall, Cook, 1995]</a>,
 and on the extended language DDL2
<a href="#Westbrook_Hall_1995">[Westbrook, Hall, 1995]</a> 
such as the macromolecular dictionary 
<a href="#Fitzgerald_et_al_1996">[Fitzgerald <i>et al.</i>, 1996], as well as some 
aspects of the most recent versions of CIF, CIF 2.0 
<a href="#Bernstein_Brown_Gra&zcaron;ulis_2016">[Bernstein, Brown, Gra&zcaron;ulis <i>et al.</i>, 2016]</a>
and of the most recent Dictionary Definition Language, DDLm <a href="#Spadaccini_Hall_2012">[Spadaccini, Hall, 2012]</a>
<p> 
The first two chapters of the manual introduce the general concepts of the CIF syntax and 
are intended for programmers who have no prior knowledge of this format. This is the 
initial primer information. Later chapters give detailed explanations on the 21 functions 
and 36 variables that make up the tools, and how they are applied to simple and complex tasks. 
The appendices at the end of the manual explain how to implement the tool box software on 
your computer, and provide background information on the DDL used to define CIF data items, 
and to construct CIF dictionaries.
<p> 

<h2 align="center">CONTENTS</h2>
<p> 
<a href="#Preface">Preface</a>
<p>
<a href="#Recent_History_and_Acknowledgements">Recent History and Acknowledgements</a>
<p>
<a href="#Primer_Section">Primer Section</a> 
<p>
<a href="#CHAPTER_1">1. What is a CIF?</a>
<ul>
<li><a href="#1.1">1.1. Introduction</a></li>
<li><a href="#1.2">1.2. Basic syntax</a></li>
<li><a href="#1.3">1.3. Case sensitivity</a></li>
<li><a href="#1.4">1.4. Special characters</a></li>
<li><a href="#1.5">1.5. Syntax control words</a></li>
<li><a href="#1.6">1.6. File examples</a></li>
<li><a href="#1.7">1.7. Data definitions</a></li>
<li><a href="#1.8">1.8. Handling DDL1 and DDL2 name structures</a></li>
</ul>
<p>
<a href="#CHAPTER_2">2. Overview of the Tool Box</a>
<ul>
<li><a href="#2.1">2.1. Introduction</a></li>
<li><a href="#2.2">2.2. Initialisation Commands</a></li>
<li><a href="#2.3">2.3. Read Commands</a></li>
<li><a href="#2.4">2.4. Write Commands</a></li>
<li><a href="#2.5">2.5. Variables</a></li>
<li><a href="#2.6">2.6. Name Aliases</a></li>
</ul>
<p>
<a href="#CHAPTER_3">3. How to Use the Tool Box</a>
<ul>
<li><a href="#3.1">3.1. Introduction</a></li>
<li><a href="#3.2">3.2. Reading CIF data</a></li>
<li><a href="#3.3">3.3. Reading text data in loops</a></li>
<li><a href="#3.4">3.4. Reading user-requested data items</a></li>
<li><a href="#3.5">3.5. Creating a CIF</a></li>
<li><a href="#3.6">3.6. General tips on applying <i>CIFtbx</i></a></li>
<li><a href="#3.6.1">3.6.1. Reading a CIF</a></li>
<li><a href="#3.6.2">3.6.2. Writing a CIF</a></li>
<li><a href="#3.6.3">3.6.3. Program organisation</a></li>
</ul>
<p>
<a href="#Reference_Section">Reference Section</a>
<p> 
<a href="#CHAPTER_4">4. Initialisation Functions</a>
<p>
<ul>
<li><a href="#4.1">4.1. Introduction</a></li>
<li><a href="#4.2">4.2. init_</a></li>
<li><a href="#4.3">4.3. dict_</a></li>
</ul>
<p>
<a href="#CHAPTER_5">5. Read Functions</a>
<ul>
<li><a href="#5.1">5.1. Introduction</a></li>
<li><a href="#5.2">5.2. ocif_</a></li>
<li><a href="#5.3">5.3. data_</a></li>
<li><a href="#5.4">5.4. bkmrk_</a></li>
<li><a href="#5.5">5.5. find_</a></li>
<li><a href="#5.6">5.6. test_</a></li>
<li><a href="#5.7">5.7. name_</a></li>
<li><a href="#5.8">5.8. numb_</a></li>
<li><a href="#5.9">5.9. numd_</a></li>
<li><a href="#5.10">5.10. cmnt_</a></li>
<li><a href="#5.11">5.11. purge_</a></li>
</ul>
<p>
<a href="#CHAPTER_6">6. Write Functions</a>
<ul>
<li><a href="#6.1">6.1. Introduction</a></li>
<li><a href="#6.2">6.2. pfile_</a></li>
<li><a href="#6.3">6.3. pdata_</a></li>
<li><a href="#6.4">6.4. ploop_</a></li>
<li><a href="#6.5">6.5. pchar_</a></li>
<li><a href="#6.6">6.6. pcmnt_</a></li>
<li><a href="#6.7">6.7. pnumb_</a></li>
<li><a href="#6.8">6.8. pnumd_</a></li>
<li><a href="#6.9">6.9. ptext_</a></li>
<li><a href="#6.10">6.10. prefx_</a></li>
<li><a href="#6.11">6.11. close_</a></li>
</ul>
<p>
<a href="#CHAPTER_7">7. Variables</a>
<p>
<a href="#CHAPTER_8">8. Error Message Glossary</a>
<ul>
<li><a href="#Fatal_Errors">Fatal Errors</a>
<ul>
<li><a href="#Array_Bounds">Array Bounds</a></li>
<li><a href="#Data_Sequence">Data Sequence, Syntax and File Construction</a></li>
<li><a href="#Invalid_Arguments">Invalid Arguments</a></li>
</ul></li>
<li><a href="#Warnings">Warnings</a>
<ul>
<li><a href="#Output_Errors">Output Errors</a></li>
<li><a href="#Dictionary_Checks">Dictionary Checks</a></li>
</ul></li>
</ul>
<p>
<a href="#Appendices">Appendices</a>
<ul>
<li><a href="#APPENDIX_A">A. Usage Restrictions and Policy</a>
<ul>
<li><a href="#GPL">GPL</a></li>
<li><a href="#LGPL">LGPL</a></li>
<li><a href="#RASLIC">RASLIC</a></li>
<li><a href="#IUCR_POLICY">IUCr Policy</a></li>
</ul></li>
<li><a href="#APPENDIX_B">B. Installation of <i>CIFtbx</i></a>
<ul>
<li>Quick Installation</li>
<li>Detailed Installation Instructions</li>
<li>Reporting Problems</li>
</ul></li>
<li><a href="#APPENDIX_C">C. CYCLOPS2</a>
<ul>
<li>CYCLOPS2 overview</li>
<li>Error Message Glossary</li>
</ul></li>
<li><a href="#APPENDIX_D">D. Syntax of a Star File</li>
<li><a href="#APPENDIX_E">E. Internals and Programming Style</li>
</ul></li>
<p> 
<a href="References">References</a>
<p>
<a href="Index">Index</a>
<p>
<h2 id="Recent_History_and_Acknowledgements" align="center">Recent History and Acknowledgements</h2> 
The CIF format was first adopted by the IUCr for journal submissions in 1990, following 
the publication of the CIF core dictionary 
<a href="#Hall_Allen_Brown_1991">[Hall, Allen, Brown, 1991]</a>.
Since then there has been continual growth in the use of CIFs and in the development of 
software for CIF 
generation and manipulation. In the early 1990's there had been appreciable changes to 
the nature of CIF applications. These 
have been brought about largely because of new data definitions in the macromolecular CIF 
dictionary
<a href="#Bourne_et_al_1996">[Bourne <i>et al.</i>, 1996]</a>
and <a href="#Fitzgerald_et_al_1996">[Fitzgerald <i>et al.</i>, 1996]</a> 
This, and the powder diffraction dictionary
<a href="#Toby_von_Dreele_Larson_2003">[Toby, von Dreele, Larson, 2003]</a>, 
were adopted by the IUCr in June 1997 as standards for exchanging 
crystallographic data in these fields. The adoption of the macromolecular dictionary, in 
particular, signaled a watershed in the 
way that this type of structural data will be handled in the future.
<p>
One recent impetus for newer and more versatile versions of <i>CIFtbx</i> was to 
assist one of us (HJB) in using CIF data derived 
from Protein Data Bank files 
<a href="#Bernstein_et_al_1977">[Bernstein, <i>et al.</i>, 1977]</a>. In the 
development of pdb2cif [Bernstein, Bernstein, Bourne 98], <i>CIFtbx</i>2 enabled hundreds of CIF 
data names, embedded in existing software, 
to be mapped into the DDL2 format, and for the existence of these items to be checked. 
<i>CIFtbx</i>2 was used in a release of 
the Xtal 3.5 System [Hall, King, Stewart 95], and in the upgrade of CYCLOPS to CYCLOPS2 
[Hall, Bernstein 96] (see Appendix C). It 
has provided the platform for the creation of cif2cif, a program which checks and 
reformats CIFs. <i>CIFtbx</i>2 was used for rapid adaptation 
of a command-line driven lattice identification program to CIF [Bernstein, Andrews 96] 
<p>
A primary objective with this toolbox has been to preserve the functionality of all dictionaries written the core dictionary language 
DDL1 while providing a seamless link to the richer DDL2 dictionaries. During this development we have leaned heavily on the cooperation 
of our colleagues and collaborators. Many people have contributed to the CIF development and although we are certain to not mention 
many workers who have given valuable help at some stage, we must highlight the special recent efforts of Helen Berman, Frances 
Bernstein, Phil Bourne, Paula Fitzgerald, Brian McMahon and John Westbrook. 
<p>
<h1 id="CHAPTER_1" align="center">
CHAPTER 1
</h1>
<h2 id="What_is_a_CIF" align="center"> 
What is a CIF?
</h2>
<h3 id="1.1" align="left">1.1. Introduction 
</h3>
<p>
What is a CIF? To a crystallographer or a structural chemist, it is a simple and flexible way 
of storing and exchanging 
numerical or text data electronically. The letters C-I-F stand for Crystallographic Information 
File [Hall, Allen, Brown 91]. 
A CIF is a text file that can be easily read by humans or computers because of its very simple format. The rules governing 
this format are a subset of the general syntax of the Self-Defining Text Archive and Retrieval (STAR) File [Hall, 91]. 
<p>
The CIF format is extremely flexible. Data items may be placed anywhere in a file or a line, and in any order, provided 
that each data value is preceded by an identifying label. Here is an extract from a CIF. The data values are in bold type 
and the data identifiers (or names) are strings starting with an underscore.
<p>
<center><table border=1><tr><td><pre>
_crystal_habit          <b>irregular_tetrahedron</b> 
_crystal_colour         <b>'blue green'</b> 
_crystal_density        <b>1.765(4)</b> 
loop_ 
    _crystal_face_index_h 
    _crystal_face_index_k 
    _crystal_face_index_l 
    _crystal_face_dist_from_centre # in millimetres 
<b>          1    1    1   0.25 
         -1   -1    1   0.27 
          1   -1   -1   0.25 
         -1    1   -1   0.29</b> 
_crystal_preparation
<b>; The compound is crystallised from ethanol by slow 
evaporation. 
<b>;</pre></td></tr></table></center>
<p>
<h3 id="1.2" align="left">1.2. Basic syntax 
</h3>
<p>
The above example illustrates many of the basic principles of a CIF.
<ol>
<li>All contents are plain text.  The definition of "plain" text is system
dependent.  For modern unix compatible systems, that is most likely to be <i>ascii</i>
or Unicode utf8 text</li>
<li>Each <i>data value</i> (shown above in bold) must be preceded by an identifying 
<i>data name</i>.</li>
<li>A <i>data name</i> (or tag) is a character string starting with an underscore character.</li>
<li><i>Data values</i> are of three basic types: number strings, character strings and text strings.
<ul>
<li>A <i>number string</i> may be in integer, decimal or scientific notation. 
Numbers may have an error 
estimate appended within parentheses (see <tt>_crystal_density</tt> above), 
if this is allowed by the data definition (see DDL description below).</li> 
<li>A character string is a sequence of characters that is not a number; 
not preceded by an underscore, 
and does not exceed a system-dependent number of
characters in length. For all versions of CIF it is possible for
a string to be as long as 78 characters, and for most modern versions
of CIF and most modern computer systems, a string may be as long
as 2046 characters.  If the string contains blanks it must be 
surrounded by quote characters (see <tt>_crystal_habit</tt>).</li>
<li>A text string may be one or more lines in length and must be bounded by 
semicolons in column 1 preceding the first 
character, and following the last character (see <tt>_crystal_preparation</tt>). 
Unless the data definition imposes more restrictive 
rules, a text string may be used any place where a character string might be expected.</li>
</ul>
</li>
<li>Lists of repeated data values are to be preceded by data names in matching order. Such lists must be preceded by a loop_ command.</li> 
<li>A data name and its value (i.e. <i>tag/value pair</i>, or <i>tuple</i>) are referred to as
a <i>data item</i>. Data items are grouped into data 
blocks. A data block is preceded by a <tt>data_</tt>&lt;name&gt; command. The &lt;name&gt; string is 
referred to as the data block name and this 
must be unique within a CIF.</li>
<li>Within a data block, each data name must be unique.</li> 
<li>A CIF is restricted to 80-character lines.</li>
<li>The hash character '#' is used to start a comment on a line.</li>
</ol>
<p>
<h3 id="1.3" align="left">
1.3. Case sensitivity. 
</h3>
<p>
Data names are not sensitive to the case of letters. For example, the strings
<p> 
<pre>
                _ATOM_SITE_CARTN_X 
                _atom_site_cartn_x 
                _AtOm_SiTe_CaRtN_x</pre>
<p> 
all represent the identical data name in a CIF. Strings that are not data names are case sensitive in that the case of letters must always be preserved. 
<p>
<h3 id="1.4" align="left">
1.4. Special characters 
</h3>
<p>
Certain characters in a CIF serve a special function when used in a particular way. 
A brief summary of these is given below. For more detail see 
<a href="Hall_Spadaccini_1994">[Hall, Spadaccini, 1994]</a>.
<p>
<table border=0> 
<tr><td valign="top">_</td><td>the underscore (underline) is used to start a 
data name, or to end of a command string, such as <tt>loop_</tt>. 
They terminate <i>CIFtbx</i> function and variable names. They sometimes are used 
to replace blanks in strings so as to avoid surrounding quotes.
</td></tr> 
<tr><td valign="top"><i>&lt;w&gt;</i></td><td> "white-space" characters such as blanks, tabs 
and end-of-lines are used to delimit fields 
in a CIF, <i>i.e.</i> one or more white-space characters serve to separate data names and values, 
provided the data names and values are not inside a quoted string (as with the _crystal_colour 
value above) or a text string (as with the <tt>_crystal_preparation</tt> value above). 
</td></tr>
<tr><td valign="top">#</td><td> the hash mark (sharp) disables syntactic processing of characters following on a line, 
except within a quoted or text string. The hash is used for comments in a CIF. 
</td></tr>
<tr><td valign="top">'</td><td> the single quote (apostrophe) may be used to protect a character string, but not a number 
or text string, from internal syntactic processing. This is done by surrounding a character 
sequence with quote characters. More precisely the string must start with the digraph <i>&lt;w&gt;</i>' 
and end with the digraph '<i>&lt;w&gt;</i>. Within such a string characters such as _, <i>&lt;w&gt;</i>, # and " do not 
have special properties. Note that the ' character may also be placed within this string 
provided that it is not immediately trailed by a <i>&lt;w&gt;</i> character. The character string must 
not span multiple lines. 
</td></tr>
<tr><td valign="top">"</td><td> the double quote serves the same function as '. 
</td></tr>
<tr><td valign="top">;</td><td> the semicolon, if used as the first character in a line, 
is used to start and finish a sequence of lines, referred to as a string of type text.. 
The sequence newline-semicolon serves very much the same purpose as the single and 
double quotes, but is the only way to provide multiple line text as a value. 
</td></tr>
<tr><td valign="top">.</td><td> the period character has a special meaning when used 
by itself as a data value. It usually means "the default value". 
</td></tr>
<tr><td valign="top">?</td><td> the question mark character has a special meaning 
when used by itself as a data value. It usually means "value unknown". 
</td></tr>
<tr><td valign="top">$</td><td> the dollar sign is normally NOT a special character 
in a CIF. However, if a CIF contains save frames <a href="Hall_Spadaccini_1994">[Hall, Spadaccini, 1994]</a>, the 
dollar sign is used at the start of save frame names when referred to as data values. 
To avoid confusion, do not use an unquoted dollar sign as a value in a CIF.
</td></tr></table> 
<p>
<h3 id="1.5" align="left">1.5. Syntax control words
</h3>
<p> 
Special words in a CIF control and signal syntax changes. These words can be easily 
recognised by a trailing underscore character.
<p>
<table border=0>
<tr><td valign="top"> 
<b><tt>data_</tt></b></td><td>signals the start of a new data block. A name is appended 
to this string 
(e.g. <tt>data_crystal_description</tt>). Each data block name within a CIF must be unique.
<p></td></tr><tr><td valign="top">
<b><tt>loop_</tt></b></td><td>signals the start of a repeated list of data items. 
<tt>loop_</tt> is followed 
by the data names of all items in the list. Then come the data values, in the same order 
as the data names, and these are repeated until another data name or control string is 
encountered.
<p></td></tr><tr><td valign="top">
<b><tt>global_</tt></b></td><td>signals the start of a new global data block. This 
serves the same function 
as <tt>data_</tt> , except that it contains items are assumed to be "global" rather than 
specific to a particular data block. Global data blocks do not have block names.
<p></td><tr><tr><td valign="top">
<b><tt>stop_</tt></b></td><td>signals the end of a nested list. Nested lists are 
not currently used in CIFs but they are in a STAR File 
<a href="Hall_Spadaccini_1994">[Hal, Spadaccini, 1994]</a>. An example of this is 
shown later.
<p></td></tr><tr><td valign="top">
<b><tt>save_</tt></b></td><td>signals the start, and the end, of a save frame. 
Save frames are not used in CIFs, but they are in DDL2 dictionaries. A save 
frame is used as a "macro" within a data block to contain, one or more data items. 
A save frame is "addressable" via a frame code, and each data name within a frame 
must be unique. A data block may contain any number of save frames. 
Because the identity of data items within a 
save frame is "protected" from items outside this frame, the same data name may be 
used in the data block or in other save frames. The <tt>save_</tt> string at the start 
a frame has an appended code that is unique within the data block. This code, 
preceded by a dollar character, <i>i.e.</i> $&lt;code&gt;, may be 
referred to as a data value, so as to "point to" a specific frame of data items. 
The <tt>save_</tt> string closing a frame does not have a code attached. 
</td></tr>
</table>
<p>
<h3 id="1.6" align="left">1.6. File examples 
</h3>
<p>
Some data file examples will be now used to illustrate syntax requirements.
<h3 id="1.6.1" align="left">1.6.1 A typical structural CIF
</h3>
<p> 
Here is an abbreviated version of typical CIF. 
<p> 
<center><table border=1><tr><td><pre>
<b>data_</b>xtest2 
_chemical_name_systematic 
     hexamethyl-4,8-dioxaundecanedioate)bis(pyridine)dirhodium
_chemical_formula_sum            'C40 H62 N2 O12 Rh2 ' 
_chemical_formula_moiety         ? 
_chemical_formula_weight         498.35 
_symmetry_cell_setting           triclinic 
_symmetry_space_group_name_H-M            'P -1'
 
<b>loop_</b> 
_symmetry_equiv_pos_as_xyz 
'x,y,z'              '-x,-y,-z' 

_cell_length_a                   8.586(8) 
_cell_length_b                   15.286(11) 
_cell_length_c                   15.606(8) 
_cell_angle_alpha                94.57(4) 
_cell_angle_beta                 92.31(4) 
_cell_angle_gamma                100.58(4) 
_cell_formula_units_Z            4 
_cell_volume                     2004(3)
</pre></td></tr></table></center> 
<p>
Note the following in this example.
<ul> 
<li>The alignment of character strings in this (and any other) CIF is largely a 
matter of taste. Changing the white space between data names or values does 
not affect the meaning of the data; nor does any reordering of the items. 
The term "item" refers to a tag/value pair.
</li> 
<li>The quotes are not needed for the _symmetry_equiv_pos_as_xyz values because 
they contain no embedded blanks, however, their presence does not alter the 
value. Because of embedded blanks in the formula, the quotes bounding the 
_chemical_formula_sum string are required. Double quotes would have worked as well.
</li> 
<li>Because the value of _chemical_formula_moiety is unknown, its value is shown 
as a question mark. This item (i.e. the tag and the value) could have been omitted 
from the file, however, it is often convenient to retain the data name of a missing 
value as a reminder that it needs to be added.
</li>
</ul>
<p> 
One of the most common errors in a CIF is the omission of a missing value (i.e. 
using a blank field) as this violates the requirement to match tags to values.
<h3 id="1.6.2" align="left">1.6.2 A STAR File
</h3> 
<p>
Here is an example of a STAR File to illustrate its much more extensive syntax. 
This file contains quantum chemical data on the water molecule. One can see that a 
STAR file in most respects is identical to a CIF file.
<p> 
<center><table border=1><tr><td><pre>
data_water 
 _qchem_chemical_name_common         water 
 _qchem_chemical_name_IUPAC         'oxygen dihydride' 
 _qchem_chemical_formula            'H2 O'
 
loop_ 
 _qchem_molecular_site_number 
 _qchem_molecular_site_label 
 _qchem_molecular_site_symbol 
 _qchem_molecular_site_x 
 _qchem_molecular_site_y 
 _qchem_molecular_site_z 
 _qchem_molecular_site_mass 
  1 O1 O   0.00000  0.00000  0.00000 15.994915 
  2 H1 H   0.00000  0.75753  0.58707  1.007825 
  3 H2 H   0.00000 -0.75753  0.58707  1.007825
 
_qchem_molecular_mass_centre_x       0.0000000 
_qchem_molecular_mass_centre_y       0.0000000 
_qchem_molecular_mass_centre_z       0.0657023
 
loop_ 
 _qchem_basis_set_atom_name 
 _qchem_basis_set_atom_symbol 
 _qchem_basis_set_contraction_scheme 
 _qchem_basis_set_funct_per_contraction 
 loop_ 
 _qchem_basis_set_function_code 
 _qchem_basis_set_function_count 
 _qchem_basis_set_function_exponent 
 _qchem_basis_set_function_coefficient 
oxygen O (9,5,1)->[4,2,1] {6:1:1:1,4:1,1} 
 s 1 7816.540000 0.002031 
 s 1 1175.820000 0.015436 
 s 1 273.188000 0.073771 
#...........................................data omitted for space  d 7 0.900000 1.000000 stop_ 
hydrogen H (4,1)->[2,1] {3:1,1} 
 s 1 19.240600 0.032828 
 s 1 2.899200 0.231208 
 s 1 0.653400 0.817238 
 s 2 0.177600 1.000000 
 p 3 1.000000 1.000000 stop_


loop_ 
 _qchem_bond_site_label_1 
 _qchem_bond_site_label_2 
 _qchem_bond_distance_au 
 _qchem_bond_distance 
 O1 H1 1.811095991 0.958390452  O1 H2 1.811095991 0.958390452 
loop_ 
 _qchem_angle_site_label_1 
 _qchem_angle_site_label_2 
 _qchem_angle_site_label_3 
 _qchem_angle 
 H1 O1 H2 104.44991917 
_qchem_molecule_number_atoms 3 
_qchem_molecule_number_electrons 10 
_qchem_molecule_number_contractions 13 
_qchem_molecule_charge 0 
_qchem_molecule_state_multiplicity 1 
_qchem_molecule_occup_orb_doub 5 
_qchem_molecule_occup_orb_sing_alpha 0 
_qchem_molecule_occup_orb_sing_beta 0 
_qchem_option_converge_criterion 1.0E-05 
_qchem_option_variable_level_shift yes 
_qchem_calc_energy_electronic -85.230179266 
_qchem_calc_energy_nuclear 9.183706230 
_qchem_calc_energy_total -76.046473036
</pre></td></tr></table></center> 
<p>
Note the following difference between this STAR file and a CIF.
<p> 
&#8226; The <tt>_qchem_basis_set_</tt> items in this STAR file are in nested loop. 
The <tt>_qchem_basis_set_function_</tt> items are in a level 2 loop. 
Note that following the last set (or packet) of data values for these items 
there is a <tt>stop_</tt> signal. This causes the nesting to revert to level 1.
<p>
<h3 id="1.7" align="left">1.7 Data definitions
</h3>
<p>
CIF data items used in global data exchange applications, such as in archiving 
or publication, are usually defined in an electronic dictionary that has been 
formally approved by the IUCr. In that way, those that generate CIF data have 
a common understanding of what the data means with those that subsequently 
read that data. The definition of data items has become quite rigorous as a 
consequence of this requirement and involves special definition protocols 
that are incorporated in a dictionary definition language (DDL). 
<p>
Each data definition needs to specify the function of an item, and list its 
particular characteristics or attributes. For instance, the definition needs 
to specify if an item is a number or a character string. Although very few users 
of CIF data need to understand how dictionaries and the individual definitions 
are constructed, a programmer writing CIF applications will benefit greatly by 
knowing about the two types of DDL currently in use, appreciating the types of 
information contained within the DDL definitions, and understanding how it can 
be employed to validate data.
<p> 
The format of all CIF electronic dictionaries conform to the STAR syntax,
and may also be parsed with <i>CIFtbx</i> tools. In fact, the toolbox provides a 
specific function to read and cross check attributes from dictionaries. 
<p>
Existing dictionaries are written using two different DDLs. DDL1 has been used to 
construct the CIF Core, Powder and several other dictionaries. A more recent dictionary 
language, DDL2, is used to specify the macromolecular dictionary mmCIF 
<a href="#Fitzgerald_et_al_1996">[Fitzgerald <i>et al.</i>, 1996]</a>.
<p>

<h3 id="1.7.1" align="left">1.7.1 DDL1 definition examples
</h3> 
<p>
<h3 id="1.7.1.11" align="left">1.7.1.1 DDL1 example 1
</h3>
<p> 
Here is DDL1 definition of the data items <tt>_atom_site_fract_x</tt>,
<tt>_atom_site_fract_y</tt>, and
<tt>_atom_site_fract_z</tt> from the Core dictionary.
<p> 
<center><table border=1><tr><td><pre>
data_atom_site_fract_ 
 loop_
 _name 
'_atom_site_fract_x' 
'_atom_site_fract_y' 
'_atom_site_fract_z'
 
 _category            atom_site 
 _type                numb 
 _type_conditions     esd 
 _list                yes 
 _list_reference     '_atom_site_label' 
 _enumeration_default 0.0
 
 _definition 
; Atom site coordinates as fractions of the _cell_length_  values. 
;</pre></td></tr></table></center> 
<p>
The precise meanings of the different DDL1 attributes such as 
<tt>_name</tt>, <tt>_category</tt>, <i>etc.</i> are given in 
<a href="#Hall_Cook_1995">[Hall, Cook, 1995]</a>
and <a href="McMahon_1995">[McMahon 1995]</a>. 
Note the following in this definition.
<p>
<ul>  
<li>
when data items form an irreducible set, such as with the fractional 
coordinates x, y, and z, or the diffraction indices h, k, and l, they are 
defined in the same DDL1 data block. In DDL2 each data item is defined separately.
</li> 
<li>
the <tt>_list</tt> attribute tells us that the fractional coordinates must be 
present in a looped list of category <tt>atom_site</tt>.
</li> 
<li>
the <tt>_list_reference</tt> attribute specifies that the data item 
<tt>_atom_site_label</tt> must be present in the same looped list as the fractional 
coordinates for the list of category atom_site items to be valid. 
</li>
<li>
the <tt>_type_conditions attribute</tt> places the condition esd on the <tt>_type</tt> value of 
numb. This means that fractional coordinate numbers may have the estimated 
standard deviation (i.e. standard uncertainty) values appended within parentheses.
</li> 
<li>
the <tt>_enumeration_default</tt> attribute defines the value that a fractional coordinate 
is assumed to have, if it is missing from a CIF.
</li> 
</ul>
<p>
<h3 id="1.7.1.2" align="left">1.7.1.2 DDL1 example 2
</h3>
<p>
Here is the DDL1 definition of the data item <tt>_atom_site_label</tt>. This is the 
item referred to above as the <tt>_list_reference</tt> data that must be present 
in a list of items of category <tt>atom_site</tt>, in order that the CIF be valid.
<p> 
<center><table border=1><tr><td><pre>
data_atom_site_label
 _name                  '_atom_site_label' 
 _category               atom_site 
 _type                   char 
 _list                   yes 
 _list_mandatory         yes
 
  loop_ 
 _list_link_child 
'_atom_site_aniso_label' 
'_geom_angle_atom_site_label_1'  
'_geom_angle_atom_site_label_2'  
'_geom_angle_atom_site_label_3'  
'_geom_bond_atom_site_label_1' 
'_geom_bond_atom_site_label_2'

  loop_
 _example 
  C12 
  Ca3g28 
  Fe3+17 
  H*251  
  boron2a 
  C_a_phe_83_a_0 
  Zn_Zn_301_A_0  

 _definition 
; The _atom_site_label is a unique identifier for a  particular site in the crystal. 
;</pre></td></tr></table></center> 
<p>

Note the following in this definition.
<ul> 
<li>the attribute <tt>_list_mandatory</tt> with a value of yes signals that this item 
must be present in any list of category <tt>atom_site</tt>.</li> 
<li>the <tt>_list_link_child</tt> attributes specify data items that are 'child' 
dependencies of <tt>_atom_site_label</tt>. This means that this item 
must be present in the CIF if any of the dependent items is present.</li> 
<li>the <tt>_list_reference</tt> attribute specifies that the data item 
<tt>_atom_site_label.</tt></li>
</ul>
<p> 
<h3 id="1.7.1.3" align="left>1.7.1.3 DDL1 example 3
</h3> 
Here is a more complicated DDL1 definition for the six anisotropic atomic 
displacement parameters U<sup>ij</sup>.
<p> 
<center><table border=1><tr><td><pre> 
data_atom_site_aniso_U_ 
    loop_ _name                           '_atom_site_aniso_U_11'
                                          '_atom_site_aniso_U_12' 
                                          '_atom_site_aniso_U_13' 
                                          '_atom_site_aniso_U_22' 
                                          '_atom_site_aniso_U_23' 
                                          '_atom_site_aniso_U_33' 
    _category                               atom_site 
    _type                                   numb 
    _type_conditions                        esd 
    _list                                   yes 
    _list_reference                       '_atom_site_aniso_label' 
    _related_item                         '_atom_site_aniso_B_' 
    _related_function                       conversion 
    _units                                  A^2^ 
    _units_detail                          'angstroms squared' 
    _definition 
;              These are the standard anisotropic atomic displacement
               components in angstroms squared which appear in the
               structure factor term:
 
               T = exp{-2pi^2^ sum~i~ [sum~j~ (U^ij^ h~i~ h~j~ a*~i~
                                                 a*~j~) ] }
 
               h = the Miller indices 
               a* = the reciprocal-space cell lengths
 
               The unique elements of the real symmetric matrix are
               entered by row. 
;</pre></td></tr></table></center>
<p>
Note the following aspects of this definition.
<ul> 
<li>the <tt>_related_item</tt> attribute identifies items that are related to the 
defined one. The nature of this relationship is specified with 
<tt>_related_function</tt>. In this case the value is <tt>conversion</tt>, which means
that the U<sup>ij</sup> can be derived directly from the B<sup>ij</sup>.</li> 
<li>the <tt>_units</tt> attributes specify the units or dimensions of the U<sup>ij</sup> in
&Aring;ngstroms squared.
</ul>
<p>
<h3 id="1.7.2" align="left">1.7.2 DDL2 definition examples
</h3>
<p>
The definitions shown above are from the CIF Core dictionary and illustrate how the 
DDL1 attributes are used to define data items. The DDL1 approach makes minimum use 
of the 'category' of data items, such as <tt>atom_site</tt>. In a sense this is 
inefficient because data attributes such as <tt>_list</tt>, <tt>_list_reference</tt>, 
<tt>_list_link_child</tt>, <tt>_list_link_parent</tt>, refer to properties of 
the class or category rather than to individual items. The DDL2 approach 
<a href="Westbrook_Hall_1995">[Westbrook, Hall, 1995]</a> uses a more 
hierarchical approach to data classes in which data items of a particular category are 
organized into a single table. The DDL2 also provides for explicit sub-categories in 
which data items are identified by function, e.g. 'matrix'. Although this approach is 
less intuitive to the casual user, it has proven to be advantageous in defining complex 
data relationships, such as those in the macromolecular dictionary, and is therefore 
expected to be of increasing importance in the future as cross-discipline data bases develop.
<p>
<h3 id= "1.7.2.1" align="left">1.7.2.1 DDL2 example 1
</h3>
<p> 
To illustrate the differences between the dictionary approaches, we shall now look at the
<tt>_atom_site</tt> definitions in DDL2.
<p> 
<center><table border=1><tr><td><pre> 
save__atom_site.fract_x
 
     _item_description.description 
;               The x coordinate of the atom site position specified as a
                fraction of _cell.length_a. 
; 
     _item.name '_atom_site.fract_x' 
     _item.category_id atom_site 
     _item.mandatory_code no 
     _item_aliases.alias_name '_atom_site_fract_x' 
     _item_aliases.dictionary cif_core.dic 
     _item_aliases.version 2.0.1 
      loop_ 
     _item_dependent.dependent_name 
                                 '_atom_site.fract_y' 
                                 '_atom_site.fract_z' 
     _item_related.related_name  '_atom_site.fract_x_esd'
     _item_related.function_code   associated_esd 
     _item_sub_category.id         fractional_coordinate 
     _item_type.code               float 
     _item_type_conditions.code    esd 
      save_
</pre></td></tr></table></center>
<p>
Note the following aspects in this definition. 
<ul>
<li>DDL2 definitions are enclosed in a save frame, not a data block.</li> 
<li>DDL2 data names contain a dot '.' character that separates the category 
(starting the name) from the identity (ending the name).</li> 
<li>in DDL2 definitions each data item, independent of its irreducible relationship 
to other data items, is defined separately.</li> 
<li>DDL2 data names are equivalenced to other identical data items, including 
the DDL1 defined names, with the attributes 
<tt>_item_aliases.alias_name</tt> values.</li> 
<li>in DDL2 the <tt>_item_type.code</tt> attribute is identical to the DDL1 _type attribute, 
except that it has a more detailed enumeration <i>e.g.</i> number has been expanded to integer, 
float, etc.
</ul>
<p> 
<h3 id="1.7.2.2" align="left">1.7.2.2 DDL2 example 2
</h3><p> 
Here is another DDL2 definition to emphasise the differences in definition approach.
<p> 
<center><table border=1><tr><td><pre> 
save__atom_site.aniso_U[1][3]_esd
 
     _item_description.description 
;               The estimated standard deviation of 
                _atom_site.aniso_U[1][3]. 
; 
     _item.name                  '_atom_site.aniso_U[1][3]_esd'
     _item.category_id             atom_site 
     _item.mandatory_code          no 
     _item_default.value           0.0 
      loop_ 
     _item_related.related_name 
     _item_related.function_code '_atom_site.aniso_U[1][3]'
                                   associated_value 
                                 '_atom_site.aniso_B[1][3]_esd'
                                   conversion_constant 
                                 '_atom_site_anisotrop.B[1][3]_esd'
                                   conversion_constant 
                                 '_atom_site.aniso_B[1][3]_esd'
                                   alternate_exclusive 
                                 '_atom_site_anisotrop.B[1][3]_esd'
                                   alternate_exclusive 
                                 '_atom_site_anisotrop.U[1][3]_esd'
                                   alternate_exclusive 
     _item_sub_category.id         matrix 
     _item_type.code               float 
     _item_units.code              angstroms_squared 
 save_
</pre></td></tr></table></center>
<p>

Note the following in this definition.
<ul> 
<li>DDL2 defines the esd (or su) of U<sup>13</sup> as a separate data item, whereas in 
DDL1 the su is assumed to be appended to the value.</li> 
<li>an additional classification attribute <tt>_item_sub_category.id</tt> 
is defined in DDL2.</li> 
<li>in DDL2 definitions each data item, independent of its irreducible 
relationship to other data items, is defined separately.</li>
</ul> 
<h3 id="1.7.2.3" align="left">1.7.2.3 DDL2 example 3
</h3> 
<p>
Finally here is how the properties of the category <tt>atom_site</tt> are defined in DDL2.
<p>
<center><table border=1><tr><td><pre>
save_ATOM_SITE 
    _category.description 
;              Data items in the ATOM_SITE category record details about
               the atom sites in a macromolecular crystal structure,
               such as the positional coordinates, atomic displacement
               parameters, magnetic moments and directions, and so on.
 
               The data items for describing anisotropic temperature or
               thermal displacement factors are only used if the
               corresponding items are not given in the 
               ATOM_SITE_ANISOTROP category. 
; 
    _category.id                  atom_site 
    _category.mandatory_code      no 
    _category_key.name          '_atom_site.id' 
     loop_ 
    _category_group.id          'inclusive_group' 
                                'atom_group' 
     save_</pre></td></tr></table></center>
<p>            
Note the following aspects in this category definition.
<ul> 
<li>in DDL2 the attribute <tt>_category_key.name</tt>, which is equivalent to 
the DDL1 <tt>_list_reference</tt>, is defined only once, whereas in DDL1 must 
be declared in the definition of each data item.</li> 
<li>the category attributes are identified by the name structure _category_ as 
opposed to the <tt>_item_</tt> prefix used to define data items. It is important 
to emphasise that <tt>atom_site</tt> is NOT a data item and will not appear in a CIF.
</ul>
<p> 
<h3 id="1.8" align="left">1.8 Handling DDL1 and DDL2 name structures
</h3> 
<p>
The different naming structures in the two dictionary languages, DDL1 and DDL2, 
appears to complicate the use of CIFs. This is avoided because the <i>CIFtbx</i>
toolbox handles these naming convention transparently and interchangeably 
provided there is access to the relevant dictionaries.
<p> 
We shall now look quickly at some data items expressed in both conventions. 
Here is an extract of a CIF containing core data items.
<p>
<center><table border=1><tr><td><pre> 
loop_ 
     _atom_site_label 
     _atom_site_fract_x 
     _atom_site_fract_y 
     _atom_site_fract_z 
     _atom_site_U_iso_or_equiv 
     _atom_site_thermal_displace_type 
     _atom_site_calc_flag 
     _atom_site_calc_attached_atom 
       O1   .4154(4)   .5699(1)   .3026(0)   .060(1)   Uani   ?   ?
       C2   .5630(5)   .5087(2)   .3246(1)   .060(2)   Uani   ?   ?
       C3   .5350(5)   .4920(2)   .3997(1)   .048(1)   Uani   ?   ?
       N4   .3570(3)   .5558(1)   .4167(0)   .039(1)   Uani   ?   ?
       C5   .3000(5)   .6122(2)   .3581(1)   .045(1)   Uani   ?   ? 
loop_ 
     _atom_site_aniso_label 
     _atom_site_aniso_U_11 
     _atom_site_aniso_U_22 
     _atom_site_aniso_U_33 
     _atom_site_aniso_U_12 
     _atom_site_aniso_U_13 
     _atom_site_aniso_U_23 
     _atom_site_aniso_type_symbol 
       O1  .071(1) .076(1) .0342(9) .008(1)   .0051(9) -.0030(9) O
       C2  .060(2) .072(2) .047(1)  .002(2)   .013(1)  -.009(1)  C
       C3  .038(1) .060(2) .044(1)  .007(1)   .001(1)  -.005(1)  C
       N4  .037(1) .048(1) .0325(9) .0025(9)  .0011(9) -.0011(9) N
       C5  .043(1) .060(1) .032(1)  .001(1)  -.001(1)   .001(1)  C
</pre></td></tr></table></center>
<p>

In this CIF, the anisotropic atomic displacement parameters have been looped in
a separate list from the atomic coordinates. The each row in the second list is
linked to a row in the list of atomic coordinates by the value of
<tt>_atom_site_aniso_label</tt> that matches the value of <tt>_atom_site_label</tt>
in the associated row of the list of atomic coordinates. Though it is customary to
align the ordering of the two lists, CIF does not require them to be in the same
order, only that the labels can be matched. Alternatively, the two lists could have
been merged into one, using the same tags.
<p> 
In the DDL2-based mmCIF dictionary there are two alternate sets of names for 
presentation of anisotropic atomic displacement parameters, one set in the
<tt>atom_site</tt> category, and another set in a distinct <tt>atom_site_anisotrop</tt>
subcategory. In a CIF one set of names can be used but not both. If the names 
from the parent category are used they must be combined with these items. An 
atomic coordinate list with anisotropic displacement parameters merged into 
the same list in mmCIF would look like this.
<p>
<center><table border=1><tr><td><pre> 
 loop_ 
_atom_site.label_seq_id 
_atom_site.auth_asym_id 
_atom_site.group_PDB 
_atom_site.type_symbol 
_atom_site.label_atom_id 
_atom_site.label_comp_id 
_atom_site.label_asym_id 
_atom_site.auth_seq_id 
_atom_site.label_alt_id 
_atom_site.cartn_x 
_atom_site.cartn_y 
_atom_site.cartn_z 
_atom_site.occupancy 
_atom_site.B_iso_or_equiv 
_atom_site.footnote_id 
_atom_site.label_entity_id 
_atom_site.id 
_atom_site.aniso_U[1][1] 
_atom_site.aniso_U[1][2] 
_atom_site.aniso_U[1][3] 
_atom_site.aniso_U[2][2] 
_atom_site.aniso_U[2][3] 
_atom_site.aniso_U[3][3] 
1 . ATOM  N  N  GLU * 1  A   4.127   26.179   -7.903   0.49 57.53   .   1    1
                        0.9336  0.0004  0.2737  0.7394  0.2771  0.4591
1 . ATOM  N  N  GLU * 1  B   3.535   25.488   -12.889  0.51 54.52   .   1    2
                        0.8406 -0.0887  0.3093  0.5015  0.0161  0.6783
1 . ATOM  C CA  GLU * 1  A   5.490   26.607    -8.207  0.49 52.50   .   1    3
                        0.9283 -0.0256  0.2331  0.5563  0.1241  0.4611 
1 . ATOM  C CA  GLU * 1  B   2.754   26.395   -12.051  0.51 51.27   .   1    4
                        0.7663 -0.0653  0.2258  0.5124  0.0184  0.6212
1 . ATOM  C  C  GLU * 1  A   5.550   27.734    -9.233  0.49 47.55    .  1    5
                        0.8593 -0.088   0.182   0.4752  0.0625  0.4275
</pre></td></tr></table></center>
<p>

The same information presented as two lists in mmCIF would use different tags, very 
similar to those used in DDL1. 
<p>
<center><table border=1><tr><td><pre>
 loop_ 
_atom_site.label_seq_id 
_atom_site.auth_asym_id 
_atom_site.group_PDB 
_atom_site.type_symbol 
_atom_site.label_atom_id 
_atom_site.label_comp_id 
_atom_site.label_asym_id 
_atom_site.auth_seq_id 
_atom_site.label_alt_id 
_atom_site.cartn_x 
_atom_site.cartn_y 
_atom_site.cartn_z 
_atom_site.occupancy 
_atom_site.B_iso_or_equiv 
_atom_site.footnote_id 
_atom_site.label_entity_id 
_atom_site.id 
_atom_site.aniso_U[1][1] 
_atom_site.aniso_U[1][2] 
_atom_site.aniso_U[1][3] 
_atom_site.aniso_U[2][2] 
_atom_site.aniso_U[2][3] 
_atom_site.aniso_U[3][3] 
1 . ATOM  N  N GLU * 1 A  4.127 26.179  -7.903 0.49 57.53 . 1 1 
1 . ATOM  N  N GLU * 1 B  3.535 25.488 -12.889 0.51 54.52 . 1 2 
1 . ATOM  C CA GLU * 1 A  5.490 26.607  -8.207 0.49 52.50 . 1 3 
1 . ATOM  C CA GLU * 1 B  2.754 26.395 -12.051 0.51 51.27 . 1 4 
1 . ATOM  C  C GLU * 1 A  5.550 27.734  -9.233 0.49 47.55 . 1 5 
_atom_site_aniso.id 
_atom_site_aniso.U[1][1] 
_atom_site_aniso.U[1][2] 
_atom_site_aniso.U[1][3] 
_atom_site_aniso.U[2][2] 
_atom_site_aniso.U[2][3] 
_atom_site_aniso.U[3][3] 
1  0.9336  0.0004  0.2737  0.7394  0.2771  0.4591 
2  0.8406 -0.0887  0.3093  0.5015  0.0161  0.6783 
3  0.9283 -0.0256  0.2331  0.5563  0.1241  0.4611 
4  0.7663 -0.0653  0.2258  0.5124  0.0184  0.6212 
5  0.8593 -0.088   0.182   0.4752  0.0625  0.4275
</pre></td></tr></table></center>
<p>
The mmCIF the <tt>_atom_site_aniso.id</tt> tag fills the role of the small molecular 
core CIF tag <tt>_atom_site_aniso_label</tt> for which it is an alias, and the mmCIF 
tag <tt>_atom_site.id</tt> tag fills the role of the small molecule core CIF tag 
<tt>_atom_site_label</tt> for which it is an alias, providing the same approach to 
linking the list of anisotropic atomic displacement parameters to the list of 
atomic coordinates.
<p> 
<h1 id="CHAPTER_2" align="center">CHAPTER 2</h1>
<p> 
<h2 align="center">Overview of the Tool Box</h2>
<p> 
<h3 id="2.1" align="left">2.1. Introduction</h3>
<p> 
The <i>CIFtbx</i> library is made up of Fortran functions, subroutines, monitor 
variables and control variables. It is used to develop software to read and/or 
write CIF data. In addition, these software "tools" automatically test the validity 
of incoming CIF data, and ensure the correct deposition of outgoing data. The 
self-checking aspects of these tools are important for ensuring that the data 
structure of the CIF is correct, and, when used in association with the DDL 
dictionaries, that the individual items and lists are conformant to the data 
definitions.
<p>
This version of <i>CIFtbx</i> works with CIF2, DDLm,
DDL 2 and mmCIF as well as with DDL 1.4 and core CIF dictionaries.
<p> 
This chapter provides an overview of the available <i>CIFtbx</i> tools. The next 
chapter shows how these tools are applied to different data manipulation tasks, 
and later chapters provide the reference manual details on how the various options 
for tools are invoked and interpreted.
<p> 
<i>CIFtbx</i> facilities are of four types:
<ul> 
<li>1. commands to initialise later handling,</li> 
<li>2. commands to read CIF data,</li>
<li>3. commands to write CIF data,</li>
<li>4. variables for monitor and control signals.</li>
</ul>
<p> 
<i>CIFtbx</i> commands are Fortran function or subroutine calls which are invoked in 
the standard way. For example, to open the dictionary file "core.dic" one would 
simply enter the <i>logical function</i> <tt>dict_</tt>
<p> 
<tt>FN = dict_('core.dic','valid')</tt>
<p> 
FN is a local LOGICAL variable. The string 'core.dic' is the local file identifier for 
the dictionary. The string 'valid' informs the command of the checking that should be 
done against the data definitions in this dictionary. If <tt>dict_</tt> opens the file
 "core.dic" correctly the value of FN is returned as <tt>.true.</tt>; otherwise the 
function is returned as <tt>.false.</tt>
<p> 
If the command is a subroutine, such as <tt>purge_</tt>, which is used to clear the 
internal data tables, it is invoked as
<p> 
<tt>call purge_</tt>
<p> 
Note that all but two of the commands are functions.
<p> 
The arguments to the commands are minimal. Much of the work of the library is done by 
reading and setting variables held in common blocks. Both the common block declarations 
and the type declarations for all the commands are provided in the file <tt>ciftbx.cmn</tt>,
which must be 'included' in each program, function or subroutine that uses <i>CIFtbx</i>. 
The flexibility of CIF presents some challenges to the writer of applications that use CIF.
The information in a CIF may be presented in any order, with the data names presented in 
upper or lower case and with whatever spacing between items pleases one's taste. 
You may take a CIF, pick up, say, the cell parameters from the front of the file, place 
them at the end, after all the atomic coordinates, change the "<tt>_cell...</tt>" in all 
the data names to "<tt>_Cell...</tt>" and introduce a blank line between each data name 
and its value and call the file the same CIF. <i>CIFtbx</i> provides the application 
writer with the tools to process both the original file and the modified file as the 
same CIF. When the application needs the cell parameters, it asks for them by name. 
For the advanced application writer, <i>CIFtbx</i> also has the option of simply asking 
for the next data item, whatever the name of that data item might be, allowing the 
application to go beyond the position-independent context of CIF and to be sensitive 
to the position of items within the CIF.
<p> 
<h3 id="2.2" align="left">2.2. Initialisation Commands
</h3>
<p> 
Initialisation commands are applied before any other commands. There are only two tools 
in this category.
<p>
<pre>
     logical function init_ (devcif, devout, devdir, deverr)
               integer devcif, devout, devdir, deverr 
     logical function dict_ (fname, checks) 
               character fname*(*), checks*(*)
</pre>
<p> 
<table border=0>
<tr><td valign="top"><b><tt>
init_</tt></b></td><td>
Is an optional command that specifies the device number assignments for the input CIF, 
<tt>devcif</tt>, the output CIF, <tt>devout</tt>, an internal scratch file, <tt>devdir</tt>,
and the file containing error messages, <tt>deverr</tt>. The internal scratch file, 
<tt>devdir</tt>, is used to hold a copy of the input CIF as a direct access file (<i>i.e.<i>
for random access to parts of the CIF). <tt>init_</tt> is a <i>logical function</i> that is 
always returned with a value of <tt>.true.<tt>&nbsp;The default device numbers for these files 
are 1, 2, 3 and 6.
</td></tr>
<tr><td valign="top"><b><tt>&nbsp;
dict_</tt></b></td><td> 
Is an optional command for opening a dictionary, <tt>fname</tt>, and initiating various 
optional data checks, <tt>checks</tt>. The choices of checks to perform are given by a 
string of blank-separated 5-character 'check codes', such as 'valid' or 'dtype' to turn 
on checking for the validity of tags or types of values. <tt>dict_</tt> is a logical 
function which is returned as <tt>.true.</tt> if the name dictionary was opened and 
if the check codes are recognisable.
<p>
The data item names used in the first dictionary loaded are considered to be preferred 
by the user to aliases found in dictionaries loaded in later calls.  On exit from <tt>dict_</tt>
the variable <tt>dicname_</tt> is either equal to the filename, or, if the dictionary had 
a value for the tag <tt>dictionary_name</tt> of dictionary.title, dicname_ is set to that value.
The variable <tt>dicver_</tt> is blank or set to the value of <tt>_dictionary_version</tt> or 
of <tt>_dictionary.version</tt>  The check codes <tt>'catck'</tt> and <tt>'catno'</tt> turn 
on and off checking of dictionary category conventions.  The default is <tt>'catck'</tt>.  
The check codes <tt>'parck'</tt> and <tt>'parno'</tt> turn on and off checking of parent-child
relationships.  The default is <tt>'parck'</tt>.  Three check codes control the handling of 
tags from the current dictionary which duplicate tags from a dictionary loaded earlier.  These
codes (<tt>'first'</tt>, <tt>'final'</tt> and <tt>'nodup'</tt>) have effect only for the
current call to <tt>dict_</tt>.  The default is 'first'.
<p>
The acceptable values for the checks are:
<table border=0>
<tr><td><tt>'valid'</tt></td><td>data name validation check.</td></tr>
<tr><td><tt>'dtype'</tt></td><td>data item data type check.</td></tr>
<tr><td><tt>'catck'</tt></td><td>check datanames against categories</td></tr>
<tr><td><tt>'catno'</tt></td><td>don't check datanames against categories</td></tr>
<tr><td><tt>'parck'</tt></td><td>check datanames against parent-child relationships</td></tr>
<tr><td><tt>'parno'</tt></td><td>don't check datanames against parent-child relationships</td></tr>
<tr><td><tt>'first'</tt></td><td>accept first dictionary's definitions of duplicate tags</td></tr>
<tr><td><tt>'final'</tt></td><td>accept final dictionary's definitions of duplicate tags</td></tr>
<tr><td><tt>'nodup'</tt></td><td>do not accept duplicate tag definitions</td></tr>
<tr><td><tt>'parck'</tt></td><td>check datanames against parent-child relationships</td></tr>
<tr><td><tt>'parno'</tt></td><td>don't check datanames against parent-child relationships</td></tr>
<tr><td><tt>'reset'</tt></td><td>switch off checking flags</td></tr>
<tr><td><tt>'close'</tt></td><td>close existing dictionaries</td></tr>
</table>
</td></tr></table>
<p>
<h3 id="2.3" align="left">2.3. Read Commands</h3>
<p> 
These commands are used to read data from an existing CIF. Since CIF data is order-independent,
most applications would work from a known list of data names (tags) and to extract the 
desired values from the CIF in the order specified. However, some applications need to 
browse a CIF in the order of presentation. In <i>CIFtbx</i> a blank name has the meaning 
of the next name in the file. 
<p> 
<pre>
     logical function <tt>ocif_</tt> (fname) 
          character fname*(*) 
     logical function <tt>data_</tt> (name) 
          character name*(*) 
     logical function bkmrk_ (mark) 
          integer mark 
     logical function find_ (name, type, strg) 
          character name*(*), type*(*), strg*(*) 
     logical function test_ (name) 
          character name*(*) 
     logical function name_ (name) 
          character name*(*) 
     logical function numb_ (name, numb, sdev) 
          character name*(*) 
          real numb, sdev 
     logical function numd_ (name, numb, sdev) 
          character name*(*) 
          double precision numb, sdev 
     logical function <tt>char_</tt> (name, strg) 
          character name*(*), strg*(*) 
     logical function cmnt_ (strg) 
          character strg*(*) 
     subroutine purge_
</pre>
 
<p>
<table border=0>
<tr><td valign="top"><b><tt>
ocif_</tt></b></td><td>
Requests the named CIF, <tt>fname</tt>, to be opened. The <i>logical function</i> is 
returned as <tt>.true.</tt> if the CIF can be opened. 
</td></tr>

<tr><td valign="top"><b><tt>
data_</tt></b></td><td>
Specifies the data block, <tt>name</tt>, containing the data to be read from the CIF.
The <i>logical function</i> is returned as <tt>.true.</tt> if the data block is found.
</td></tr>

<tr><td valign="top"><b><tt>
bkmrk_</tt></b></td><td>
A bookmark command saves or restores the current position in the CIF so that data 
can be accessed non-sequentially, if need be. The <i>logical function</i> is returned as 
<tt>.true.</tt> if there is space to store the current position, or if the restored 
bookmark number is valid.
<p>
If the argument is zero, the call is to save the position and return the bookmark 
number in the argument.  If the argument is non-zero, the call is to restore the 
position saved for the bookmark number given.  The bookmark and the argument are
cleared.  The position set on return allow reprocessing of the data item or loop 
row last processed when the bookmark was placed. All bookmarks are cleared by a call to <tt>data</tt>_
</td></tr>

<tr><td valign="top"><b><tt>
find_</tt></b></td><td>
Finds the requested item in the current data block. The <i>logical function</i> is returned 
as <tt>.true.</tt> if the item is found.  The argument <tt>name</tt> may be a data 
item name, or blank for the next such item.  The argument <tt>type</tt> may be
blank for unrestricted acceptance of any non-comment string (use <tt>cmnt_</tt> to 
see comments), including loop headers, <tt>'name'</tt> to accept only the name itself 
and <tt>'valu'</tt> to accept only the value, or <tt>'head'</tt> to position to the
head of the CIF.  Except when the <tt>'head'</tt> is requested, the position is left 
after the data item provided.  If the item found is of type <tt>'name'</tt>, 
<tt>posnam_</tt> is set, otherwise, <tt>posval_</tt>. 
</td></tr>

<tr><td valign="top"><b><tt>
test_</tt></b></td><td>
Provides the data attributes of a data item in the current data block. The logical 
function is returned as <tt>.true.</tt> if the item is found. The data attributes 
are returned in the common block variables <tt>list_</tt>, <tt>type_</tt>, <tt>dictype_</tt>,
<tt>diccat_</tt> and <tt>dicname_</tt>. 
</td></tr>

<tr><td valign="top"><b><tt>
name_</tt></b></td><td>
Identifies the next data name in the current data block. The <i>logical function</i> 
is returned as <tt>.true.</tt> if another data name exists in the data block 
and <tt>.false.</tt> if the end of the data block is reached. The name is 
returned in the function argument, <tt>name</tt>.
<p>
The data attributes are stored in the
common variables <tt>list_</tt>, <tt>type_</tt>, <tt>dictype_</tt>, 
<tt>diccat_</tt> and <tt>dicname_</tt>.
The list, array, tuple or table attributes are stored in
<tt>ttype_</tt>, <tt>depth_</tt> <tt>index_</tt>.
<p>
The values in <tt>dictype_</tt>, <tt>diccat_</tt> and <tt>dicname_</tt> are valid
whether or not the data item is found in the input CIF, as
long as the named data item is found in the dictionaries
declared by calls to <tt>dict_</tt>.  The data item name found
in the input CIF is stored in <tt>tagname_</tt>.  The appropriate
column numbers are stored in <tt>posnam_</tt>, <tt>posval_</tt>, <tt>posend_</tt> and (for
numbers) in <tt>posdec_</tt>.  The quotation mark, if any, used is
stored in <tt>quote_</tt>.
<p>
<table border=0>
<tr><td valign="top"><tt>
list_
</tt></td><td>
is an integer variable containing the sequential number of the loop block in the 
data block. If the item is not within a loop structure this value will be zero.
</td></tr>

<tr><td valign="top"><tt>
type_
</tt></td><td>
is a character*4 variable with the possible values:
</td></tr><tr><td></td><td>
<table border=0">
<tr><td valign="top"><tt>
                      'numb'
</tt></td><td>
                              for number data
</td></td></tr><td valign="top"><tt>
                      'char'
</tt></td><td>
                              for character data
</td></tr><tr><td valign="top"><tt>
                      'text'
</tt></td><td>
                              for text data
</td></tr><tr><td valign="top"><tt>
                      'null'
</tt></td><td>
                              if data missing or '?' or '.'
                              also used for blank quoted fields if
                              <tt>nblank_</tt> is true
</td></tr>

</table></td></tr>



<tr><td valign="top"><tt>
ttype_
</tt></td><td> 
is a character*4 variable with the container type:
</td></tr><tr><td></td><td>
<table border=0">
</tr><tr><td valign="top"><tt>
                      'list'
</tt></td><td>
                              for list or array data
</td><td>
                                                       [item,...]
</td></tr><tr><td valign="top"><tt>
                      'tupl'
</tt></td><td>
                              for tuple data
</td><td>
                                                       (item,...)
</td></tr><tr><td valign="top"><tt>
                      'tabl'
</tt></td><td>
                              for table data
</td><td>
                                                       {item,...}
</td></tr>
</table></td></tr>
</td></tr><tr><td></td><td>
               The meanings change if <tt>rdbkt_</tt>, <tt>rdbrc_</tt> or <tt>rdprn_</tt> are
               false.  If rdbkt_ is false, the meanings are:
</td></tr><tr><td></td><td>
<table border=0">
</tr><tr><td valign="top"><tt>
                      'tupl'
</tt></td><td>
                              for tuple data
</td><td>
                                                       (item,...)
</td></tr><tr><td valign="top"><tt>
                      'list'  
</tt></td><td>
                              for list or table data
</td><td>
                                                       {item,...}
</td></tr>
</table></td></tr>
</td></tr><tr><td></td><td>
               If <tt>rdprn_</tt> is <tt>false</tt>, then <tt>'list'</tt> is used for all
               container types.  If <tt>depth_</tt> is 0, then <tt>ttype_</tt> is not
               valid and will contain <tt>'    '</tt>
</td></tr>

<tr><td valign="top"><tt>
depth_
</tt></td><td>
is an integer variable with the depth into a list, array, tuple or table.  
A depth of zero means that no list, array, tuple or table is being processed.
</td></tr>

<tr><td valign="top"><tt>
index_
</tt></td><td>
is an integer variable with the index (from 1) across a list, array, tuple or table.
An index of zero means that no list, array, tuple or table is being processed.
</td></tr>

<tr><td valign="top"><tt>
dictype_
</tt></td><td> 
is a character*(NUMCHAR) variable with the type code given in the dictionary entry for
the named data item.  If no dictionary was used, or no type code was specified, this
field will simply agree with <tt>type_</tt>.  If a dictionary was used, this type may be more 
specific than the one given by <tt>type_</tt>.
</td></tr>

<tr><td valign="top"><tt>
diccat_
</tt></td><td>
 is a character*(NUMCHAR) variable with the category of the named data item, or <tt>'(none)'</tt>
</td></tr>

<tr><td valign="top"><tt>
dicname_
</tt></td><td>
is a character*(NUMCHAR) variable with the name of the data item which is found in the 
dictionary for the named data item.  If <tt>alias_</tt> is <tt>.true.</tt>, this name may
differ from the name given in the call to <tt>test_</tt>.  If <tt>alias_</tt>
is <tt>.false.</tt> or no preferred alias is found, dicname_ agrees with the data item name.
</td></tr>

<tr><td valign="top"><tt>
tagname_
</tt></td><td>
is a character*(NUMCHAR) variable with the name of the data item as found in the input CIF.
It will be blank if the data item name requested is not found in the input CIF and may 
differ from the data item name provided by the user if the name used in the input CIF is an
alias of the data item name and <tt>alias_</tt> is <tt>.true.</tt>
</td></tr>

<tr><td valign="top"><tt>posnam_</tt>,<br />
<tt>posval_</tt>,<br /><tt>posend_</tt>,<br /><tt>posdec_</tt>
</td><td>are integer variables which may be examined if information about the horizontal
position of the name and data read are needed.  <tt>posnam_</tt> is the
starting column of the data name found (most often 1).
</td></tr>

<tr><td valign="top"><tt>
posval_
</tt></td><td>
is the starting column of the data value.  If the field is numeric, then <tt>posdec_</tt>
 will contain the effective  column number of the decimal point.  For whole numbers, the
effective position of the decimal point is one column to the right of the 
field.  <tt>posend_</tt>contains the ending column of the data value.
</td></tr>

<tr><td valign="top"><tt>
quote_
</tt></td><td>
is a character*3 variable which may be examined to determine if a quotation character 
was used on character data.
</table>

</td></tr>

<tr><td valign="top"><b><tt>&nbsp;
numb_</tt></b></td><td>
Returns the number, <tt>numb</tt>, and its standard deviation, <tt>sdev</tt> (if appended),
of a named data item, <tt>name</tt>. The <i>logical function</i> is returned as <tt>.true.</tt>
if the item is present and is a number. If the item is either absent or cannot be 
recognized as a valid number, the function is returned as <tt>.false.</tt> and the 
original numeric argument values are not changed. 
</td></tr>

<tr><td valign="top"><b><tt>&nbsp;
numd_</tt></b></td><td>
 Returns the number, <tt>numb</tt>, and its standard deviation, <tt>sdev</tt> (if appended),
as double precision variables of a named data item, <tt>name</tt>. The <i>logical function</i> 
is returned as <tt>.true.</tt> if the item is present and is a number. If the item is 
either absent or cannot be recognized as a valid number, the function is returned as 
<tt>.false.</tt> and the original numeric argument values are not changed. 
</td></tr>

<tr><td valign="top"><b><tt>&nbsp;
char_</tt></b></td><td>
Returns character or text strings, <tt>strg</tt>, of the named data item, <tt>name</tt>. 
The <i>logical function</i> is returned as <tt>.true.</tt> if the item is present. If text lines 
are being read, this function is called repeatedly until the logical variable <tt>text_</tt>
is <tt>.false</tt>. 
</td></tr>

<tr><td valign="top"><b><tt>&nbsp;
cmnt_</tt></b></td><td>
Returns the next comment, <tt>strg</tt>, in the current data block. The logical 
function returned as <tt>.true.</tt> if a comment is present. The initial comment 
character "#" is not included in the returned string and a completely blank line 
is treated as a comment. 
</td></tr>

<tr><td valign="top"><b><tt>&nbsp;
purge_</tt></b></td><td>
Closes all attached data files, and clears all tables and pointers. This is a subroutine call. 
</td></tr></table>
<p>

<h3 id="2.4" align="left">2.4. Write Commands
</h3> 
<p>
The following commands are available for writing data to a new CIF.
<p>
<pre> 
     logical function pfile_ (fname) 
          character fname*(*) 
     logical function pdata_ (name) 
          character name*(*) 
     logical function pdelim_ (delim, force, posdim)
          character delim*(*)
          logical force
          integer posdlm
     logical function pnumb_ (name, numb, sdev) 
          character name*(*) 
          real numb, sdev 
     logical function pnumd_ (name, numb, sdev) 
          character name*(*) 
          double precision numb, sdev 
     logical function pchar_ (name, string) 
          character name*(*), string*(*) 
     logical function pcmnt_ (string) 
          character string*(*) 
     logical function ptext_ (name, string) 
          character name*(*), string*(*) 
     logical function ploop_ (name) 
          character name*(*) 
     logical function prefx_ (strg, lstrg) 
          character strg*(*) 
          integer lstrg 
     subroutine close_
</pre>
<p>
<table border=0>
<tr><td valign="top" align="left"><b><tt>
pfile_</tt></b></td><td> 
Creates a new file with the specified file name, <tt>fname</tt>. The <i>logical function</i> is 
returned as <tt>.true.</tt> if the file is opened. The value will be <tt>.false.</tt> 
if the file already exists.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
pdata_</tt></b></td><td>
Puts "data_name", <tt>name</tt>, into the output CIF. The <i>logical function</i> is returned 
as <tt>.true.</tt> if the block is created. The value will be <tt>.false.</tt> if the 
block name already exists. This command inserts "save_name" instead of a data block
if the variable <tt>saveo_</tt> is set to <tt>.true.</tt> If the prior block was a 
save-frame, the necessary terminal 'save_' is written for that block before the 
new block is started. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
pdelim_</tt></b></td><td>
Puts delimiter ' ', ',', ':', '(', '{', '[', ')', '}', or ']', <tt>delim</tt>, 
into the output CIF.  Emitting a '(', '{' or '[' increases the output depth by one.
Emitting a ')', '}' or ']' decreases the output depth by one.  Emitting a ' ',
',' or ':' does not change the depth.  Emitting a ',' or ':' at depth_ 0 is an 
error that can be overridden by the second argument, <tt>force</tt> being <tt>.true.</tt>.
Emitting a ' ' at a depth_ greater than 0 is an error that can be overridden
by the second, <tt>force</tt> argument being <tt>.true.</tt>.  The third argument,
<tt>posdlm</tt>, specifies the column position at which to write the delimiter, or
should be 0, if not specific column position is being specified. 
The <i>logical function</i> is returned
as <tt>.true.</tt> if the block is created. The value will be <tt>.false.</tt> if the
block name already exists. This command inserts "save_name" instead of a data block
if the variable <tt>saveo_</tt> is set to <tt>.true.</tt> If the prior block was a
save-frame, the necessary terminal 'save_' is written for that block before the
new block is started.
</td></tr>


<tr><td valign="top" align="left"><b><tt>
ploop_</tt></b></td><td>
Puts the specified data name, <tt>name</tt>, into the output CIF. On the first 
invocation of this command for a given loop a "loop_" string is placed before 
the data name. The <i>logical function</i> is returned as <tt>.true.</tt> the name passes 
any requested dictionary validation checks. Once a series of data names for a 
loop_ header has been declared by calls to this function, all calls to <tt>pchar_</tt>,
<tt>ptext_</tt>, <tt>pnumb_</tt> or <tt>pnumd_</tt>
for the associated data values must be made with data names, the first character 
of which is blank, or the loop_ will be terminated. If the variable <tt>pposnam_</tt>
is non-zero, the data name (or save-frame name) is positioned to start in that column.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
pchar_</tt></b></td><td>
Puts the specified data name, <tt>name</tt>, and character string, <tt>string</tt>, into 
the output CIF. If the data name is blank, only the character string is put. The 
<i>logical function</i> is returned as <tt>.true.</tt> if the data name passes any 
requested dictionary validation checks. The return value is <tt>,true.</tt> 
if the name is unique, AND, if <tt>dict_</tt> is invoked, is a name defined in the dictionary,
AND, if the invocation conforms to the CIF logical structure.
<br />
The action of <tt>pchar_</tt> is modified by the variables <tt>pquote_</tt> and
<tt>nblanko_</tt>.  If <tt>pquote_</tt> is non-blank, it is used as a quotation
character for the string written by <tt>pchar_</tt>.  The valid values
are '''', '"', ';', '(', '{', '[', '''''''', and '"""'.  In the last six cases a 
text field, bracketed construct or multi-line triple-quoted string is written.  
If the string contains a matching character to the value of <tt>quote_</tt>, or if
<tt>quote_</tt> is not one of the valid quotation characters, a valid,
non-conflicting quotation character is used or the line-folding conventions
are used to prevent the close-quote from being followed by white space.  Except 
when writing a text field, if <tt>nblanko_</tt> is true, <tt>pchar_</tt> converts 
a blank string to an unquoted period.
</td></tr>

<tr><td valign="top"  align="left"><b><tt>
pcmnt_</tt></b></td><td>
Puts the specified comment string, <tt>string</tt>, into the output CIF. The 
<i>logical function</i> is always returned as <tt>.true.</tt> The comment
character "#" should not be included in the string. A blank comment is
presented as a blank line without the leading "#". The string <tt>char(0)//char(0)</tt>
can be used to produce an empty comment with the leading "#".
</td></tr>

<tr><td valign="top" align="left"><b><tt>
pnumb_</tt></b></td><td>
Puts the specified data name, <tt>name</tt>, single precision number, <tt>numb</tt>, 
and an appended esd, <tt>sdev</tt>, into the output CIF. The <i>logical function</i> is 
returned as <tt>.true.</tt> if the data name passes any requested 
dictionary validation checks.  The number of esd digits is controlled by 
the variable <tt>esdlim_</tt>.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
pnumd_</tt></b></td><td>
Puts the specified data name, <tt>name</tt>, double precision number, <tt>numb</tt>,
and an appended esd, <tt>sdev</tt>, into the output CIF. The <i>logical function</i> is 
returned as <tt>.true.</tt> if the data name passes any requested 
dictionary validation checks.  The number of esd digits is controlled by 
the variable <tt>esdlim_</tt>.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
ptext_</tt></b></td><td>
Puts the specified data name, <tt>name</tt>, and text string, <tt>string</tt>, 
into the output CIF. The data name will only be inserted on the first 
invocation of a sequence.  The <i>logical function<i> is returned as <tt>.true.</tt> 
if the data name passes any requested dictionary validation checks. The return 
value is <tt>,true.</tt> if the name is unique, AND, if <tt>dict_</tt> is invoked, 
is a name defined in the dictionary, AND, if the invocation conforms to the 
CIF logical structure.
<p>
If used when <tt>pclipt_</tt> is <tt>.true.</tt> if the first character of the
text field is blank, it is removed.
<p>
If used when <tt>pfold_</tt> is non-zero, the text field will be marked
as folded even if the first line is small enough to fit. In order to produce a 
non-folded text field in the midst of generally folded items, <tt>pfold_</tt> 
should be set to 0 before calling <tt>ptext_</tt> and then restored to the previous value.
<p>
This command must be invoked repeatedly until the text is finished. The terminal ";" 
is placed in the output CIF when the next call to <tt>pchar_</tt>, <tt>pnumb_</tt> 
or <tt>pnumd_</tt> is made or if a call is made to <tt>ptext_</tt> for a different 
data name.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
prefx_</tt></b></td><td>
Prefixes the specified string, <tt>strg</tt>, of length, <tt>lstrg</tt>, to 
subsequent lines of the output CIF. The total line length is still limited 
to the value given by the variable <tt>line_</tt> (default 80 characters). 
This function is useful when embedding a 
CIF another text document, such as a PDB REMARK.
An invocation with <tt>lstrg</tt>=0 suppresses a previously used prefix.
Any change in the length of the prefix string flushes pending partial output 
lines, but does _not_ force completion of pending text blocks or loops.
This function allows the CIF output functions to be used within what appear to 
be text fields to support annotation
of a CIF. The <i>logical function</i> is always returned as <tt>.true.</tt> 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
close_</tt></b></td><td>
Closes the output CIF only. This command MUST be used if pfile_ is used. 
This a subroutine call. 
</td></tr>
</table>
<p>

<h3 id="2.5" align="left">2.5. Variables 
</h3>
<p>
The <i>CIFtbx</i> library also contains a large number of variables declared in the 
common blocks in the file <tt>ciftbx.cmn</tt> that may be used to monitor details of 
reading and writing processes and to control various functions. Note that for all 
but special applications only the basic variables <tt>list_</tt>, <tt>loop_</tt>,
<tt>strg_</tt>, <tt>text_</tt>, and <tt>type_</tt> are usually used. These variables 
supplement the argument lists of the various commands, providing essential status 
information. See <a href="#CHAPTER_7">Chapter 7</a> for more information.
<p> 
<h3 id="2.5.1" align="left">2.5.1. General Monitor Variables
</h3> 
These variables are returned by <i>CIFtbx</i> tools and provide information about 
the general status of processing.
<p>
<table border=0>
<tr><td valign="top"><b><tt>
file_
</tt></b></td><td>
Character string containing the filename of the current input file.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
longf_
</tt></b></td><td>
Integer variable containing the length of the filename in <tt>file_</tt>.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
precn_
</tt></b></td><td>
Integer variable containing the line number (starting from 1) of the last line 
written to the output CIF.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
recn_
</tt></b></td><td>
Integer variable containing the line number (starting from 1) of the last line 
read from the input CIF.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
tbxver_
</tt></b></td><td>
Character*32 variable: which is the <i>CIFtbx</i> version and date in the form 
<p>
<tt>'CIFtbx version N.N.N DD MMM YYYY '</tt>
<p>
The format of this string changed in version 2.6 to become year-2000 compliant. In 
prior versions this string was 
<p>
<tt>'CIFTBX version N.N.N, DD MMM YY'. </tt>
</td></tr>
</table>
<p> 



<h3 id="2.5.2" align="left">2.5.2. General Control Variables
</h3>
<p>
These variables are specified to control <i>CIFtbx</i> commands.
<table border=0>
<tr><td valign="top" align="left"><b><tt>
alias_
</tt></b></td><td>
Logical variable to control the use of data name aliases for input items. If set 
<tt>.true.</tt> aliases from the input dictionary may be used 
(see <a href="#2.6">2.6</a> below). The default is <tt>.true.</tt>.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
append_
</tt></b></td><td>
Logical variable: to control reuse of the direct access file. If set <tt>.true.</tt> 
will cause each call to <tt>ocif_</tt> to append the information found to the 
current CIF. The default is <tt>.false.</tt> 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
line_
</tt></b></td><td>
Integer variable to set the input/output line limit for processing a CIF. The 
default value is 80 characters. This limit counts the visible printable characters 
of the line, not the system-dependent line terminators. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
nblank_
</tt></b></td><td>
Logical variable controls the treatment of input blank strings. If set 
<tt>.true.</tt> <tt>char_</tt> or test_ will return the type as null rather 
than char when encountering a quoted blank. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
rdbkt_
</tt></b></td><td>
Logical variable controls the recognition of bracket delimiters <tt> [ ... ] </tt> on read.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
rdbrc_
</tt></b></td><td>
Logical variable controls the recognition of brace delimiters <tt> { ... } </tt> on read.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
rdcolon_
</tt></b></td><td>
Logical variable controls the acceptance of colons as delimiters inside
bracketed constructs on read.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
rdprn_
</tt></b></td><td>
Logical variable controls the acceptance of parentheses
 <tt> ( ... ) </tt> as delimiters on read.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
rdrcqt_
</tt></b></td><td>
Logical variable controls recognition of trailing punctuation
  after a closing quote.  If <tt>.true.</tt> a closing quotation mark is
  recognized immediately, no matter what follows the closing
  quotation mark (the CIF 2 convention).  If <tt>.false.</tt>, a closing
  quotation mark is only effective if followed by a blank, or,
  in bracketed constructs, by a blank, a colon, a comma or 
  the closing bracket. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
rdtq_
</tt></b></td><td>
Logical variable controls the recognition of triple-quote delimiters
<tt>&quot;&quot;&quot; ...  &quot;&quot;&quot;</tt>
 and  <tt>''' ...  '''</tt> on read.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
recbeg_
</tt></b></td><td>
Integer variable that gives the record number of the first record to be used. May be 
changed by the user to restrict access to a CIF. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
recend_
</tt></b></td><td>
Integer variable that gives the record number of the last record to be used. May be 
changed by the user to restrict access to a CIF. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
tabx_
</tt></b></td><td>
Logical variable is set to <tt>.true.</tt> for tab-stops to be expanded to blanks during 
the reading of a CIF. The default is <tt>.true.</tt> 
</td></tr>
</table>
<p>

<h3 id="2.5.3" align="left">
2.5.3. Input Monitor Variables 
</h3>
<p>
These variables are returned by <i>CIFtbx</i> tools and are used to decide on 
subsequent actions in the program. Note that the lengths of the character strings 
that hold data names and block names are controlled by the parameter <tt>NUMCHAR</tt>
in the common block declarations.
<table border=0> 
<tr><td valign="top"><b><tt>
bloc_
</tt></b></td><td>
Character string containing the current data block name. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
clipt_
</tt></b></td><td>
Logical variable, if set .true., when reading text fields,
an extra blank is inserted before the character string
returned for the first line of a text field, emulating
the behavior of <i>CIFtbx</i> versions prior to version 4. 
</td></tr> 


<tr><td valign="top" align="left"><b><tt>
decp_
</tt></b></td><td>
Logical variable is <tt>.true.</tt> if there is a decimal point is present in the 
input numeric value. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
depth_
</tt></b></td><td>
Integer variable containing the depth within a list, array, tuple
  or table. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
diccat_
</tt></b></td><td>
Character string containing the category name specified in the attached dictionaries. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
dicname_
</tt></b></td><td>
Character string containing the root alias data name (see <a href="#2.6">2.6</a>, 
below) specified in the attached dictionaries, or, after a call to <tt>dict_</tt>,
 the name of the dictionary. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
dictype_
</tt></b></td><td>
Character string containing the data type code specified in the attached dictionaries. 
These types may be more specific (e.g. 'float' or 'int') than the types given by the 
variable <tt>type_</tt> (e.g. 'numb') 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
dicver_
</tt></b></td><td>
Character string containing the version of a dictionary after a call to dict_. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
esddig_
</tt></b></td><td>
Integer variable containing number of esd digits in the last number read from a CIF. 
Will be zero if no esd was given. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
fold_
</tt></b></td><td>
Logical variable signalling with a <tt>.true.</tt> value that the current
text block began with the semicolon-reverse-solidus fold indicator.
This is only meaningful when <tt>text_</tt> is <tt>.true.</tt>. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
glob_
</tt></b></td><td>
Logical variable: is <tt>.true.</tt> if the current data block is actually a global 
block. The application is responsible for managing the relationship of global data 
to other data blocks. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
list_
</tt></b></td><td>
Integer variable containing the sequence number of the current looped list. This 
value may be used by the application to identify variables that are in different 
lists or which are not in a list (a zero value). 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
long_
</tt></b></td><td>
Integer variable containing the length of the data string in <tt>strg_</tt>. 
</td></tr>
 
<tr><td valign="top" align="left"><b><tt>
loop_
</tt></b></td><td>
Logical variable is <tt>.true.</tt> if another loop packet is present in the 
current looped list. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
lzero_
</tt></b></td><td>
Logical variable is <tt>.true.</tt> if the input numeric value is of the form 
[sign]0.nnnn rather than [sign].nnnn. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
posdec_
</tt></b></td><td>
Integer variable containing the column number (position along the line, counting 
from 1 at the left) of the decimal point for the last number read. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
posdelim_
</tt></b></td><td>
Integer variable containing the column number (position along the line, counting 
from 1 at the left) of the last delimiter read. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
posend_
</tt></b></td><td>
Integer variable containing the column number (position along the line, counting 
from 1 at the left) of the last character for the last string or number read. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
posnam_
</tt></b></td><td>
Integer variable containing the starting column (position along the line, 
counting from 1 at the left) of the last name or comment read. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
posval_
</tt></b></td><td>
Integer variable containing the starting column (position along the line, counting 
from 1 at the left) of the last data value read. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
quote_
</tt></b></td><td>
Character variable giving the quotation symbol found delimiting the last string read. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
save_
</tt></b></td><td>
Logical variable is <tt>.true.</tt> if the current data block is actually a save frame, 
otherwise <tt>.false.</tt> 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
strg_
</tt></b></td><td>
Character variable containing the data name or string representing the data value 
last retrieved. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
tagname_
</tt></b></td><td>
Character variable containing the data name of the current data item as it was 
found in the CIF. May differ from dicname_ because of aliasing. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
text_
</tt></b></td><td>
Logical variable is <tt>.true.</tt> if another text line is present in the current 
input text block. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
type_
</tt></b></td><td>
Character variable containing the data type code of the current input data item. 
This will be one of the 4-character strings, 'null' (for missing data, the 
period or the question mark), 'numb' (for numeric data), 'char'(for most 
character data) or 'text' (for semi-colon delimited multi-line character data). 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
ttype_
</tt></b></td><td>
Character variable containing the container type code of the current
input data item. When scanning input in CIF~2.0 format (indicated by
<tt>.true.</tt> values of <tt>rdbkt_</tt>, <tt>rdbrc_</tt>tt> and
<tt>rdprn_</tt>) this will be one of the four-character strings <tt>`list'</tt>
(for list or array data), <tt>`tupl'</tt> (for tuple data), <tt>`tabl'</tt> 
(for table data). If <tt>'depth_'</tt> is 0, then <tt>'ttype_'</tt> is not valid.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
valid_
</tt></b></td><td>
Logical variable containing <tt>.true.</tt> if the current value has been
 validated. 
</td></tr>


</td></tr>
</table>
 

<h3 id="2.5.4" align="left">2.5.4. Output Control Variables
</h3>  
These variables are specified to control the processing <i>CIFtbx</i> commands that write CIFs.
<p>
<table border=0> 
<tr><td valign="top" align="left"><b><tt>
aliaso_
</tt></b></td><td>
Logical variable to control the use of data name aliases for output items. If 
set <tt>.true.</tt> preferred synonyms from the input dictionary may be output 
(see <a href="#2.6">2.6</a> below). The default is <tt>.false.</tt> 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
align_
</tt></b></td><td>
Logical variable to control the column alignment of data values in <tt>loop_</tt> 
lists output to a CIF. The default is <tt>.true.</tt> 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
esdlim_
</tt></b></td><td>
Integer variable to set the upper limit of appended esd integers output by <tt>pnumb_</tt>. 
The default value is 19, which limits esd's to the range 2 -- 19. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
globo_
</tt></b></td><td>
Logical variable which if set <tt>.true.</tt> will cause the output data block from 
<tt>pdata_</tt> to be written as a global block. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
nblanko_
</tt></b></td><td>
Logical variable controls the treatment of output blank strings. If set 
<tt>.true.</tt> output quoted blank strings will be converted to an 
unquoted period (<i>i.e.</i> to a data item of type null)3. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
pclipt_
</tt></b></td><td>
Logical variable controls whether to clip first character of text on output.
If set to <tt>.true.</tt>, when writing text fields, if there is a blank as 
the first character to be written, it is removed, emulating the behaviour of
<i>CIFtbx</i> versions prior to version 4. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
pdecp_
</tt></b></td><td>
Logical variable controls the treatment of output decimal numbers. If set <tt>.true.</tt> 
a decimal point will be inserted into numbers output by <tt>pnumb_</tt> or 
<tt>pnumbd_</tt>. If set <tt>.false.</tt> a decimal point will be output only when 
needed. The default is <tt>.false.</tt> 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
pdepth_
</tt></b></td><td>
Integer variable containing the depth within a list, array, tuple, or table.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
pesddig_
</tt></b></td><td>
Integer variable to set non-zero, and <tt>esdlim_</tt> is negative, controls the 
number of digits for esd's produced by <tt>pnumb_</tt> and <tt>pnumd_</tt>. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
pfold_
</tt></b></td><td>
Integer variable controlling the character position on which to fold output.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
phtml_
</tt></b></td><td>
Logical variable set to <tt>.true.</tt> to change the output style to HTML
conventions.  The default value is <tt>.false.</tt>
</td></tr>
 
<tr><td valign="top" align="left"><b><tt>
plzero_
</tt></b></td><td>
Logical variable controls the treatment of leading zeros in output decimal numbers. 
If set <tt>.true.</tt> a zero will be inserted before a leading decimal point. The 
default is <tt>.false.</tt> 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
pposdec_
</tt></b></td><td>
Integer variable to set the column number (position along the line, counting from 
1 at the left) of the decimal point for the next number to be output. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
pposdelim_
</tt></b></td><td>
Integer variable to set the column number (position along the line, counting from 
1 at the left) of the next delimiter character to be output. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
pposend_
</tt></b></td><td>
Integer variable to set the position of the ending column for the next number or 
character string to be output. Used to pad with zeros or blanks. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
pposnam_
</tt></b></td><td>
Integer variable to set the starting column of the next name or comment to be output. 
For most purposes the type text is a sub-type of the type char, and not a distinct 
data type. <i>CIFtbx</i> permits multi-line text fields to be used whenever 
character strings are expected. 
<i>CIFtbx</i> treats an unquoted period or question mark as being of type 'null'. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
pposval_
</tt></b></td><td>
Integer variable to set the starting column of the next data value to be output. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
pquote_
</tt></b></td><td>
Character variable containing the quotation symbol to be used for the next string written. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
ptabx_
</tt></b></td><td>
Logical variable is set to <tt>.true.</tt> for tab-stops to be expanded to blanks 
during the creation of a CIF. The default is <tt>.true.</tt> 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
saveo_
</tt></b></td><td>
Logical variable is set <tt>.true.</tt> for pdata_ to output a save-frame, otherwise a 
data block is output. 
</td></tr>
 
<tr><td valign="top" align="left"><b><tt>
tabl_
</tt></b></td><td>
Logical variable is set to <tt>.true.</tt> for tab-stops to be used in the alignment 
of output data. The default is <tt>.true.</tt> 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
unfold_
</tt></b></td><td>
Logical variable is set <tt>.true.</tt> if input lines are to be unfolded
before presentation of data.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
xmlout_
</tt></b></td><td>
Logical variable is set <tt>.true.</tt> to change the output style to 
XML conventions.  Note that this is not a CML output, but a literal
translation from the input CIF.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
xmlong_
</tt></b></td><td>
Logical variable is set <tt>.true.</tt> to change the 
style of XML output if <tt>xmlout_</tt> is <tt>.true.</tt>.  When
<tt>.true.</tt>, XML tag names are the full CIF tag names with 
leading underscore, <tt>_</tt>, removed.  When <tt>.false.</tt>,
an attempt is made to strip the leading category name as well.
</td></tr>
</table>
<p>



<h3 id="2.6" align="left">2.6. Name Aliases
</h3>  
CIF dictionaries written in DDL2 permit data names to be aliased or equivalenced to other data names. This 
serves two purposes. First, it allows for the different data name structures used between DDL1 and 
DDL2 dictionaries (this was discussed in <a href="CHAPTER_1">Chapter 1)</a>, and, second, it links 
equivalent data names within the DDL2 dictionary. Aliasing also allows the use of synonyms appropriate to the application. 
<i>CIFtbx</i> is capable of handling aliased data names transparently so that both the input CIF 
and the application software may use any of the equivalent aliased names. In addition, an output CIF 
may be written with the data names specified in the <i>CIFtbx</i> functions, or with names that 
have been automatically converted to preferred dictionary names. If more than one dictionary is loaded, 
the first aliases normally have priority. We call the preferred dictionary name the "root alias". 
The default behaviour of <i>CIFtbx</i> is to accept all combinations of aliases, and to produce 
output CIFs with the exact names specified in the user calls. The interpretation of aliased data names 
is modified by setting the logical variables <tt>alias_</tt> and <tt>aliaso_</tt>. When <tt>alias_</tt> 
is set <tt>.false.</tt> the automatic recognition and translation of aliases stops. When <tt>aliaso_</tt> 
is set <tt>.true.</tt>, the automatic conversion of user-supplied names to dictionary-preferred 
alias names in writing data to output CIFs is enabled. The preferred alias name is stored in the 
variable <tt>dicname_</tt> following any invocation of a getting function, such as <tt>numb_</tt> 
or <tt>test_</tt>. If <tt>alias_</tt> is set <tt>.false.</tt>, <tt>dicname_</tt> will agree with the 
called name. The variable <tt>tagname_</tt> is always set to the actual name used in an input CIF.
<p> 
For example, the data name <tt>_atom_site_aniso_U_11</tt> from the core dictionary is the alias of 
<tt>_atom_site_anisotrop.u[1][1]</tt> in the mmCIF dictionary. In the following application of 
<i>CIFtbx</i> function <tt>test_</tt> the specified data name <tt>_atom_site_aniso_U_11</tt> is used 
to inquire as to the names used in an input CIF.
<p>
<center>
<table border=1>
<tr><td><pre>  
read(8,'(a)',end=400) name 
f1 = test_(name) 
write(6,'(2(3x,a32)') name,dicname_ 
name=dicname_ 
f1 = test_(name) 
write(6,'(2(3x,a32)') name,tagname_
</pre></td></tr>
</table>
</center>
<p>
Invocation of this code results in the following printout.
<p> 
<tt>_atom_site_aniso_U_11 _atom_site_anisotrop.u[1][1]</tt><br />
<tt>_atom_site_anisotrop.u[1][1] _atom_site_aniso_U_11</tt>
<p>
<h1 id="CHAPTER_3" align="center">CHAPTER 3</h1>
<p> 
<h2 align="center">How to Use the Tool Box</h2>
<p> 
<h3 id="3.1" align="left">3.1. Introduction
</h3> 
<p>
The <i>CIFtbx</i> tool box is supplied as a suite of Fortran source files and test files. The installation 
instructions for <i>CIFtbx</i> are given in Appendix B.
<p>. 
In this chapter we will provide an overview on how to use the <i>CIFtbx</i> tools. 
This will be done using a series of simple application examples. These examples 
are similar to that supplied with the test software. The main source files of <i>CIFtbx</i> are:
<p>
<center>
<table border=1>
<tr><td><pre>
ciftbx.f 
ciftbx.sys (used in ciftbx.f) 
ciftbx.cmn (used in local applications)
 
Versions 2.6 and earlier versions of <i>CIFtbx</i> require certain 
additional source files:
 
ciftbx.cmf
ciftbx.cmv
hash_funcs.f
clearfp.f (or clearfp_sun.f)
</pre></td></tr>
</table>
</center>
<p>
These may be applied to local software in several different ways:
<p> 
1. Compile the <tt>ciftbx.f</tt> and link the resulting object file 
either as an object library, or explicit references in the linking sequence.
(Versions 2.6 and earlier of <i>CIFtbx</i> require <tt>hash_funcs.o</tt> as 
an additional object file.) 
<p>
2. Include <tt>ciftbx.f</tt> in the local software code, so that the toolbox 
will be compiled and linked as part of the local development.
<p> 
Clearly approach 1 is more efficient because the toolbox is only complied once. 
However, for some small applications approach 2. may be simpler. 
Note that the common file <tt>ciftbx.cmn</tt> must be 'included' into any 
local routines that use <i>CIFtbx</i> tools. This will be illustrated in the 
later examples. 
<p>
<h3 id="3.2" align="left">3.2. Reading CIF data
</h3> 
The <i>CIFtbx</i> approach to reading a CIF is best illustrated with a 
simple example. A source code listing of the program CIF_IN is shown below. 
This program reads the file <tt>test.cif</tt> (shown after the source listing). 
While it is doing this it tests 
the input data items against the dictionary file <tt>cif_core.dic</tt>. The output from 
running CIF_IN is shown below. 
<p>
<center>
<table border=1>
<tr><td><pre>
 PROGRAM CIF_IN 
C 
C....A.. Define the data variables 
         <b>include       'ciftbx.cmn'</b> 
         logical       f1,f2,f3 
         character*32  name 
         character*80  line 
         real          cela,celb,celc,siga,sigb,sigc 
         real          x,y,z,u,numb,sdev 
         data          cela,celb,celc,siga,sigb,sigc /6*0.0/
 
C....B.. Assign the <i>CIFtbx</i> files 
         f1 = <b>init_( 1, 2, 3, 6 )</b>
 
C....C.. Request dictionary validation check 
         if(<b>dict_</b>('cif_core.dic','valid')) goto 100 
         write(6,'(/a/)') ' Requested Core dictionary not present'
 
C....D.. Open the CIF to be accessed 
100      name='test.cif' 
         if(<b>ocif_</b>(name))       goto 120 
         write(6,'(a///)') ' >>>>>>>>> CIF cannot be opened'
         stop
 
C....E.. Assign the data block to be accessed 
120      if(.not.<b>data_</b>(' '))          goto 200 
         write(6,'(/a,a/)') ' Access items in data block ',
     *     <b>bloc_</b> 

C....F.. Extract some cell dimensions; test all is OK 
         f1 = <b>numb_</b>('_cell_length_a', cela, siga) 
         f2 = <b>numb_</b>('_cell_length_b', celb, sigb) 
         f3 = <b>numb_</b>('_cell_length_c', celc, sigc) 
         if(.not.(f1.and.f2.and.f3)) write(6,'(a)') 
     *     ' Cell lengths missing!' 
         write(6,'(a,6f10.4)') ' Cell ',cela,celb,celc,
     *      siga,sigb,sigc
 
C....G.. Extract space group notation (expected char string)
         f1 = <b>char_</b>('_symmetry_cell_setting', name) 
         write(6,'(a,a/)') ' Cell setting ',name(1:long_)
 
C....H.. Get the next name in the CIF and print it out 
         f1 = <b>name_</b>(name) 
         write(6,'(a,a/)') ' Next data name in CIF is ',name
 
C....I.. List the audit record (possible text line sequence)
         write(6,'(a)') ' Audit record' 
140      f1 = <b>char_</b>('_audit_update_record', line) 
         write(6,'(a)') line 
         if(<b>text_</b>)  goto 140

C....J.. Extract atom site data in a loop 
         write(6,'(/a)') ' Atom sites' 
160      f1 = <b>char_</b>('_atom_site_label', name) 
         f2 = <b>numb_</b>('_atom_site_fract_x', x, sx) 
         f2 = <b>numb_</b>('_atom_site_fract_y', y, sy) 
         f2 = <b>numb_</b>('_atom_site_fract_z', z, sz) 
         f3 = <b>numb_</b>('_atom_site_U_iso_or_equiv', u, su) 
         write(6,'(1x,a4,4f8.4)') name,x,y,z,u 
         if(<b>loop_</b>) goto 160 
C 
         goto 120 
200      continue 
         end
</pre></td></tr>
</table> 
</center>
<p>
The logic of the program CIF_IN is basically as follows:
<p>
<table border=0 pad=3>
<tr><td valign="top">A</td><td>Define the variables used in the program. The 
common variables for <i>CIFtbx</i> functions are added with the line 'include ciftbx.cmn'.
</td></tr> 
<tr><td valign="top">B</td><td>Assign specific device numbers to the various 
files used in the program using the command init_. The device number 1 refers 
to the input CIF, 3 to the scratch file and 6 (stdout) to the error message 
files. The device number 2 refers to an output CIF, if we were to choose to write one. 
</td></tr>
<tr><td valign="top">C</td><td>Open the dictionary file 'cif_core.dic' with the 
command <tt>dict_</tt>.  This also specifies with the code 'valid' that the 
input data items be validated against the dictionary. Note that <tt>dict_</tt> 
is invoked inside an IF statement which tests if it is <tt>.true.</tt> and 
therefore successful. 
</td></tr>
<tr><td valign="top">D</td><td>Open the CIF 'test.cif' with the command 
<tt>ocif_</tt> and test the returned logical value to see if the file is opened. 
</td></tr>
<tr><td valign="top">E</td><td>Use the <tt>data_</tt> command, containing a 
blank block code, to initiate subsequent data entries at the next encountered 
data block. The data block name is returned in the variable <tt>bloc_</tt> 
which is printed. 
</td></tr>
<tr><td valign="top">F</td><td>Read the cell length values, and their standard 
deviations, with <tt>numb_</tt> and print these out. Test that all of the 
requested data items are found. 
</td></tr>
<tr><td valign="top">G</td><td>The <tt>char_</tt> function is used to read 
a single character string.
</td></tr>
<tr><td valign="top">H</td><td>The <tt>name_</tt> function is used to identify 
the next encountered data item. 
</td></tr>
<tr><td valign="top">I</td><td>This sequence illustrates how text lines are read. 
The <tt>char_</tt> function is used to read each line and the <tt>text_>/tt> 
variable is tested to see if another text line exists in this data item. 
</td></tr>
<tr><td valign="top">J</td><td>This sequence illustrates how a looped list of 
items is read. Individual items are read using <tt>char_</tt> or <tt>numb_</tt>
 functions and the existence of another packet of items is tested with the 
variable <tt>loop_</tt>. 
</td></tr>
</table>
<p>
Here is a listing of the input CIF 'test.cif'.
<p>
<center>
<table border=1>
<tr><td><pre> 
<b>data_mumbo_jumbo</b>
 
_audit_creation_date               91-03-20 
_audit_creation_method             from_xtal_archive_file_using_CIFIO 
_audit_update_record ; 91-04-09           text and data
 added by Tony Willis.
   91-04-15           rec'd by co-editor with diagram as manuscript
 HL7 
; 
_dummy_test       "rubbish to see what dict_ says"
 
_chemical_name_systematic 
    trans-3-Benzoyl-2-(tert-butyl)-4-(iso-butyl)-1,3-oxazolidin-5-one 
_chemical_formula_moiety            'C18 H25 N O3' 
_chemical_formula_weight                                   303.40 
_chemical_melting_point             ?
 
####_cell_length_a                      5.959(1) 
_cell_length_b                     14.956(1) 
_cell_length_c                     19.737(3) 
_cell_measurement_theta_min         25 
_cell_measurement_theta_max         31 
_symmetry_cell_setting             orthorhombic 

loop_ 
_atom_site_label 
_atom_site_fract_x 
_atom_site_fract_y 
_atom_site_fract_z 
_atom_site_U_iso_or_equiv 
_atom_site_thermal_displace_type 
_atom_site_calc_flag
 s .20200 .79800 .91667 .030(3) Uij</sup> ? 
 o .49800 .49800 .66667 .02520  Uiso      ? 
c1 .48800 .09600 .03800 .03170  Uiso      ?
 
loop_ _blat1 _blat2 
1 2 3 4 5 6 a b c d 7 8 9 0
</pre></td></tr>
</table> 
</center>
<p>
Executing CIF_IN produces the following printout.
<p>
<center>
<table border=1>
<tr><td><pre>
 ciftbx warning: test.cif <tt>data_</tt>mumbo_jumbo line:     8
  Data name _dummy_test not in dictionary!
 ciftbx warning: test.cif <tt>data_</tt>mumbo_jumbo line:     35
  Data name _blat1 not in dictionary!
 ciftbx warning: test.cif <tt>data_</tt>mumbo_jumbo line:     
35   Data name _blat2 not in dictionary!  Access items
in data block  mumbo_jumbo

 Cell dimension(s) missing!
 Cell     0.0000   14.9560   19.7370   0.0000    0.0010    0.0030
 Cell setting   orthorhombic
</pre></td></tr>
</table>
</center>
<p>
<center>
<table border=1>
<tr><td><pre>
 Next data name in CIF is _atom_type_symbol 
 Audit record 91-04-09 text and data added 
by Tony Willis.  
 91-04-15          rec'd by co-editor with diagram as manuscript HL7
 
 Atom sites 
 s 0.2020 0.7980 0.9167 0.0300 
 o 0.4980 0.4980 0.6667 0.0252 
 c1 0.4880 0.0960 0.0380 0.0317
</pre></td></tr>
</table>
</center>
<p>
Note the following aspects of the CIF_IN approach to reading data. 
<p>
<ul>
<li>The "ciftbx warning:" messages were generated by the <i>CIFtbx</i> library 
routines, not by the program CIF_IN. These messages result from the checking 
of the input CIF against the dictionary 'cif_core.dic', as requested by the 
<tt>dict_</tt> command. Note also that dictionary validation messages are 
issued on the execution of the <tt>data_</tt> command, because this is when 
all data items in the designated data block (in this case 
mumbo_jumbo) are read from the CIF, stored in a scratch file, checked against 
the dictionary and pointers all pointers and attributes of the items are recorded. 
All subsequent commands use these pointers and the scratch file to access the data.
</li> 
<li>The '####' string in front of <tt>_cell_length_a</tt> makes this data item 
a comment and CIF_IN detects it, via the logical variable f1, as missing.
</li> 
<li>Items may be read from the CIF in any order, with the exception that items 
in the same looped list should be accessed together. If you need to access 
items in different lists simultaneously, then the <tt>bkmrk_</tt> command must 
be used to prevent the <i>CIFtbx</i> loop pointers from being mistakenly reset.
</li>
</ul>
<p> 
<h3 id="3.3" align="left">3.3. Reading text data in loops
</h3>
<p>
This example illustrates how text data is read from lists. This is a typical requirement when reading address labels or audit trails from a CIF. 
Here is the file paper.cif that needs to be read.
<p> 
<center>
<table border=1>
<tr><td><pre>
<b>data_publication</b>
 
loop_ 
_publ_author_name 
_publ_author_address 
 'Furber, Mark' 
; 
Research School of Chemistry 
Australian National University 
GPO Box 4 
Canberra, A.C.T. 
Australia 2601 
; 
 'Mander, Lewis N.' 
; 
Research School of Chemistry 
Australian National University 
GPO Box 4 
Canberra, A.C.T. 
Australia 2601 
;
</pre></td></tr>
</table>
</center>
<p>
Here is an extract from a routine that reads the above addresses.
<p>
<center><table border=1>
<tr><td><pre> 
      if(<tt>data_</tt>('publication')) 
     *  write(6,'(a,a/)') ' Access items in data block ',<tt>bloc_</tt>
C 
      write(6,'(a)') ' Author list' 
210   f1 = <tt>char_</tt>('_publ_author_name', line) 
      write(6,'(/1x,a)') line(1:long_) 
220   f1 = <tt>char_</tt>('_publ_author_address', line) 
      if(line(1:10).eq.' ') goto 230 
      write(6,'(1x,a)') line(1:50) 
230   if(<tt>text_</tt>) goto 220 
      if(<tt>loop_</tt>) goto 210
</pre></td></tr>
</table>
</center>
<p>
The relevant printout from running this routine follows.
<p>
<center>
<table border=1>
<tr><td><pre> 
 Access items in data block publication
 
 Author list
 
 Furber, Mark 
 Research School of Chemistry 
 Australian National University 
 GPO Box 4 
 Canberra, A.C.T. 
 Australia 2601 
 Mander, Lewis N. 
 Research School of Chemistry 
 Australian National University 
 GPO Box 4 
 Canberra, A.C.T. 
 Australia 2601
</pre></td></tr>
</table>
</center>
<p>
Note the following aspects of this run.
<p>
<ul> 
<li>The <tt>char_</tt> command is used to read both the character string item 
<tt>_publ_author_name</tt> and the text lines <tt>_publ_author_address</tt>.
</li>
<li>The <tt>text_</tt> variable is used to monitor whether another text line 
is present in the CIF, and the <tt>loop_</tt> variable is used to monitor if 
there is another name/address packet is present in the loop.
</li>
</ul>
<p> 
<h3 id="3.4" align="left">3.4. Reading user-requested data items
</h3>
<p> 
The first two examples were used to show how data items are read from a CIF 
when the required data names were known in advance, <i>i.e.</i> when pre-ordained data items 
needed to be accessed. In such applications the data names can be 'hardwired' into the program 
code. What about those applications where the input data items are determined by user requests? 
The lack of advance knowledge on what items are to read leads to important differences in 
the programming approach, because now the data attributes of these items cannot be assumed. 
Either these may be determined from the nature of the input values, or from the dictionary.
<p> 
The next program example illustrates how a general list of data requested from an input CIF 
may be handled. The <i>logical function</i> <tt>test_</tt> is used to identify the data type of the 
requested data item, and then the appropriate <tt>numb_</tt> or <tt>char_</tt> is applied to 
enter the data value. Note that the list of requests used in the file 'test.req' is not of 
particular significance for this example; they have been intentionally jumbled with respect 
to the input CIF 'test.cif' (see <a href="#3.2">3.2</a>) to show what happens if a non-loop 
item is accessed within a loop sequence. The <i>CIFtbx</i> routines treat such a "rogue" 
request as a signal to terminate the loop sequence so that the next call for a loop item 
will restart the sequence and extract data from its first packet!
<p> 
Here is an extract of some code that enters the input requests from 'test.req' (shown below), 
and the print the items, their attributes and their values. The printout is shown last.
<p>
<center>
<table border=1>
<tr><td><pre>
      open(unit=8,file='test.req',status='old') 
300   read(8,'(a)',end=400) name 
      if(.not.test_(name)) goto 300 
C 
      if(type_.ne.'numb') goto 320 
      f1 = numb_(name, numb, sdev) 
      write(6,'(a,3x,a,2i5,2f10.4)') 
     * name,type_,long_,list_,numb,sdev
      goto 300 
320   if(type_.ne.'char') goto 340 
      f1 = char_(name, line) 
      write(6,'(a,3x,a,2i5,a)') 
     * name,type_,long_,list_,line(1:long_)
      goto 300 
340   if(type_.ne.'text') goto 300 
      write(6,'(a,3x,a,2i5)') name,type_,long_,list_ 
350   f1 = char_(name, line) 
      write(6,'(a)') line 
      if(text_) goto 350 
      goto 300
</pre></td></tr>
</table>
</center>
<p>
Here is the list of data names in the request file 'test.req'.
<p>
<center>
<table border=1>
<tr><td><pre>  
_dummy_test 
_audit_creation_date 
_audit_creation_method 
_audit_update_record 
_chemical_name_systematic 
_chemical_formula_moiety 
_chemical_formula_weight 
_chemical_melting_point 
_cell_length_a 
_cell_length_b 
_cell_length_c 
_cell_measurement_theta_min 
_cell_measurement_theta_max 
_blat2 
_blat1 
_blat2 
_blat1 
_blat2 
_blat1 
_blat2 
_blat1 
_blat2 
_blat1 
_symmetry_cell_setting
</pre></td></tr>
</table>
</center>
<p>
The printout for this example run follows.
<p>
<center>
<table border=1>
<tr><td><pre>
_dummy_test char 30 0 rubbish to see what dict_ says _audit_creation_date char 8 0 91-03-20 
_audit_creation_method char 34 0 
from_xtal_archive_file_using_CIFIO 
_audit_update_record text 56 0 
 91-04-09 text and data added by Tony Willis.  91-04-15 rec'd by co-editor with diagram as manuscript HL7. 
_chemical_formula_moiety char 12 0 C18 H25 N O3 
_chemical_formula_weight numb 6 0 303.4000 0.0000 
_chemical_melting_point null 1 0 
_cell_length_b numb 9 0 14.9560 0.0010 
_cell_length_c numb 9 0 19.7370 0.0030 
_cell_measurement_theta_min numb 2 0 25.0000 0.3000 
_cell_measurement_theta_max numb 2 0 31.0000 0.3000 
_blat2 char 1 2 2 
_blat1 char 1 2 1 
_blat2 char 1 2 4 
_blat1 char 1 2 3 
_blat2 char 1 2 6 
_blat1 char 1 2 5 
_blat2 char 1 2 b 
_blat1 char 1 2 a 
_blat2 char 1 2 d 
_blat1 char 1 2 c 
_symmetry_cell_setting char 12 0 orthorhombic
</pre></td></tr>
</table>
</center>
<p>
Note the following for this example.
<p>
<ul>
<li>The command <tt>test_</tt> is returned <tt>.true.</tt> if the specified data name 
(in this case input from 'test.req') is present in the input CIF. If it is 
not the test example simply reads another name.
</li> 
<li>The <tt>test_</tt> command sets the variables <tt>type_</tt>, <tt>long_</tt>
and <tt>list_</tt> and these are printed out. The possible values for <tt>type_</tt>
are null, char and numb (a DDL1 dictionary is used in this case). The variable 
<tt>long_</tt> is the length of the value string and <tt>list_</tt> is the 
sequential number of the list block.
</li>
<li>The value ? for <tt>_chemical_melting_point</tt> is treated as a null string 
of length 1.
</li> 
<li>The <tt>_cell_length_a</tt> item is treated as missing because of the 
preceding hashes so that the value of <tt>test_</tt> is <tt>.false.</tt> and is skipped.
<li>The requests for <tt>_blat2</tt> and <tt>_blat1</tt> are interpreted according 
to the values present in the list. Note that this is not intended to be a sensible 
list of data and mixes numbers and character strings. It is shown here simply to 
illustrate how the value of <tt>type_</tt> is returned. For these data items the value of list_ is 2 because they reside in the second looped list of the data block mumbo_jumbo. 
&#8226; Note that the request for _symmetry_cell_setting terminates the loop block settings, and an further requests for _blat2 and _blat1 would start at the first packet of this block. 
</ul>
<p>
<h3 id="3.5" align="left">3.5. Creating a CIF
</h3>
<p>
We will now show how to generate CIF data items. The following example program creates a CIF. 
For the sake of clarity the source code, and the generated CIF 'test.new' (shown later), 
are kept very simple. The initial data definition part of this program has also been 
omitted for brevity.
<p>
<center>
<table border=2>
<tr><td><pre>
C....... Open a new CIF
400      if(<b>pfile_</b>('test.new')) goto 450
         write(6,'(//a/)') ' Output CIF by this name exists already!'
         goto 500
C
C....... Request dictionary validation check
450      if(<b>dict_</b>('cif_core.dic','valid')) goto 260
         write(6,'(/a/)') ' Requested Core dictionary not present'
C
C....... Insert a data block code
460      f1 = <b>pdata_</b>('whoops_a_daisy')
C
C....... Enter various single data items to show how
         f1 = <b>pchar_</b>('_audit_creation_method','using CIFtbx')
         f1 = <b>pchar_</b>('_audit_creation_extra2',"Terry O'Connell")
         f1 = <b>pchar_</b>('_audit_creation_extra3','Terry O"Connell')
         f1 = <b>ptext_</b>('_audit_creation_record',' Text data may be ')
         f1 = <b>ptext_</b>('_audit_creation_record',' entered like this')
         f1 = <b>ptext_</b>('_audit_creation_record',' or in a loop.')
         f1 = <b>pnumb_</b>('_cell_measurement_temperature', 293., 0.)
         f1 = <b>pnumb_</b>('_cell_volume', 1759.0, 13.)
         f1 = <b>pnumb_</b>('_cell_length_b', 8.75353553524313,0.)
         f1 = <b>pnumb_</b>('_cell_length_c', 19.737, .003)
C
C....... Enter some looped data
         f1 = <b>ploop_</b>('_atom_type_symbol')
         f1 = <b>ploop_</b>('_atom_type_oxidation_number')
         f1 = <b>ploop_</b>('_atom_type_number_in_cell')
         do i=1,3
           f1 = <b>pchar_</b>(' ',alpha(1:i))
           f1 = <b>pnumb_</b>(' ',float(i),float(i)*0.1)
           f1 = <b>pnumb_</b>(' ',float(i)*8.64523,0.)
         enddo
C
C....... Do it again but as contiguous data with text data
         f1 = <b>ploop_</b>('_atom_site_label')
         f1 = <b>ploop_</b>('_atom_site_occupancy')
         f1 = <b>ploop_</b>('_some_silly_text')
         do i=1,2
           f1 = <b>pchar_</b>(' ',alpha(1:i))
           f1 = <b>pnumb_</b>(' ',float(i),float(i)*0.1)
           f1 = <b>ptext_</b>(' ',' Hi Ho the diddly oh!')
         enddo
C
C....... Now output some comments and various numeric and esd formats
         f1 = <b>pcmnt_</b>(' ')
         f1 = <b>pcmnt_</b>(' Loops with various numeric and esd formats')
         f1 = <b>ploop_</b>('_numeric_data_1')
         f1 = <b>ploop_</b>('_numeric_data_2')
         f1 = <b>ploop_</b>('_numeric_data_3')
         f1 = <b>ploop_</b>('_numeric_data_4')
         <b>esdlim_</b>g = 19
         <b>pdecp_</b>g = .false.
         <b>plzero_</b>g = .false.
         f1 = <b>pcmnt_</b>(' ')
         f1 = <b>pcmnt_</b>(' <b>esdlim_</b>g=19, <b>pdecp_</b>g=.false., <b>plzero_</b>g=.false.')
         f1 = <b>pnumb_</b>(' ', -.01, 1.)
         f1 = <b>pnumb_</b>(' ', -.1, 10.)
         f1 = <b>pnumb_</b>(' ',-1.,100.)
         f1 = <b>pnumb_</b>(' ',1.,100.)
         <b>pdecp_</b>g = .true.
         <b>plzero_</b>g = .false.
         f1 = <b>pcmnt_</b>(' ')
         f1 = <b>pcmnt_</b>(' <b>esdlim_</b>g=19, <b>pdecp_</b>g=.true., <b>plzero_</b>g=.false.')
         f1 = <b>pnumb_</b>(' ', -.01, 1.)
         f1 = <b>pnumb_</b>(' ', -.1, 10.)
         f1 = <b>pnumb_</b>(' ',-1.,100.)
         f1 = <b>pnumb_</b>(' ',1.,100.)
         <b>esdlim_</b>g = -9999
         <b>plzero_</b>g = .true.
         f1 = <b>pcmnt_</b>(' ')
         f1 = <b>pcmnt_</b>(' <b>esdlim_</b>g=-9999, <b>pdecp_</b>g=.true., <b>plzero_</b>g=.true.')
         f1 = <b>pnumb_</b>(' ', -.01, 1.)
         f1 = <b>pnumb_</b>(' ', -.1, 10.)
         f1 = <b>pnumb_</b>(' ',-1.,100.)
         f1 = <b>pnumb_</b>(' ',1.,100.)
500      call close_
         stop
         end
</pre></td></tr>
</table>
</center>
<p>
Here is the contents of the created CIF 'test.new'.
<p>
<center>
<table border=2><tr><td><pre> 
data_whoops_a_daisy 
_audit_creation_method 'using <i>CIFtbx</i>' 
_audit_creation_extra2 'Terry O'Connell' #< not in dictionary 
_audit_creation_extra3 'Terry O"Connell' #< not in dictionary 
_audit_creation_record 
;Text data may be 
 entered like this 
 or in a loop. 
; 
_cell_measurement_temperature    293 
_cell_volume                     1759(13) 
_cell_length_b                   8.75354 
_cell_length_c                   19.737(3) 
loop_ 
    _atom_type_symbol 
    _atom_type_oxidation_number 
    _atom_type_number_in_cell 
        a            1.00(10)            8.64523 
        ab           2.0(2)              17.2905 
        abc          3.0(3)              25.9357
loop_ 
    _atom_site_label 
    _atom_site_occupancy 
    _some_silly_text                    #< not in dictionary
        a               1.00(10) 
;Hi Ho the diddly oh! 
; 
         ab             2.0(2) 
;Hi Ho the diddly oh! 
; 

# Loops with various numeric and esd formats 
loop_ 
    _numeric_data_1              #< not in dictionary 
    _numeric_data_2              #< not in dictionary 
    _numeric_data_3              #< not in dictionary 
    _numeric_data_4              #< not in dictionary 

# esdlim_=19, pdecp_=.false., plzero_=.false. 
       -.0(10)    -0(10)     -0E1(10)      0E1(10) 

# esdlim_=19, pdecp_=.true., plzero_=.false. 
       -.0(10)    -0.(10)   -0.E1(10)     0.E1(10) 

# esdlim_=-9999, pdecp_=.true., plzero_=.true. 
    -0.01(100)  -0.1(100)    -1.(100)      1.(100)
</pre></td></tr></table>
</center>
<p>
Note the following aspects of this approach.
<p>
<ul> 
<li>Because the dictionary command <tt>dict_</tt> was used, each data name output is checked 
against the dictionary <tt>'cif_core.dic'</tt>. Unrecognised names are flagged with the comment 
<tt>'#< not in dictionary'</tt>. This applies to both looped and single data items.
</li> 
<li>Note in the list of <tt>_numeric_data_</tt> values how the number format control variables 
<tt>esdlim_</tt>, <tt>esdlim_</tt> and <tt>plzero_</tt> differ.
</ul>
<p> 
<h3 id="3.6" align="left">3.6. General tips on applying <i>CIFtbx</i>.</h3>
<p> 
<h3 id="3.6.1" align="left">3.6.1. Reading a CIF</h3>
<p> 
The basic steps for reading a CIF are:
<ul> 
<li>Load any dictionaries required for checking</li> 
<li>Open the CIF to be read </li>
<li>Locate the desired <tt>data_</tt> block within the CIF </li>
<li>Enter the required data items by name </li>
<li>Note that only one input CIF may be open </li>
<li>Note that only one <tt>data_</tt> block may be accessed </li>
<li>Note that within a <tt>data_</tt> block, only one loop_ may be accessed unless the bookmark 
command <tt>bkmrk_</tt> is used to keep the place in multiple loops </li>
</ul>
<p>
<h3 id="3.6.2" align="left">3.6.2. Writing a CIF</h3>
<p> 
For applications writing CIF data, the basic steps needed are
<p>
<ul> 
<li>Load dictionaries required for checking</li> 
<li>Open the output CIF by name </li>
<li>Write the <tt>data_</tt> block header </li>
<li>Write the tags and associated data values for non-loop_ items and/or write a <tt>loop_</tt> 
header followed by all its associated values </li>
<li>Repeat this process for additional <tt>data_</tt> blocks </li>
<li>Close the CIF </li>
<li>Note that only one CIF may be written at once, but an input CIF may also be open </li>
<li>Note that only one <tt>data_</tt> block may be written at once </li>
<li>Note that within a <tt>data_</tt> block, only one loop_ may be written at once </li>
</ul> 
<p>
<h3 id="3.6.3" align="left">3.6.3. Program organisation</h3>
<p> 
The general structure of an application program using the <i>CIFtbx</i> tools is
<p> 
<li>Declarations needed by the application</li> 
<li>Insert <tt>"include 'ciftbx.cmn'"</tt></li> 
<li>Initialize <i>CIFtbx</i> variables </li>
<li>Use <i>CIFtbx</i> initialization and dictionary loading commands</li>
<li>Use functions to open input CIF and/or output CIF </li>
<li>Use functions to read and/or write data items </li>
<li>Calls to subroutine to close CIF </li>
</ul>
<p>
<h1 id="CHAPTER_4" align="center">CHAPTER 4</h1>
<p> 
<h2 align="center">Reference: Initialisation Functions</h2>
<p> 
<h3 id="4.1" align="left">4.1. Introduction</h3>
<p> 
<i>CIFtbx</i> provides two initialisation functions, <tt>init_</tt> and <tt>dict_</tt>, 
which affect all other CIF reading and writing operations. The <tt>init_</tt> function 
is used to assign unit (device) numbers for files used in the <i>CIFtbx</i> processes. 
The <tt>dict_</tt> function inputs the data dictionaries and specifies the conditions 
by which input and output data items are checked.
<p>
These functions, if used, must precede 
all other <i>CIFtbx</i> commands. If the <tt>init_</tt> command is used to change the 
default unit number for a dictionary file, it must precede the relevant <tt>dict_</tt>
command. The command <tt>dict_</tt> is repeated for as many dictionaries as need to be attached to the 
application.
<p> 
<h3 id="4.2" align="left">4.2. init_</h3>
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical function <b>init_</b> (devcif, devout, devdir, deverr)</tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;integer devcif, devout, devdir, deverr</tt><br />
<p> 
<h3 id="4.2.1" align="left">4.2.1 Definition</h3>
<p> 
<tt>init_</tt> is an optional <i>logical function</i> for specifying the Fortran device numbers for the 
four <i>CIFtbx</i> files: the input CIF, the output CIF, an internal scratch file and the error 
message file. The value of the <i>logical function</i> is always returned as <tt>.true.</tt>
<p> 
The <tt>init_</tt> arguments are:
<p>
<table border=0> 
<tr><td>No.</td><td>Augment</td><td>Description</td><td>Default value</td></tr>
<tr><td>1</td><td> &lt;input CIF dev number&gt;</td><td>input CIF device</td><td>1</td></tr> 
<tr><td>2</td><td> &lt;output CIF dev number&gt;</td><td>output CIF device</td><td>2</td></tr>
<tr><td>3</td><td> &lt;scratch file dev number&gt;</td><td>scratch file device</td><td>3</td></tr>
<tr><td>4</td><td> &lt;error file dev number&gt;</td><td>error message device</td><td>6 (stdout)</td></tr>
</table>
<p> 
Note that dictionary files are read using the device number specified by argument 1.
<p>
<h3 id="4.2.2" align="left">4.2.2 Application</h3>
<p> 
<tt>init_</tt> is a <i>logical function</i> that can be applied in a variety of ways. The 
typical coding to apply this function is
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical flag</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.... </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag = <b>init_</b>(arg1,arg2,arg3,arg4)</tt><br />
<p> 
The value returned in flag will always be <tt>.true.</tt> The device numbers are used by 
<i>CIFtbx</i> to open files, but the opening is not initiated by the <tt>init_</tt> call. 
Note that in some circumstances it may be necessary to invoke this command more than once 
in an application. For example,
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag = <b>init_</b>(1,6,3,0)</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag = <b>dict_</b>('cif_mm.dic','valid dtype')</tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag = <b>init_</b>(5,6,3,0) </tt><br />
<p>
is used to attach the dictionary file as unit 1 and after this has been loaded, change the 
input CIF unit to 5.
<p> 
Optimal device numbers
<p> 
The choice of device numbers is application and system dependent. For Unix systems, it is a good 
practice to use device number 0 for the error device number (arg4), where unit 0 is the standard 
error device stderr. For most OS's, device number 6 is the default print device, and is a good 
choice for the error device number (arg4), if 0 is not available. 
<p>
For many systems, device numbers 5 and 6 have special meaning as the default input stdin and list 
devices stdout. If no dictionaries are to be loaded, then 5 may be appropriate for the input CIF 
device number (arg1) and 6 appropriate for the output CIF device number (arg2). If a dictionary 
needs to be loaded, or if the input CIF needs to be a non-default file, then the use of unit 1 
should avoid conflicts with default system behaviour.
<p> 
If the local OS enforces carriage-control on unit 6, or the output CIF needs to be written to a 
non-default file, then unit 2 should avoid conflicts. When the input CIF (arg1) is opened (with 
<tt>ocif_</tt>) or a dictionary is opened (with <tt>dict_</tt>), the data is copied to the 
direct-access file (arg3), and then closed. No close is done if the Fortran open was suppressed 
(see <tt>ocif_</tt>) . Because <i>CIFtbx</i> immediately copies an input CIF to the scratch file, 
it is acceptable for an input CIF to be on a read-once device, such as the standard input device 
(stdin=5) on Unix systems.
<p> 
<h3 align="left"><a href="4.3"></a>4.3. dict_</h3>
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical function <b>dict_</b> (fname, checks)</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character fname*(*), checks*(*)</tt><br />
<p>
<h3 id="4.2.2" align="left">4.2.2 Definition</h3>
<p> 
<tt>dict_</tt> is an optional <i>logical function</i> used to read a CIF dictionary file (or a file containing a list of dictionary filenames) and to initiate optional data checks. The 
<i>logical function</i> is returned as <tt>.true.</tt> if the named dictionary was opened, and if the check codes are recognisable. 
<p>
The command arguments are:
<p> 
<table border=0>
<tr><td>No.</td><td>Augment</td><td>Description</td><td>Default value</td></tr>
<tr><td valign="top">1</td><td valign="top">&lt;dictionary file name&gt;</td><td>filename of a 
dictionary, or of a file containing a list of dictionary filenames, or blank if only 
the checking codes are to be changed. The format of this file is described below</td></tr> 
<tr><td valign="top">2</td><td valign="top">&lt;checking codes&gt;</td><td>codes use to initiate 
CIF checks are entered as a single quoted string separated by blanks:<br />
<tt>'valid'</tt> data name validation check<br /> 
<tt>'catck'</tt> check data categories (default) <br />
<tt>'catno'</tt> reverse of catck <br />
<tt>'dtype'</tt> data <tt>type_</tt> check<br /> 
<tt>'reset'</tt> switch off all checking flags <br />
<tt>'close'</tt> close existing dictionaries <br />
<tt>'first'</tt> give first dictionary priority (default)<br /> 
<tt>'final'</tt> give last dictionary priority <br />
<tt>'nodup'</tt> forbid duplicate data names <br />
</tr>
</table>
<p>
<h3 id="4.3.2" align="left">4.3.2 Application</h3>
<p> 
<tt>dict_</tt> is a <i>logical function</i> and can be applied in a variety of ways. Typically 
the required Fortran coding for the application of this function is
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical flag</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.... </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag = <b>dict_</b>(arg1,arg2) </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( <b>dict_</b>(arg1,arg2)) goto 100</tt><br />
<p> 
The value returned in flag will be <tt>.true.</tt> only if the named dictionary file is opened 
and the listed check codes are recognised.
<p> 
The filename in <tt>arg1</tt> must be appropriate for use in a standard Fortran open statement. 
For example, a dictionary is in a local directory could be <tt>'cif_core.dic'</tt>, whereas a 
dictionary file in a publicly accessible area might be <tt>'/bin/public/cif_core.dic'</tt> The 
sequence of checking codes in <tt>arg2</tt> must be enclosed in quotes and separated by blanks, 
<i>e.g.</i> <tt>'valid dtype'</tt>. 
If the <tt>dict_</tt> command is used, it MUST be BEFORE the <tt>data_</tt> command, to which the data 
checks apply, is invoked.
<p> 
Programmers (and users) needs to appreciate that when data item names are loaded from more than 
one dictionary, the names loaded first have priority over the same or aliased names loaded from 
subsequent dictionaries, unless the checking code final is specified, in which case the order of 
priority is reversed.
<p> 
The <tt>dict_</tt> command sets the <i>CIFtbx</i> variable <tt>dicname_</tt> to either the specified 
filename of the opened dictionary, or, if the opened dictionary file contains the data item 
<tt>_dictionary_name</tt>, to its value. The variable <tt>dicver_</tt> is set to the value of 
<tt>_dictionary_version</tt>
<p>. 
<h1 id="CHAPTER_5" align="center">CHAPTER 5</h1>
<p> 
<h2 align="center">Reference: Read Functions</h2>
<p>
<h3 id="5.1" align="left">5.1. Introduction</h3>
<p> 
This chapter describes in detail the <i>CIFtbx</i> functions that read and check CIF data items. 
Descriptions in this chapter assume knowledge of general principles of CIF implementation and 
application covered in <a href="#CHAPTER_3">Chapter 3</a>.
<p> 
<h3 id="5.1.1" align="left">5.1.1 <i>CIFtbx</i> bookkeeping</h3>
<p> 
As summarised in <a href="3.6.1">3.6.1</a>, there is a required sequence to some <i>CIFtbx</i> 
commands. Device numbers need to be specified, dictionaries loaded and the CIF to be read, 
opened. The command <tt>data_</tt> copies the data in the named data block to the direct access 
file and establishes a list of pointers that locate each data name (tag) in the block. This 
is shown diagrammatically in Fig. 5.1.
<p>
<center>
<img src=CIFtbx_Manual_Fig5_1.jpg width="800px" alt="Figure 5.1"><p>
Fig 5.1.  Preparing to Read a CIF with <i>CIFtbx</i> 
</center>
<p>
Normally only the data from one input CIF is stored in the direct access file. However, if more than 
one CIF needs to be processed simultaneously (e.g. there is a need to move between data blocks 
in different CIFs, the variable append_ set to <tt>.true.</tt> retains previous CIFs in the direct 
access file.
<p> 
<h3 id="5.2" align="left">5.2. ocif_</h3>
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical function <tt>ocif_</tt> (fname)</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character fname*(*) </tt><br />
<p>
<h3 id="5.2.1" align="left">5.2.1 Definition</h3>
<p> 
<tt>ocif_</tt> is an optional <i>logical function</i> for opening an input CIF. The 
value of the function is returned as <tt>.true.</tt> if the named file has been opened. 
<p>
The command argument is:
<p>
<table border=0> 
<tr><td>No.</td><td>Argument</td><td>Description</td></tr> 
<tr><td>1</td><td>&lt;input CIF filename&gt;</td><td>input CIF filename string in quotes</td></tr>
</table> 
<p>
<h3 id="5.2.2" align="left">5.2.2 Application</h3>
<p> 
ocif_ can be applied in a variety of ways. Typically the coding of this function is
<p>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical flag</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;....</tt><br /> 
or <br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag = <tt>ocif_</tt>('arg1')</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( <tt>ocif_</tt>('arg1') ) goto 100 </tt><br />
<p>
Only one CIF may be open at a time. If another CIF needs to be read, and the old data items are not 
required, the <tt>purge_</tt> command is used to close down the existing <i>CIFtbx</i> data tables 
and the CIF. For example,
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call purge_</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;... </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( <tt>ocif_</tt>('next.cif') ) goto 200</tt><br />
<p> 
If the old CIF data items need to be retained and used in conjunction with items from a new CIF, 
the following coding would be typical.
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;append_ = <tt>.true.</tt></tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;... </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( <tt>ocif_</tt>('next.cif') ) goto 200</tt><br />
<p> 
<h3 id="5.3" align="left">5.3. data_</h3><p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical function <tt>data_</tt> (name) </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character name*(*) </tt><br />
<p>
<h3 id="5.3.1" align="left">5.3.1 Definition</h3>
<p> 
<tt>data_</tt> is a <i>logical function</i> for selecting the block of data items to be read. The function 
is returned as <tt>.true.</tt> if the requested data block is found. Only one block may be accessed at a time, 
and each <tt>data_</tt> command removes information of the prior data block. The <tt>data_</tt> command 
initiates any data checking which may have been requested with a prior <tt>dict_</tt> command, and data blocks 
that are not requested will not be checked.
<p> 
The command argument is:
<p>
<table border=0> 
<tr><td>No.</td><td>Argument</td><td>Description</td></tr> 
<tr><td valign="top">1</td><td valign="top">&lt;data block name&gt;</td><td>data block name string in quotes. 
If this is blank, accept <br />
the next encountered data block and place the name in the variable <tt>bloc_</tt>.
</td></tr></table><p> 
<h3 id="5.3.2" align="left">5.3.2 Application</h3><p> 
The <tt>data_</tt> command can be applied in several different ways. Typically the coding of this function is
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( <b>data_</b>('arg1') ) goto 100 </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write(6,'(a)') ' Requested data block not found.'</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stop </tt><br />
or <br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( .not.<b>data_</b>(' ') ) goto 1000 </tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write(6,'(a, a)') ' Data block read: ',bloc_</tt><br />
<p> 
The last statement is typical if the requests for data blocks are in a loop and need to identified.
<p> 
Here is a simple sequence for opening the file test.cif and selecting the data block to be processed.
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character*32 name </tt><br />
<tt>C </tt><br />
<tt>C....... Open the CIF to be accessed</tt><br /> 
<tt>C </tt><br />
<tt>100&nbsp;&nbsp;&nbsp;name='test.cif' </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write(6,'(/2a/)') ' Read data from CIF ',name</tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(ocif_(name)) goto 120 </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write(6,'(a///)') ' >>>>>>>>> CIF cannot be opened'</tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stop </tt><br />
<tt>C </tt><br />
<tt>C....... Assign the data block to be accessed</tt><br /> 
<tt>C </tt><br />
<tt>120&nbsp;&nbsp;&nbsp;if(<b>data_</b>(' ')) goto 130 </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write(6,'(/a/)') ' >>>>>>> No <tt>data_</tt> statement found'</tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stop </tt><br />
<tt>130&nbsp;&nbsp;&nbsp;write(6,'(/a,a/)') ' Access items in data block ',bloc_ </tt><br />
<p>


<h3 id="5.4" align="left">5.4. bkmrk_</h3>
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical function bkmrk_ (mark)</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;integer mark</tt><br />
<p> 
<h3 id="5.4.1" align="left">5.4.1 Definition</h3>
<p> 
<tt>bkmrk_</tt> is a <i>logical function</i> for saving, or restoring, the current position of a data item 
in the data block. It permits data elsewhere in the block to be accessed without losing the current position. 
This function is returned as <tt>.true.</tt> in the save mode provided the internal array ibkmrk can hold 
the current position, and <tt>.true.</tt> in the restore mode if the bookmark number specified was valid. 
If ibkmrk overflows, increase the parameter <tt>MAXBOOK</tt> in <tt>ciftbx.sys</tt>.
<p> 
The command argument is:
<p>
<table border=0> 
<tr><td>No.</td><td>Argument</td><td>Description</td></tr> 
<tr><td valign="top">1</td><td valign="top">&lt;integer variable&gt;</td><td>If specified as 0, the variable is 
returned with a bookmark number pointing to the current location in the data block. If specified as non 
zero, the data pointer is set to that position and the integer variable returned as zero.</td></tr>
</table>
<p> 
<tt>bkmrk_</tt> saves the current position in the data block if <i>arg1</i> is zero, and then returns 
the bookmark number in the argument variable. If the integer variable argument is non-zero, the command 
will restore the position saved for the bookmark number given. The bookmark and the argument are 
cleared. The position set on return allow reprocessing of the data item or loop row last processed 
when the bookmark was placed. All bookmarks are cleared by a call to <tt>data_</tt>.
<p> 
<h3 id="5.4.2" align="left">5.4.2 Application</h3> 
<tt>bkmrk_</tt> can be applied in a variety of ways. Typically this function is used in the save mode as:
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;integer iset, imark</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;... </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iset = 0 </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( bkmrk_(iset) ) goto 100 </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write(6,'(a)') ' Bookmark array has been exceeded.'</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stop </tt><br />
<tt>100&nbsp;&nbsp;&nbsp;imark = iset </tt><br />
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and in restore mode as: <br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iset = imark </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( bkmrk_(iset) ) goto 200 </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write(6,'(a)') ' Bookmark entry does not exist.' </tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stop</tt><br />
<p> 
<h3 id="5.5" align="left">5.5. find_</h3>
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical function find_ (name, type, strg)</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character name*(*), type*(*), strg*(*)</tt><br />
<p>
<h3 id="5.5.1" align="left">5.5.1 Definition</h3>
<p>
<tt>find_</tt> is a <i>logical function</i> used to locate a requested item, name or value, in the current 
data block, and to return the appropriate string as an argument. The function is returned 
as <tt>.true.</tt> if the item is found.
<p> 
The command arguments are:
<p>
<table border=0> 
<tr><td>No.</td><td>Argument</td><td>Description</td></tr> 
<tr><td valign="top">1</td><td valign="top">&lt;data name&gt;</td><td>The item to be positioned at in quotes. 
A blank implies the next item encountered.</td></tr> 
<tr><td valign="top">2</td><td valign="top">&lt;string type code&gt;</td><td><br />
<tt>'head'</tt>reposition at start of CIF<br />
<tt>'name'</tt>reposition at the item name<br /> 
<tt>'valu'</tt>reposition at the item value<br /> 
<tt>' '</tt> reposition at next string</td></tr> 
<tr><td>3</td><td>&lt;returned string&gt;</td><td>returned character string specified.</td></tr>
</table>
<p> 

<h3 id="5.5.2" align="left">5.5.2 Application</h3>
<p> 
<tt>find_</tt> may be applied in a variety of ways. Typically the application is as
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character string*(MAXBUF)</tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...</tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( find_('_atomic_number', 'valu', string) ) goto 100</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write(6,'(a)') ' atomic number not found')</tt><br />
<p>
<h3 id="5.6" align="left">5.6. test_</h3><p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical function <b><tt>test_</tt></b> (name)</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character name*(*)</tt><br />
<p>
<h3 id="5.6.1" align="left">5.6.1 Definition</h3><p>
<tt>test_</tt> is a <i>logical function</i> used to identify the data attributes of a data item in the current data block. 
The function is returned as <tt>.true.</tt> if the item is found. The data attributes are stored in the 
common variables <tt>list_</tt>, <tt>type_</tt>, <tt>dictype_</tt>, <tt>diccat_</tt> and <tt>dicname_</tt>. 
The values in <tt>dictype_</tt>, <tt>diccat_</tt> and <tt>dicname_</tt> are valid even if the data item 
is not found in the data block, provided it is present in the dictionaries loaded with the <tt>dict_</tt> 
command. The data name in the input CIF (as opposed to any of the possible aliased names) is stored in 
<tt>tagname_</tt>. The line positions of the name and values are stored in <tt>posnam_</tt> and 
<tt>posval_</tt> and for numbers, the position of the decimal point is stored in <tt>posdec_</tt>. The 
quotation mark, if any, used is stored in <tt>quote_</tt>.
<p>
The command arguments are:
<p> 
<table border=0>
<tr><td>No.</td><td>Argument</td><td>Description</td></tr> 
<tr><td valign="top">1</td><td valign="top">&lt;data name&gt;</td>
<td>The item to be tested at in quotes. A blank implies the next item encountered.</td></tr>
</table>
<p> 
The <i>CIFtbx</i> variables returned are as follows 
<tt>list_</tt> is an integer variable containing the sequential number of the loop block in 
the data block. If the item is not within a loop structure this value will be zero. 
<tt>type_</tt> is a character*4 variable with the possible values:<br />
<tt>'numb'</tt> for number data<br /> 
<tt>'char'</tt> for character data<br /> 
<tt>'text'</tt> for ext data<br /> 
<tt>'null'</tt> if data missing or '?' or '.'
<p> 
<tt>dictype_</tt> is a character*(<tt>NUMCHAR</tt>) variable with the type code given 
in the dictionary entry for the named data item. If no dictionary was used, or no type 
code was specified, this field will simply agree with <tt>type_</tt>. If a dictionary 
was used, this type may be more specific than the one given by <tt>type_</tt>.
<p> 
<tt>diccat_</tt> is a character*(<tt>NUMCHAR</tt>) variable with the category of the 
named data item, or <tt>'(none)'</tt>
<p> 
<tt>dicname_</tt> is a character*(<tt>NUMCHAR</tt>) variable with the name of the 
data item that is found in the dictionary for the named data item. If <tt>alias_</tt>
 is <tt>.true.</tt>, this name may differ from the name given in the call to 
<tt>test_</tt>. If <tt>alias_</tt> is <tt>.false.</tt> or no preferred alias is found, 
<tt>dicname_</tt> agrees with the data item name.
<p> 
<tt>tagname_</tt> is a character*(<tt>NUMCHAR</tt>) variable with the name of the 
data item as found in the input CIF. It will be blank if the data item name requested 
is not found in the input CIF and may differ from the data item name provided by the 
user if the name used in the input CIF is an alias of the data item name and <tt>alias_</tt> 
is <tt>.true.</tt>
<p>
<tt>posnam_</tt>, <tt>posval_</tt> and <tt>posdec_</tt> are integer variables that may 
be examined if information about the horizontal position of the name and data read are 
needed. <tt>posnam_</tt> is the starting column of the data name found (most often 1).
<tt>posval_</tt> is the starting column of the data value. If the field is numeric, 
then <tt>posdec_</tt> will contain the effective column number of the decimal point. 
For whole numbers, the effective position of the decimal point is one column to the 
right of the field.
<p> 
<tt>quote_</tt> is a character*1 variable that may be examined to determine if a 
quotation character was used on character data. 
<p>
<h3 id="5.6.2" align="left">5.6.2 Application</h3>
<p> 
<tt>test_</tt> may be applied in a variety of ways. Here is one coding of this function.
<p>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( .NOT.test_('arg1') ) goto 300</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( <tt>type_</tt> .NE. 'char' ) goto 100 </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag = char_(tagname_, string) </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto 200 </tt><br />
<tt>100&nbsp;&nbsp;&nbsp;if( <tt>type_</tt> .NE. 'numb' ) goto 120 </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag = numb_(tagname_, value, esdval) </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto 200</tt><br />
<p> 
The following coding is from supplied test example application <tt>tbx_ex.f</tt>. 
This shows how a list of data requests in the file <tt>'test.req'</tt> may be 
handled. The
<p> 
function <tt>test_</tt> is used to type the requested item, 
and then <tt>numb_</tt> and <tt>char_</tt> are used to get the data values. 
<p>
<tt>C</tt><br />
<tt>C....... Loop over the data request file</tt><br /> 
<tt>C </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;open(unit=8,file='test.req',status='old') </tt><br />
<tt>300&nbsp;&nbsp;&nbsp;read(8,'(a)',end=400) name </tt><br />
<tt>C </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f1 = test_(name) </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write(6,'(/a,3x,a,2i5)') name,type_,long_,list_ </tt><br />
<tt>C </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(type_.ne.'numb') goto 320 </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f1 = numb_(name, numb, sdev) </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write(6,'(2f10.4)') numb,sdev </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto 300 </tt><br />
<tt>C </tt><br />
<tt>320&nbsp;&nbsp;&nbsp;if(type_.ne.'char') goto 340 </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f1 = char_(name, line) </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write(6,'(a)') line(1:long_) </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto 300 </tt><br />
<tt>C </tt><br />
<tt>340&nbsp;&nbsp;&nbsp;if(type_.ne.'text') goto 300 </tt><br />
<tt>350&nbsp;&nbsp;&nbsp;f1 = char_(name, line) </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write(6,'(a)') line </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(text_) goto 350 </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto 300</tt><br />
<p>

<h3 id="5.7" align="left">5.7. name_ </h3><p>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical function name_ (name) </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character name*(*)  </tt><br />
<p>
<h3 id="5.7.1" align="left">5.7.1 Definition</h3>
<p> 
<tt>name_</tt> is a <i>logical function</i> used to identify the next 
data name in the current data block, and to return that string as an 
argument. The function is returned as <tt>.true.</tt> if another item is 
found in the current data block. 
<p>
The command arguments are:
<p>
<table border=0> 
<tr><td>No.</td><td>Argument</td><td>Description</td></tr> 
<tr><td>1</td><td>&lt;RETURNED data name&gt;</td><td>The next encountered data name.</td></tr>
<p> 
<h3 id=5.7.2 align="left">5.7.2 Application</h3>
<p> 
<tt>name_</tt> may be applied in a variety of ways. Typically the application is
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character string*(MAXBUF)</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;... </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag = name_(string) </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag = test_(string) </tt><br />
<p>
<h3 id="5.8" align="left">5.8. numb_</h3><p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical function <b><tt>numb_</tt></b> (name, numb, sdev) </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character name*(*) </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;real numb, sdev </tt><br />
<p>
<h3 id="5.8.1" align="left">5.8.1 Definition</h3>
<p> 
<tt>numb_</tt> is a <i>logical function</i> used to read the numerical value and esd value 
(if appended) of a specified data name in the current data block. The function is returned 
as <tt>.true.</tt> if the item is found and is a number. If <tt>.false.</tt> arguments 2 
and 3 are unchanged. If the esd is not attached to the number argument 3 is unaltered.
<p> 
The command arguments are:
<p> 
<table border=0>
<tr><td>No.</td><td>Argument</td><td>Description</td></tr>
<tr><td valign="top">1</td><td valign="top">&lt;data name&gt;</td><td>Specified data name of item.</td></tr>
<tr><td valign="top">2</td><td valign="top">&lt;real number variable&gt;</td>
<td>Returned number value of item.</td></tr>
<tr><td valign="top">3</td><td valign="top">&lt;real number variable&gt;</td>
<td>Returned esd of the number value.</td></tr>
<p>
<h3 id="5.8.2" align="left">5.8.2. Application</h3>
<p> 
<tt>numb_</tt> is usually applied as follows.
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical flag </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;real value, esdval </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character name*(MAXBUF) </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;... </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag = <b>numb_</b>(name, value, esdval)</tt><br />
<p> 
<h3 id="5.9" align="left">5.9. numd_</h3>
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical function <b>numd_</b> (name, numb, sdev) </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character name*(*) </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;double precision numb, sdev </tt><br />
<p> 
<h3 id="5.9.1" align="left">5.9.1. Definition</h3><p> 
<p>
<tt>numd_</tt> is a <i>logical function</i> used to read a double-precision number and esd 
value (if appended) of a specified data name in the current data block. The function is 
returned as <tt>.true.</tt> if the item is found and is a number. If <tt>.false.</tt> 
arguments 2 and 3 are unchanged. If the esd is not attached to the number argument 3 
is unaltered.
<p> 
The command arguments are:<p>
<table border=0>
<tr><td>No.</td><td>Argument</td><td>Description</td></tr>
<tr><td valign="top">1</td><td valign="top">&lt;data name&gt;</td><td>Specified data name of item.</td></tr>
<tr><td valign="top">2</td><td valign="top">&lt;double number variable&gt;</td>
<td>Returned number value of item.</td></tr>
<tr><td valign="top">3</td><td valign="top">&lt;double number variable&gt;</td>
<td>Returned esd of the number value.</td></tr> 
</table>
<p> 
<h3 id="5.9.2" align="left">5.9.2 Application</h3>
<p> 
<tt>numd_</tt> is typically used as follows.
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical flag</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;double precision dvalue, desdval</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character name*(MAXBUF) </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;... </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag = numd_(name, dvalue, desdval)</tt><br /> 
<p>
<h3 id="5.10" align="left">5.10. cmnt_</h3>
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical function cmnt_ (strg)</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character strg*(*)</tt><br />
<p> 
<h3 id="5.10.1" align="left">5.10.1 Definition</h3>
<p> 
<tt>cmnt_</tt> is a <i>logical function</i> used to read the next comment string in the current data 
block. The function is returned as <tt>.true.</tt> if a comment is found. The initial comment character 
"#" is not included in the returned string. A completely blank line is treated as a comment.
<p> 
The command arguments are:
<p>
<table border=0> 
<tr><td>No.</td><td>Argument</td><td>Description</td><tr> 
<tr><td>1</td><td>&lt;Returned char variable</td><td>The returned character string of length <tt>long_</tt>.</td></tr>
</table>
<p> 
<h3 id="5.10.2" align="left">5.10.2 Application</h3>
<p> 
<tt>cmnt_</tt> is usually applied as follows.
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical flag</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character coment*(MAXBUF) </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;... </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag = <b>cmnt_</b>(coment)</tt><br />
<p> 
<h3 id="5.11" align="left">5.11. purge_</h3>
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subroutine <b>purge_</b></tt>
<p> 
<h3 id="5.11.1" align="left">5.11.1 Definition</h3> 
<p>
<h3 id="5.11.2" align="left">5.11.2 Application</h3> 
purge_ is called after all data access and output activities are complete. call purge_ 
<p>

<h1 id="CHAPTER_6" align="center">CHAPTER 6</h1>
<p> 
<h2 id="Reference_Write_Functions" align="center">Reference: Write Functions</h2>
<p> 
<h3 id="6.1" align="left">6.1. Introduction
</h3> 
<p>
The functions needed to write a CIF are similar to those described in <a href="#CHAPTER_5">Chapter 5</a>
to read a CIF. A summary of the <i>CIFtbx</i> writing tools is given in <a href="#CHAPTER_2">Chapter 2</a>. 
The basic steps involved in writing CIF data are as follows.
<p>
<ul>
<li>load the <i>CIFtbx</i> common variables<br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;include 'ciftbx.cmn'</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical flag</tt>
</li>
<li>open the output CIF<br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag = <b>pfile_</b>(&lt;<i>file name</i>&gt;)</tt><br /> 
The <i>file name</i> is entered as blank if items are to be written to an output CIF that has already 
been opened. If a non-blank <i>file name</i> is entered and the named file is already open the value 
of flag will be returned as <tt>.false.</tt>
</li> 
<li>write the <tt>data_</tt> block header line<br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag = <b>pdata_</b>(&lt;<i>block name</i>&gt;)</tt><br /> 
If a data block of the same name already exists in the output CIF the value of <tt>flag</tt> will 
be returned as <tt>.false.</tt>
</li> 
<li>write the data items to the CIF 
Values are written with <tt>pchar_</tt>, <tt>pnumb_</tt>, <tt>pnumd_</tt> or <tt>ptext_</tt>.
</li>
<li>close the output CIF</br > 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call close_</tt><br /> 
Must be done after the last data value or comment is written.
</li>
</ul>
<p> 
<h3 id="6.2" align="left">6.2. pfile_
</h3>
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical function <b>pfile_</b> (fname)</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character fname*(*)</tt>
<p> 
<h3 id="6.2.1" align="left">6.2.1. Definition
</h3> 
<tt>pfile_</tt> is a <i>logical function</i> for opening an output file with the specified file name.
<p> 
The command arguments are:
<p>
<table border=0>
<tr><td>No.</td><td>Argument</td><td>Description</td></tr> 
<tr><td>1</td><td> &lt;file name&gt;</td><td> Blank for use of currently open file</td></tr>
</table> 
<p>
If the filename is entered as blank, items will be written to an output CIF that has already been opened. 
If a non-blank file name is entered, and the named file is already open, the value of flag will be returned 
as <tt>.false.</tt>
<p> 
<h3 id="6.2.2" align="left">6.2.2. Application
</h3>
<p> 
<tt>pfile_</tt> is typically applied as follows.
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character*(MAXBUF) fname</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical flag</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag = <b>pfile_</b>(fname)</tt><br /> 
<p> 
<h3 id="6.3" align="left">6.3. pdata_
</h3>
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical function <b>pdata_</b> (name)</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character name*(*)</tt><br />
<p> 
<h3 id="6.3.1" align="left">6.3.1. Definition
</h3> 
<tt>pdata_</tt> is a <i>logical function</i> for writing a data block header line into the output CIF. The 
value of the function is returned as <tt>.true.</tt> if the block is created. The value will be 
<tt>.false.</tt> if the block name already exists in the output CIF. This function produces 
a save frame instead of a data block if the variable <tt>saveo_</tt> is true during the call. 
No block duplicate check is made for a save frame.
<p> 
The command arguments are:
<p>
<table border=0>
<tr><td>No.</td><td>Argument</td><td>Description</td></tr> 
<tr><td>1<td></td> &lt:block name&gt;<td></td> Blank for use of the next data block</td></tr>
</table>
<p>
<h3 id="6.3.2" align="left">6.3.2. Application
</h3> 
<p>
<tt>pdata_</tt> is usually applied as follows.
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character*(MAXBUF) bname</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical flag</tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag = pdata_(bname)</tt><br />
<p> 
The following example code is used to open a new output CIF and to write the first <tt>data_</tt> block header.
<p>
<center>
<table border=1>
<tr><td><pre> 
C....... Open a new CIF 
400&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(pfile_('test.new')) goto 450 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write(6,'(//a/)') 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* ' Output CIF by this name exists already!' 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto 500 
C 
C....... Insert a data block code 
450&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f1 = pdata_('whoops_a_daisy')
</pre></td></tr>
</table>
</center>
<p>
<h3 id="6.4" align="left">6.4. ploop_
</h3>
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical function <b>ploop_</b> (name)</tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character name*(*)</tt><br />
<p> 
<h3 id="6.4.1" align="left">6.4.1. Definition
</h3>
<p> 
<tt>ploop_</tt> is a <i>logical function</i> for writing a data name belonging to a list of items 
(i.e. a <tt>loop_</tt>) being written to the output CIF. The value of the function is returned as 
<tt>.true.</tt> if the application conforms with the list syntax.
<p> 
The command arguments are:
<p> 
<table border=0>
<tr><td>No.</td><td>Argument</td><td>Description</td></tr>
<tr><td>1</td><td> &lt;data name&gt;</td><td> Data name of the item that is a member of a list 
of items.</td></tr></table>
<p> 
<h3 id="6.4.2" align="left">6.4.2. Application
</h3> 
<p>
<tt>ploop_</tt> is usually applied as follows.
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character*(MAXBUF) tname</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical flag </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;... </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag = ploop_(tname)</tt><br /> 
<p>
Here is example code showing how data names, and data values, are added to an output CIF.
<p>
<center>
<table border=1>
<tr><td><pre> 
C....... Enter some looped data 
         f1 = ploop_('_atom_type_symbol') 
         f1 = ploop_('_atom_type_oxidation_number') 
         f1 = ploop_('_atom_type_number_in_cell') 
         do 470 i=1,10 
         f1 = pchar_(' ',alpha(1:i)) 
         f1 = pnumb_(' ',float(i),float(i)*0.1) 
470      f1 = pnumb_(' ',float(i)*8.64523,0.)
</pre></td></tr>
</table>
</center>
<p>
The above code produces the following output. Note that the <tt>loop_</tt> header was created 
automatically by the first <tt>ploop_</tt> call.
<p>
<center>
<table border=1>
<tr><td><pre>
loop_ 
_atom_type_symbol 
_atom_type_oxidation_number 
_atom_type_number_in_cell 
a            1.00(10)       8.64523 
ab           2.0(2)         17.2905 
abc          3.0(3)         25.9357 
abcd         4.0(4)         34.5809 
abcde        5.0(5)         43.2262 
abcdef       6.0(6)         51.8714 
abcdefg      7.0(7)         60.5166 
abcdefgh     8.0(8)         69.1618 
abcdefghi    9.0(9)         77.8071 
abcdefghij   10.0(10)       86.4523
</pre></td></tr></table></center>
<p>
<h3 id="6.5" align="left">6.5. pchar_
</h3>
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical function <b>pchar_</b> (name, string)</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character name*(*), string*(*)</tt><br />
<h3 id="6.5" align="left">6.5.1. Definition
</h3>
<p> 
<tt>pchar_</tt> is a <i>logical function</i> for writing a character string to the output CIF. The 
value of the function is returned as <tt>.true.</tt> if the name is unique AND if <tt>dict_</tt> is 
invoked, the name is defined in the dictionary AND the invocation conforms to the CIF logical 
structure. The action of <tt>pchar_</tt> is modified by the variables <tt>pquote_</tt> and <tt>nblanko_</tt>. 
If <tt>pquote_</tt> is non-blank, it is used as a quotation character for the string written by <tt>pchar_</tt>. 
The valid values are '''', '"', and ';'. In the last case a text field is written. If the string contains 
a matching character to the value of <tt>quote_</tt>, or if <tt>quote_</tt> is not one of the 
valid quotation characters, a valid, non-conflicting quotation character is used. Except when 
writing a text field, if <tt>nblanko_</tt> is true, <tt>pchar_</tt> converts a blank string to 
an unquoted period.
<p>
The command arguments are:
<p>
<table border=0>
<tr><td>No.</td><td>Argument</td><td>Description</td></tr> 
<tr><td>1</td><td> &lt;data name&gt;</td><td> If the name is blank, do not output name.</td></tr>
<tr><td>2</td><td> &lt;character string&gt;</td><td> A character string of <tt>MAXBUF</tt> chars or less.</td></tr>
</table>
<p>
<h3 id="6.5.2" align="left">6.5.2. Application
</h3>
<p>
<tt>pchar_</tt> is typically applied as follows.
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character*(MAXBUF) tname</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character*(MAXBUF) string</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical flag </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;... </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag = <b>pchar_</b>(tname,string)</tt><br /> 
<p>
<h3 id="6.6" align="left">6.6. pcmnt_
</h3>
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical function <b>pcmnt_</b> (string)</tt><br />  
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character string*(*) </tt><br /> 
<p>
<h3 id="6.6.1" align="left">6.6.1. Definition
</h3> 
<tt>pcmnt_</tt> is a <i>logical function</i> for writing a comment; string to the output CIF. 
The value of the function is returned <tt>.true.</tt> The comment character "#" should not be 
included in the string. A blank comment is presented as a blank line without the leading "#".
<p> 
The command arguments are:
<p>
<table border=0>
<tr><td>No.</td><td>Argument</td><td>Description</td></tr> 
<tr><td>1</td><td> &lt;character string&gt;</td><td> A character string of <tt>MAXBUF</tt> chars or less.</td></tr>
</table>
<p>
<h3 id="6.6.2" align="left">6.6.2. Application
</h3>
<p>
<tt>pcmnt_</tt> is typically applied as follows.
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character*(MAXBUF) string</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical flag</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;... </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag = <b>pcmnt_</b>(string)</tt><br />
<p> 
Here is and example of how two comments are written to the output file.
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f1 = pcmnt_(' ') </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f1 = pcmnt_(' Loops with various numeric and esd formats')</tt><br />
<p>

<h3 id="6.7" align="left">6.7. pnumb_
</h3>
<p>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical function <b>pnumb_</b> (name, numb, sdev)</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character name*(*) </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;real numb, sdev </tt><br />
<p>
<h3 id="6.7.1" align="left">6.7.1. Definition
</h3> 
<tt>pnumb_</tt> is a <i>logical function</i> for writing a single precision number and its esd
 to the output CIF. The value of the function is returned as <tt>.true.</tt> if the name is unique 
AND if <tt>dict_</tt> is invoked, the name is defined in the dictionary AND the invocation 
conforms to the CIF logical structure. The number of esd digits is controlled by the 
variable <tt>esdlim_</tt>.
<p> 
The command arguments are: 
<p>
<table border=0>
<tr><td>No.</td><td>Argument</td><td>Description</td></tr>
<tr><td>1</td><td> &lt;data name&gt;</td><td> If the name is blank, do not output name.</td></tr>
<tr><td>2</td><td> &lt;real variable&gt;</td><td> Number to be inserted.</td></tr> 
<tr><td>3</td><td> &lt;real variable&gt;</td><td> Esd number to be appended in parentheses.</td></tr>
</table>
<p>

<h3 id="6.7.2" align="left">6.7.2. Application
</h3>
<p> 
<tt>pnumb_</tt> is usually applied as follows.
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character*(MAXBUF) tname </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;real xnumb, xesd </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical flag </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;... </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag = <b>pnumb_</b>(tname, xnumb, xesd)</tt><br />
<p> 
<h3 id="6.8" align="left">6.8. pnumd_
</h3>
<p>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical function <b>pnumd_</b> (name, numb, sdev) </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character name*(*) </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;double precision numb, sdev</tt><br />
<p> 
<h3 id="6.8.1" align="left">6.8.1. Definition
</h3> 
<tt>pnumd_</tt> is a <i>logical function</i> for writing a double precision; number and its esd; 
to the output CIF. The value of the function is returned as <tt>.true.</tt> when the name is 
unique, AND, if <tt>dict_</tt> is invoked, the name is defined in the dictionary, AND the invocation 
conforms to the CIF logical structure. The number of esd digits is controlled by the variable <tt>esdlim_</tt>. 
The command arguments are: 
<p>
<table border=0>
<tr><td>No.</td><td>Argument</td><td>Description</td></tr>
<tr><td>1</td><td> &lt;data name&gt;</td><td> If the name is blank, do not output name.</td></tr>
<tr><td>2</td><td> &lt;double precision variable&gt;</td><td> Number to be inserted.</td></tr> 
<tr><td>3</td><td> &lt;double precision variable&gt;</td><td> Esd number to be appended in parentheses.</td></tr>
</table>
<p> 
<h3 id="6.8.2" align="left">6.8.2. Application
</h3>
<p> 
<tt>pnumb_</tt> is usually applied as follows.
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character*(MAXBUF) tname </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;double precision xnumb, xesd </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical flag </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;... </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag = <b>pnumd_</b>(tname, xnumb, xesd) </tt><br />
<p>
<h3 id="6.9" align="left">6.9. ptext_
</h3> 
<p>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical function <b>ptext_</b> (name, string) </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character name*(*), string*(*)  </tt><br /
<p>
<h3 id="6.9.1" align="left">6.9.1. Definition
</h3> 
<tt>ptext_</tt> is a <i>logical function</i> for writing character string data to the output CIF. The 
<i>logical function</i> returned as <tt>.true.</tt> if the name is unique AND if <tt>dict_</tt> is invoked, the 
name is defined in the dictionary AND the invocation conforms to the CIF logical structure. <tt>ptext_</tt> 
is invoked repeatedly until the text is finished. Only the first invocation will insert a data name.
<p> 
The command arguments are: 
<p>
<table border=0> 
<tr><td>No.</td><td>Argument</td><td>Description</td></tr> 
<tr><td>1</td><td> &lt;data name&gt;</td><td> If the name is blank, do not output name.</td></tr> 
<tr><td>2</td><td> &lt;character string&gt;</td><td> A character string of <tt>MAXBUF</tt> chars or less.</td></tr>
</table>
<p>
<h3 id="6.9.2" align="left">6.9.2. Application
</h3> 
<tt>ptext_</tt> is usually applied as follows.
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character*(MAXBUF) tname </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character*78 string(10) </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical flag </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;integer ii </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;... </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do ii = 1,10 </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag = <b>ptext_</b>(tname, string(ii)) </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enddo </tt><br />
<p> 
Here is code to write three lines of text.
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f1 = <b>ptext_</b>('_audit_creation_record',' Text data may be ')</tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f1 = <b>ptext_</b>('_audit_creation_record',' entered like this')</tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f1 = <b>ptext_</b>('_audit_creation_record',' or in a loop.')</tt><br />
<p>
This produces the following CIF output. Note the comment created by <i>CIFtbx</i> because 
the tag is not in the dictionary being used.
<p>
<table border=1>
<tr><td><pre> 
_audit_creation_record #< not in dictionary ;Text data may be 
entered like this 
or in a loop.
</pre></td></tr>
</table>
<p> 
<h3 id="6.10" align="left">6.10. prefx_
</h3> 
<p>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical function prefx_ (strg, lstrg) </tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character strg*(*) </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;integer lstrg </tt><br />
<p>
<h3 id="6.10.1" align="left">6.10.1. Definition
</h3> 
<tt>prefx_</tt> is a <i>logical function</i> for writing a prefix string to subsequent lines 
of the output CIF. The <i>logical function</i> returned as <tt>.true.</tt> The second argument 
may be zero to suppress a previously used prefix, or greater than the non-blank length of the 
string to force a left margin. Any change in the length of the prefix string flushes pending 
partial output lines, but does not force completion of pending text blocks or loops. This 
function allows the CIF output functions to be used within what appear to be text fields to 
support annotation of a CIF.
<p> 
The command arguments are:
<p>
<table border=0> 
<tr><td>No.</td><td>Argument</td><td>Description</td></tr> 
<tr><td>1</td><td>&lt;character string&gt;</td><td>A character string of <tt>MAXBUF</tt> chars or less.</td></tr> 
<tr><td>2</td><td>&lt;integer variable&gt;</td><td>The length of the prefix string to use.</td></tr>
</table>
<p>
<h3 id="6.10.2" align="left">6.10.2. Application</h3>
<p> 
<tt>prefx_</tt> is usually applied as follows.
<p> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character*10 string</tt><br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;integer lstr </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical flag </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;... </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lstr = len(string) </tt><br />
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag = prefx_(string, lstr)</tt><br />
<p> 
<h3 id="6.11" align="left">6.11. close_
</h3>
<p>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subroutine close_</tt>
<p>
<h3 id="6.11.1" align="left"> 6.11.1. Definition
</h3> 
close_ is a subroutine called to close the creation CIF.
<p> 
<h3 id="6.11.2" align="left">6.11.2. Application
</h3> 
<tt>close_</tt> must be used if <tt>pfile_</tt> is used.<br /> 
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call close_</tt>
<p> 
<h1 id="CHAPTER_7" align="center">CHAPTER 7</h1>
<p> 
<h2 id="Reference_Variables" align="center">Reference: Variables</h2>
<p> 
Most simple <i>CIFtbx</i> applications need be aware of just a few basic variables: 
<tt>list_</tt>, <tt>loop_</tt>, <tt>strg_</tt>, <tt>text_</tt>, and <tt>type_</tt>. 
For advanced applications, a rich environment of general monitor, general control, 
input monitor and output control variables is provided.
<p>
<center>
<table border=1>
<tr> 
<th align="center">General<br />Monitor</th>
<th align="center">General<br />Control</th>
<th align="center">Input<br />Monitor</th>
<th align="center">Output<br />Control</th>
</tr>
<tr>
<td align="center" valign="top"><tt>
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
file_<br />
<br />
<br />
<br />
<br /> 
longf_<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br /> 
precn_<br />
<br />
<br />
<br /> 
recn_<br />
<br />
<br />
<br />
<br />
<br />
tbxver_<br />
</tt></td>
<td align=center valign="top"><tt>
alias_<br />
<br />
append_<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br /> 
line_<br />
<br />
<br />
<br />
<br />
<br />
nblank_<br />
rdbkt_<br />
rdbrc_<br />
rdcolon_<br />
rdprn_<br />
rdrcqt_<br />
rdtq_<br /> 
recbeg_<br />
recend_<br />
<br />
<br />
<br />
<br /> 
tabx_<br /></tt>
</td>   
<td align=center valign="top"><tt>
<br />
<br />
bloc_<br />
clipt_<br />
decp_<br /> 
depth_<br />
dictype_<br />
diccat_<br />
dicname_<br />
dicver_<br />
esddig_<br />
<br />
<br />
glob_<br />
<br />
list_<br />
long_<br />
<br />
loop_<br />
lzero_<br />
<br />
posdec_<br /> 
posend_<br />
posnam_<br />
posval_<br />
<br />
quote_<br />
<br />
<br />
<br /> 
save_<br />
strg_<br />
<br />
<br />
tagname_<br />
<br /> 
text_<br />
type_<br /></tt>
</td>
<td align=center valign="top"><tt>
aliaso_<br />
align_<br />
<br />
<br />
pdecp_<br />
<br />
<br />
<br />
<br /> 
pesddig_<br /> 
esdlim_<br />
<br />
globo_<br />
phtml_<br />
<br />
<br />
<br />
<br /> 
plzero_<br /> 
nblanko_<br />
pposdec_<br /> 
pposend_<br />
pposnam_<br /> 
pposval_<br />
<br />
pquote_ <br />
<br />
<br />
<br />
saveo_<br />
<br /> 
tabl_<br />
ptabx_<br />
xmlout_<br />
xmlong_<br /></tt>
</td>
</tr>
</table>
</center>

<p>
In order to make any of these variables available to a program, function or subroutine, the 
common block <tt>ciftbx.cmn</tt> must be included, as by
<p>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;include 'ciftbx.cmn'</tt>
<p> 
The following <i>CIFtbx</i> general monitor variables give the status of general processing by <i>CIFtbx</i>.
<p>
<table border=0>
<tr><td valign="top" align="left"><b><tt>
file_
</tt></b></td><td>
<tt>Character*(MAXBUF)</tt> variable: Set by <tt>dict_</tt>, <tt>ocif_</tt> and <tt>pfile_</tt> to 
the filename of the current file.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
longf_
</tt></b></td><td>
<tt>Integer</tt> variable: Set by <tt>dict_</tt>, <tt>ocif_</tt> and <tt>pfile_</tt> to the length of 
the filename in <tt>file_</tt>.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
precn_
</tt></b></td><td>
<tt>Integer</tt> variable: Reports the record number (starting from 1) of the last line 
written to the output CIF. Set to zero by <tt>init_</tt>. Also set to zero by <tt>pfile_</tt>
and <tt>close_</tt> if the output CIF file name was not blank.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
recn_
</tt></b></td><td>
<tt>Integer</tt> variable: Reports the record number (starting from 1) of the last line 
read from the direct access copy of the input CIF.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
tbxver_
</tt></b></td><td>
<tt>Character*32</tt> variable: Initialized to the <i>CIFtbx</i> version and date in the form 
<tt>'CIFtbx version N.N.N, DD MMM YY '</tt>
The length of this string may be increased in future versions to allow for multidigit version numbers 
and to become year-2000 compliant.
</td></tr>
</table>
<p> 
The following <i>CIFtbx</i> general control variables control input and general processing by 
<i>CIFtbx</i>. The user may accept the default values or may store new values into these 
variables to change the behavior of the commands.
<p>
<table border=0>

<tr><td valign="top" align="left"><b><tt>&nbsp;
alias_
</tt></b></td><td> 
<tt>Logical</tt> variable: Set <tt>.true.</tt> will cause calls to <i>CIFtbx</i> functions to 
accept aliases of data item names (see <a href="#2.6">2.6</a>, above). The preferred synonym 
from the dictionary will be substituted internally, provided aliased data names were supplied 
by an input dictionary (via <tt>dict_</tt>). The default is <tt>.true.</tt>, but <tt>alias_</tt> 
may be set to <tt>.false.</tt> in an application.
</td></tr> 

<tr><td valign="top" align="left"><b><tt>
append_
</tt></b></td><td> 
<tt>Logical variable: Set <tt>.true.</tt> will cause each call to <tt>ocif_</tt> to append the 
information found to the current CIF to the information in the direct access file for any prior 
CIFs. The default is <tt>.false.</tt>, in which case each call to <tt>ocif_</tt> overwrites 
the information for the prior CIF.
</td></tr>                   

<tr><td valign="top" align="left"><b><tt>
line_
</tt></b></td><td> 
<tt>Integer</tt> variable: Specifies the input/output line limit for processing a CIF. The 
default value is 80 characters. This limit includes the visible printable characters of 
the line, not the system-dependent line terminators. This variable may be set by the 
program. The maximum value is 
<tt>MAXBUF</tt> that has a default value of 2048. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
nblank_
</tt></b></td><td>
<tt>Logical</tt> variable: Set <tt>.true.</tt> will cause calls to <tt>char_</tt> or <tt>test_</tt> 
that encounter a non-text quoted blank to return the type as 'null' rather than 'char'.
</td></tr>

<tr><td valign="top" align="left"><b><tt>  
rdbkt_
</tt></b></td><td>
<tt>Logical</tt> variable controls the recognition of bracket delimiters <tt> [ ... ] </tt> on read.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
rdbrc_
</tt></b></td><td>
<tt>Logical</tt> variable controls the recognition of brace delimiters <tt> { ... } </tt> on read.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
rdcolon_
</tt></b></td><td>
<tt>Logical</tt> variable controls the acceptance of colons as delimiters inside
bracketed constructs on read.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
rdprn_
</tt></b></td><td>
<tt>Logical</tt> variable controls the acceptance of parentheses
 <tt> ( ... ) </tt> as delimiters on read.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
rdrcqt_
</tt></b></td><td>
<tt>Logical</tt> variable controls recognition of trailing punctuation
after a closing quote.  If <tt>.true.</tt> a closing quotation mark is
recognized immediately, no matter what follows the closing
quotation mark (the CIF 2 convention).  If <tt>.false.</tt>, a closing
quotation mark is only effective if followed by a blank, or,
in bracketed constructs, by a blank, a colon, a comma or
the closing bracket.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
rdtq_
</tt></b></td><td>
<tt>Logical</tt> variable controls the recognition of triple-quote delimiters
<tt>&quot;&quot;&quot; ...  &quot;&quot;&quot;</tt>
 and  <tt>''' ...  '''</tt> on read.
</td></tr>


<tr><td valign="top" align="left"><b><tt>
recbeg_
</tt></b></td><td>
<tt>Integer</tt> variable: Gives the record number of the first record to be used. May be changed 
by the user to restrict access to a CIF.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
recend_
</tt></b></td><td>
<tt>Integer</tt> variable: Gives the record number of the last record to be used. 
May be changed 
by the user to restrict access to a CIF.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
tabx_
</tt></b></td><td>
<tt>Logical</tt> variable: Set <tt>.true.</tt> causes tab character expansion to 
blanks during the 
reading of a CIF. The default is <tt>.true.</tt>
</td></tr>
</table>
<p> 
The following <i>CIFtbx</i> input monitor variables monitor the processing of input from a CIF.
<p>
<table border=0>

<tr><td valign="top" align="left"><b><tt>
bloc_
</tt></b></td><td>
<tt>Character*(NUMCHAR)</tt> variable: Set by <tt>data_</tt> to the current block name.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
decp_
</tt></b></td><td>
<tt>Logical</tt> variable: Set when processing numeric input, <tt>.true.</tt> if there is 
a decimal point in the numeric value, <tt>.false.</tt> otherwise, set by <tt>numb_</tt> and <tt>numd_</tt>.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
diccat_
</tt></b></td><td>
<tt>Character*(NUMCHAR)</tt> variable: Set by <tt>test_</tt>, <tt>find_</tt>, <tt>char_</tt>, <tt>numb_</tt>,
<tt>numd_</tt> to the category (see <tt>test_</tt>) or '(none)'.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
dicname_
</tt></b></td><td>
<tt>Character*(NUMCHAR)</tt> variable: Set by <tt>test_</tt>, <tt>find_</tt>, <tt>char_</tt>, <tt>numb_</tt>, 
<tt>numd_</tt> to the root alias (see <tt>test_</tt>) of name or by <tt>dict_</tt> to the name the 
dictionary just loaded.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
dictype_
</tt></b></td><td>
<tt>Character*(NUMCHAR)</tt> variable: Set to the precise data type code (see <tt>test_</tt>). This is 
the type code given in the dictionary entry for the named data item. If no dictionary was used, or no 
type code was specified, this field will simply agree with <tt>type_</tt>. If a dictionary was used, 
This type may be more specific (e.g. 'float' or 'int') than the one given by <tt>type_</tt> 
(e.g. 'numb').
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
dicver_
</tt></b></td><td>
<tt>Character*(NUMCHAR)</tt> variable: Set by <tt>dict_</tt> to the version of the dictionary.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;&nbsp;
esddig_
</tt></b></td><td>
<tt>Integer</tt> variable: Set when processing numeric input to the number of esd digits in the last 
number read from a CIF. Will be zero if no esd was given.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
glob_
</tt></b></td><td> 
<tt>Logical</tt> variable: Set by <tt>data_</tt> to signal that the current data block is actually a 
global block (<tt>.true.</tt> for a global block). The application is responsible for managing the 
relationship of global data to other data blocks.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
list_
</tt></b></td><td> 
<tt>Integer</tt> variable: Set by <tt>test_</tt>, <tt>find_</tt>, <tt>char_</tt>, <tt>numb_</tt>, 
<tt>numd_</tt> to the sequential number of the loop block 
in the data block. If the item is not within a loop structure this value will be zero.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
long_
</tt></b></td><td> 
<tt>Integer</tt> variable: Set by <tt>test_</tt>, <tt>find_</tt>, <tt>char_</tt>, <tt>cmnt_</tt>, 
<tt>numb_</tt>, <tt>numd_</tt> to the length of the data string in <tt>strg_</tt>.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
loop_
</tt></b></td><td> 
<tt>Logical</tt> variable: Set by <tt>test_</tt>, <tt>find_</tt>, <tt>char_</tt>, <tt>numb_</tt>, 
<tt>numd_</tt> to <tt>.true.</tt> if another loop packet is present.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
lzero_
</tt></b></td><td> 
<tt>Logical</tt> variable: Set when processing numeric input to <tt>.true.</tt> if the numeric value 
is of the form [sign]0.nnnn rather than [sign].nnnn, <tt>.false.</tt> otherwise, set by <tt>numb_</tt> 
and <tt>numd_</tt>.
</td></tr>

<tr><td valign="top" align="left"><b><tt>
posdec_
</tt></b></td><td> 
<tt>Integer</tt> variable : Set when processing numeric input to the column number (position along 
the line, counting from 1 at the left) of the decimal point or the last number read, if a decimal 
point was present, set by <tt>numb_</tt> and <tt>numd_</tt>. For whole numbers, the effective 
position of the decimal point is one column to the right of the field.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
posend_
</tt></b></td><td> 
<tt>Integer</tt> variable : Set by <tt>test_</tt>, <tt>find_</tt>, <tt>char_</tt>, <tt>numb_</tt>, 
<tt>numd_</tt> to the ending column number (position along the line, counting from 1 at the left) 
of the last data value read, not including a terminal quote. 
</td></tr>

<tr><td valign="top" align="left"><b><tt>
posnam_
</tt></b></td><td> 
<tt>Integer</tt> variable: Set by <tt>test_</tt>, <tt>find_</tt>, <tt>char_</tt>, <tt>numb_</tt>, 
<tt>numd_</tt> to the starting column number (position along the line, 
counting from 1 at the left) of the last name or comment or data block read.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
posval_ 
</tt></b></td><td> 
<tt>Integer</tt> variable: Set by <tt>test_</tt>, <tt>find_</tt>, <tt>char_</tt>, <tt>numb_</tt>, 
<tt>numd_</tt> to the starting column of the last data value read. Also reports the column number 
(position along the line, counting from 1 at the left) of the terminal "<tt>save_</tt>" of a save frame.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
quote_
</tt></b></td><td> 
<tt>Character</tt> variable: Set by <tt>test_</tt>, <tt>find_</tt>, <tt>char_</tt> to the quotation 
symbol found delimiting the last string read.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
save_
</tt></b></td><td>  
<tt>Logical</tt> variable : Set by <tt>data_</tt> to <tt>.true.</tt> if the current data block is 
actually a save-frame.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;&nbsp;
strg_
</tt></b></td><td>  
<tt>Character*(MAXBUF)</tt> variable: Set by <tt>test_</tt>, <tt>find_</tt>, <tt>char_</tt>, cmnt_, 
<tt>numb_</tt>, <tt>numd_</tt> to the current data item.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;&nbsp;
tabx_
</tt></b></td><td>  
<tt>Logical</tt> variable: Set <tt>.true.</tt> will cause the expansion of tab characters to blanks 
during the reading of a CIF. The default is <tt>.true.</tt>
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;&nbsp;&nbsp;
tagname
</tt></b></td><td>  
<tt>_Character*(NUMCHAR)</tt> variable: Set by <tt>test_</tt>, <tt>find_</tt>, <tt>char_</tt>, 
<tt>numb_</tt>, <tt>numd_</tt> to the name of the data item as found in the input CIF. It will 
be blank if the data item name requested is not found in the input CIF 
and may differ from the data item name provided by the user if the name used in the input CIF 
is an alias of the data item name and alias_ is <tt>.true.</tt> 
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
text_
</tt></b></td><td>   
<tt>Logical</tt> variable: Set by <tt>test_</tt>, <tt>find_</tt>, <tt>char_</tt> to <tt>.true.</tt> 
if another text line is present.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
type_
</tt></b></td><td>    
<tt>Character*4</tt> variable: Set by <tt>test_</tt>, <tt>find_</tt>, <tt>char_</tt>, <tt>numb_</tt>, 
<tt>numd_</tt> to the data type code (see <tt>test_</tt>), <i>i.e.</i> to
<p> 
<tt>'numb'</tt> for number data<br /> 
<tt>'char'</tt> for character data<br /> 
<tt>'text'</tt> for text data<br />
<tt>'null'</tt> if data missing or '?' or '.'
<p> 
</td></tr>
</table>
<p>
The following <i>CIFtbx</i> output control variables control output formats of a CIF being written.
<p> 
<table border=0>

<tr><td valign="top" align="left"><b><tt>
aliaso_
</tt></b></td><td>
<tt>Logical</tt> variable: Set <tt>.true.</tt> will cause output functions to convert alias names 
to preferred synonyms in the dictionary. The default is <tt>.false.</tt> The setting of 
<tt>aliaso_</tt> is independent of the setting of <tt>alias_</tt>.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
align_
</tt></b></td><td>
<tt>Logical</tt> variable: Set <tt>.true.</tt> will cause an alignment of <tt>loop_</tt> lists 
during the creation of a CIF. The default is <tt>.true.</tt>
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
esdlim_
</tt></b></td><td> 
<tt>Integer</tt> variable: Specifies the upper limit of esd's produced by <tt>pnumb_</tt?, and, 
implicitly, the lower limit. The default value is 19, which limits esd's to the range 2-19. 
Typical values of <tt>esdlim_</tt> might be 9 (limiting esd's to the range 1-9), 19, or 29 
(limiting esd's to the range 3-29)
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
globo_
</tt></b></td><td> 
<tt>Logical</tt> variable: Set <tt>.true.</tt> will cause the output data block from 
<tt>pdata_</tt> to be written as a global block.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
phtml_
</tt></b></td><td> 
<tt>Logical</tt> variable: Set <tt>.true.</tt> will cause the <tt>pfile_</tt> output
file to be written as an HTML web page rather than as text.  The default is
<tt>.false.</tt>.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
nblanko_
</tt></b></td><td> 
<tt>Logical</tt> variable: Set <tt>.true.</tt> will cause the output functions to convert 
quoted blank strings to an unquoted period (<i>i.e.</i> to a data item of type null). The 
default is <tt>.false.</tt>.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
pdecp_
</tt></b></td><td> 
<tt>Logical</tt> variable: Set <tt>.true.</tt> will cause the output functions to insert a 
decimal point in all numbers written by <tt>pnumb_</tt> or <tt>pnumbd_</tt>. If set 
<tt>.false.</tt> then a decimal point will be written only when needed. The default is 
<tt>.false.</tt>.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;&nbsp;
pesddig_
</tt></b></td><td> 
<tt>Integer</tt> variable: Specifies the the number of digits of esd's produced by 
<tt>pnumb_</tt> and <tt>pnumd_</tt>, provided the value of <tt>pesddig_</tt> is 
non-zero and <tt>esdlim_</tt> is negative.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
plzero_
</tt></b></td><td> 
<tt>Logical</tt> variable: Set <tt>.true.</tt> will cause the output functions to insert 
a zero before a leading decimal point. The default is <tt>.false.</tt>.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
pposdec_
</tt></b></td><td> 
<tt>Integer</tt> variable: Specifies the column number (position along the line, counting 
from 1 at the left) of the decimal point for the next number to be written. This acts very 
much like a decimal centered tab in a word processor, to help align columns of number on 
a decimal point, if a decimal point is present.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;&nbsp;
pposend_
</tt></b></td><td> 
<tt>Integer</tt> variable: Specifies the ending column number of the next number or quoted 
character value to be written. Used to pad with zeros or blanks.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;&nbsp;
pposnam_
</tt></b></td><td> 
<tt>Integer</tt> variable: Specifies the starting column number of the next name or 
comment to be written.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
pposval_
</tt></b></td><td>
<tt>Integer</tt> variable: Specifies the starting column number of the next data value to be written.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
pquote_
</tt></b></td><td>
<tt>Character</tt> variable: Specifies the quotation symbol to be used for the next string written.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
precn_
</tt></b></td><td>
<tt>Integer</tt> variable: Returns the record number of the last line written to the output CIF. 
Set to zero by <tt>init_</tt>. Also set to zero by <tt>pfile_</tt> and <tt>close_</tt> if the 
output CIF file name was not blank.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
ptabx_
</tt></b></td><td> 
<tt>Logical</tt> variable: Set <tt>.true.</tt> will cause tab character expansion to blanks during 
the creation of a CIF. The default is <tt>.true.</tt>.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
saveo_
</tt></b></td><td> 
<tt>Logical</tt> variable: Set <tt>.true.</tt> will cause the <tt>pdata_</tt> to output a save frame 
header line rather than a data block header line. The default is <tt>.false.</tt>.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
tabl_
</tt></b></td><td> 
<tt>Logical</tt> variable: Set <tt>.true.</tt> if tab-stop alignment is to be used 
for data items written to the CIF. The default is <tt>.true.</tt>.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
xmlout_
</tt></b></td><td>
<tt>Logical</tt> variable: Set <tt>.true.</tt> will cause the pfile_ output
file to be written according to XML conventions  page rather than as text.
note that this is not a cml output, but a literal translation from CIF.  The default is
<tt>.false.</tt>.
</td></tr>

<tr><td valign="top" align="left"><b><tt>&nbsp;
xmlong__
</tt></b></td><td>
<tt>Logical</tt> variable: Set <tt>.true.</tt> will change the style of <tt>pfile_</tt> 
XML output, so that xml tag names are the full CIF tag names with the leading
'_' removed.  When <tt>.false.</tt> an attempt is made to strip the leading category 
name as well. The default is <tt>.false.</tt>.
</td></tr>


</table> 
<p>
Column Numbering
<p>
The columns of both input and output CIFs are numbered from 1 on the left, usually to 80, 
unless <tt>line_</tt> has been changed to a different value. Variables such as <tt>pposdec_</tt>,
<tt>&nbsp;pposend_</tt>, <tt>pposnam_</tt>, and <tt>pposval_</tt>, which specify the column numbers 
at which items are to be written may be set to zero if <i>CIFtbx</i> is to use its best estimate. 
In general, the routines that accept the column number specifications will reset the associated 
variables to zero after each use. The following CIF fragment illustrates the column numbering 
used.
<p>
<center>
<table border=1>
<tr>
<td>
<pre>
# This is a CIF fragment to illustrate <i>CIFtbx</i> column numbering 
#        1         2         3         4         5         6         7 
#234567890123456789012345678901234567890123456789012345678901234567890 
_cell.length_a 37.58 
# ^ ^ ^ ^ 
# | | | | 
# posnam_ = 5 | | posend_=28 
# | | 
# | posdec_=26 
# | 
# posval_= 24
</pre>
</td>
</tr>
</table>
</center>
<p>

<h2 id="Error_Message_Glossary" align="center">CHAPTER 8 Reference: Error Message Glossary </h2>
<p>
The <i>CIFtbx</i> functions avoid issuing error messages unless they are requested, or 
there is no sensible way to continue. The preferred approach is for the <i>CIFtbx</i> 
functions to return true or false function values so that the application program 
can respond to run-time problems in a controlled way and take corrective action 
if it is possible. Nevertheless some types of processing errors, such as exceeding 
the dimensions of critical <i>CIFtbx</i> arrays, will require that an appropriate message 
be issued and execution cease. 
<p>
All <i>CIFtbx</i> error messages have a common format. Each begins with either a 
&quot;warning&quot; or &quot;error&quot; header line with the name of the 
file being processed, the current data block or save frame, and the line 
number. The next line contains the text of the message. 
For example, the following warning message is issued by the test program 
tbx_ex.f when it finds that the file test.cif contains the unknown data 
item name _dummy_test, in the data block <tt>data_</tt>mumbo_jumbo. 
<p>
<tt>ciftbx warning:  test.cif     <tt>data_</tt>mumbo_jumbo    line: 12</tt><br />
<tt>Data name _dummy_test not in dictionary!</tt> 
<p>
<h3 id="Fatal_Errors_Array_Bounds" align="left">Fatal Errors: Array Bounds</h3> 
<p>
The following messages are issued if the <i>CIFtbx</i> array bounds are exceeded.
<p>
Operation terminates immediately. Array bounds can be adjusted by changing 
the PARAMETER values in <tt>ciftbx.sys</tt>. If the value of <tt>MAXBUF</tt> needs to be changed, 
the file <tt>ciftbx.cmv</tt> must be updated. 
<p>
<center>
<table border=0>
<tr><td align="left"><b><tt>
Input line_ value > <tt>MAXBUF</tt> 
</tt></b></td></tr><tr><td align="left"><b><tt>
Number of categories > <tt>NUMBLOCK</tt> 
</tt></b></td></tr><tr><td align="left"><b><tt>
Number of data names > <tt>NUMBLOCK</tt> 
</tt></b></td></tr><tr><td align="left"><b><tt>
CIFdic names &gt; <tt>NUMDICT</tt> 
</tt></b></td></tr><tr><td align="left"><b><tt>
Dictionary category names &gt; <tt>NUMDICT</tt> 
</tt></b></td></tr><tr><td align="left"><b><tt>
Items per loop packet &gt; <tt>NUMITEM</tt> 
</tt></b></td></tr><tr><td align="left"><b><tt>
Number of loop_s &gt; <tt>NUMLOOP</tt>
</tt></b></td></tr>
</table>
</center> 
<p>
The following array bounds message is not fatal. 
<p>
<b><tt>More than <tt>MAXBOOK</tt> bookmarks requested</tt></b> 
<p>
The number of simultaneous bookmarks is more than <tt>MAXBOOK</tt>. The function <tt>bkmrk_</tt> 
will return <tt>.false.</tt>, and processing will continue, so that the calling program 
may take appropriate action before termination, but this is effectively a 
fatal error for which recompilation with a larger value of <tt>MAXBOOK</tt> is necessary.
<p>
<h3 id="Fatal_Errors_Data_Sequence"malign="left">Fatal Errors: Data Sequence, Syntax and File Construction
</h3>
<p>
<b><tt>Dict_ must precede <tt>ocif_</tt></tt></b>
<p>
Dictionary files must be loaded before an input CIF is opened because some checking 
occurs during the CIF loading process.
<p>
<b><tt>Illegal tag/value construction</tt></b>
<p>
Data name (i.e. a "tag") and data values are not matched (outside a looped list). 
This usually means that a data name immediately follows another data name, or a 
data value was found without a preceding data name. The most likely cause of this 
error is the failure to provide a "." or "?" for missing or unknown data values, 
or a failure to declare a loop_ when one was intended.
<p>
<b><tt>Item miscount in loop</tt></b>
<p>
Within a looped list the total number of data values must be an exact multiple of 
the number of data names in the <tt>loop_</tt> header.
<p>
<b><tt>Prior save-frame not terminated</tt></b><br />
<b><tt>Save-frame terminator found out of context</tt></b>
<p>
Save-frames must start with <tt>save_&lt;framecode&gt;</tt> and end with <tt>save_</tt>.
These messages will be issued if this does not occur.
<p>
<b><tt>Syntax construction error</tt></b>
<p>
Within a data block or save-frame the number of data values does not match the 
number of data names (ignoring loop structures).
<p>
<b><tt>Unexpected end of data</tt></b>
<p>
When processing multi-line text the end of the CIF is encountered before the 
terminal semicolon.
<p>

<h3 id="Fatal_Errors_Invalid_Arguments" align="left">Fatal Errors: Invalid Arguments</h2>
<p>
The following messages are generated by calls with invalid arguments.
<p>
<center>
<table border=0>
<tr><td align="left"><b><tt>
Call to find_ with invalid arguments
</tt></b></td></tr><tr><td align="left"><b><tt>
Internal error in putnum
</tt></b></td></tr></table>
</center>
<p>
<h3 id="Warnings_Input_Errors" align="left">Warnings: Input Errors</h3>
<p>
<b><tt>Category &lt;cat-code&gt; first implicitly defined in cif</tt></b>
<p>
The category code in the DDL2 data name is not matched by an explicit definition 
in the dictionary. This may be intentional, but it more likely indicates a 
typographical error in the dictionary or the CIF.
<p>
<b><tt>Category &lt;key-tag&gt; not given</tt></b>
<p>
The category key tag specified in a DDL2 data set or the list reference tag 
specified in a DDL1 data set was not found, even though some tags in 
that category were given. This is usually due to an incomplete loop header.
<p>
<b><tt>Data name <tt>&lt;name&gt;</tt> not in dictionary!</tt></b>
<p>
The data item name <tt>&lt;name&gt;</tt> was used in the CIF but could not be 
found in the dictionary.
<p>
<b><tt>Data block header missing</tt></b>
<p>
No <tt>data_</tt>, <tt>save_</tt> or <tt>global_</tt> was found when expected.
<p>
<b><tt>Duplicate data item &lt;name&gt;</tt></b>
<p>
There were two or more identical data names <tt>&lt;name&lt;</tt> in a data block or 
save- frame.
<p>
<b><tt>Exponent overflow in numeric input<br />
Exponent underflow in numeric input</tt></b>
<p>
The numeric value being processed has an exponent out of the range that can be 
processed on this machine. If the string involved is not intended to be processed 
as a number, then quoting it may resolve the problem.
<p>
<b><tt>Heterogeneous categories in loop &lt;new cat-code&gt; vs &lt;old cat-code&gt;</tt></b>
<p>
Looped lists should not contain data from different categories. This message is 
issued if the category of a new data items fails to match the category of a 
prior data item. A special category (none) is used to denote item names for 
which no category has been declared. No warning is issued on this level for 
a loop for which all data items have no category declared.
<p>
<b><tt>Input line length exceeds line_</tt></b>
<p>
Non-blank characters were found beyond the value given by the variable 
<tt>line_</tt>. The default value for <tt>line_</tt> is 80, which is the 
upper bound for lines in a valid CIF1 file. The extra characters in 
column positions line_+1 through <tt>MAXBUF</tt> will be processed but 
the input file may need to be reformatted for use with other CIF 
handling programs.
<p>
<b><tt>Missing loop_ items set as DUMMY</tt></b>
<p>
When writing an output CIF, a looped list of items was truncated with an 
incomplete loop packet (i.e. the number of items did not match the 
number of <tt>loop_</tt> data names). The missing values were set to 
the character string "DUMMY".
<p>
<b><tt>Numb type violated &lt;name&gt;</tt></b>
<p>
The data item <tt>&lt;name&lt;</tt> has been processed with an explicit 
dictionary type numb, but with a non-numeric value. Note that the 
values "?" or "." will not generate this message.
<p>
<b><tt>Quoted string not closed</tt></b>
<p>
Character values may be enclosed by bounding quotes. The strict definition 
of a "quoted string" value is that it must start with a &lt;wq&gt; digraph and 
end with a &lt;qw&gt; digraph, where w is a white-space character blank 
or tab and q is a single or double quote and the same type of quote mark 
is used in the terminal digraph as was used in the initial digraph. 
This message is issued if these conditions are not met.
<p>
<b><tt>Converted <tt>pchar_</tt> output to text for &lt;string&gt;</tt></b>
<p>
An attempt was made to write a string to a CIF with <tt>pchar_</tt> instead of 
<tt>ptext_</tt>, but the string contains a combination of characters for which 
<tt>ptext_</tt> must be used. This warning is issued and processing continues.
<p>
<b><tt>ESD less than precision of machine</tt></b><br />
<b><tt>Overflow of esd</tt></b><br />
<b><tt>Underflow of esd</tt></b>
<p>
A call to <tt>pnumb_</tt> or <tt>numb_</tt> was made with values of the number 
and esd that cannot be presented properly on this machine. A bounding value 
(0 or 99999 is used for the esd, this warning message is issued and processing 
continues.
<p>
<b><tt>Invalid value of esdlim_ reset to 19</tt></b>
<p>
In processing numeric output, a value of <tt>esdlim_</tt> less than 9 or greater 
than 99999 was found. The value of esdlim_ is forced to 19, this warning is issued, 
and processing continues.
<p>
<b><tt>Missing: missing loop_ name set as _DUMMY</tt></b><br />
<b><tt>Missing: missing loop_ items set as DUMMY</tt></b>
<p>
In processing a <tt>loop_</tt> the library has had to pad either the header or 
the values. This warning is issued and processing continues.
<p>
<b><tt>Output CIF line longer than line_</tt></b>
<p>
In processing a line of output the data being presented forces the line to be 
longer than the value specified in <tt>line_</tt>. This warning is issued and 
processing continues. This warning should not occur if tags and values each of 
which can fit on a line are used.
<p>
<b><tt>Out-of-sequence call to end text block</tt></b>
<p>
The processing logic for termination of a text block has been invoked without a 
text block having been started. This warning is issued and processing continues. 
This can only be caused by users calling some of the internal routines of the 
library rather than the standard interface routines.
<p>
<b><tt>Output prefix may force line overflow</tt></b>
<p>
A prefix string specified to <tt>prefx_</tt> is longer than the maximum line length 
allowed less the allowed length of tags. This warning is issued and processing continues.
<p>
<b><tt>Prefix string truncated</tt></b>
<p>
A prefix string specified to <tt>prefx_</tt> is longer than the maximum line length 
allowed. It is truncated and processing continues
<p>

<h3 id="Warnings_Dictionary_Checks" align="left">Warnings: Dictionary Checks</h3>
<p>
<b><tt>Aliases and names in different loops; only using first alias</tt></b>
<p>
When a DDL2 dictionary contains a loop of alias declarations the corresponding 
data name declarations are expected to be in the same loop. This message is 
issued if separate loops are used. Only the first alias name is used, but 
processing continues.
<p>
<b><tt>Attempt to redefine category for item</tt></b><br />
<b><tt>Attempt to redefine type for item</tt></b>
<p>
If a DDL2 dictionary contains a category or type for a data item that conflicts 
with an earlier declaration, these warnings are issued. The redeclaration is ignored.
<p>
<b><tt>Categories and names in different loops</tt></b><br />
<b><tt>Types and names in different loops</tt></b>
<p>
When a DDL2 dictionary contains a loop of category or type declarations, the 
corresponding data name declarations are expected to be in the same loop. 
This message is issued if separate loops are used. Only the first category 
name or type is used, but processing continues.
<p>
<b><tt>Category id does not match block name</tt></b>
<p>
In a DDL2 dictionary the save-frame code is expected to start with the category 
name. If a category name within the frame is not within a loop it is checked 
against that in the frame code and a warning is issued if these do not match.
<p>
<b><tt>Conflicting definition of alias</tt></b>
<p>
When a DDL2 dictionary contains a new declaration of an alias for a data name 
that is in conflict with a previous alias definition, this warning is issued. 
The second alias declaration is ignored.
<p>
<b><tt>Duplicate definition of same alias</tt></b>
<p>
When a DDL2 dictionary contains a new declaration of an alias for a data name 
that duplicates a previously defined alias pair, this warning is issued.
<p>
<b><tt>Item name &lt;name&gt; does not match category name</tt></b>
<p>
If category checking is enabled and the category assigned to an item name does 
not match the initial characters of the item name, this warning is issued and 
processing continues. This may indicate a typo or a deprecated item in the dictionary.
<p>
<b><tt>Item type &lt;type-code&gt; not recognised</tt></b>
<p>
In CIFtbx, DDL2 dictionary precise type codes are translated to the DDL primitive 
type codes numb, char and text. If an unrecognised type code is found for which 
<i>CIFtbx</i> does not have a translation, this warning is issued.
<p>
<b><tt>Multiple DDL 1 and 2 category definitions</tt></b><br />
<b><tt>Multiple DDL 1 and 2 related key definitions</tt></b><br />
<b><tt>Multiple DDL 1 and 2 name definitions</tt></b><br />
<b><tt>Multiple DDL 1 and 2 type definitions</tt></b><br />
<b><tt>Multiple DDL 1 and 2 related item definitions</tt></b><br />
<b><tt>Multiple DDL 1 and 2 related item functions</tt></b>
<p>
These messages are issued if both DDL and DDL2 style declarations for categories, 
category keys (i.e. list references), data names, data types and related items 
are used in the same data block or save-frame.
<p>
<b><tt>Multiple categories for one name</tt></b><br />
<b><tt>Multiple types for one name</tt></b>
<p>
These messages are issued if a dictionary contains a loop of category or 
type definitions, and an unlooped declaration of a single data name. The 
first category or type definition is used and processing continues.
<p>
<b><tt>No category defined in block &lt;name&gt; and name &lt;name&gt; does not match</tt></b>
<p>
This message is issued if a DDL2 dictionary contains no category for the defined 
data item and it was not possible to derive an implicit category from the block 
name. This message usually indicates a typographical error in the dictionary.
<p>
<b><tt>No category specified for name &lt;name&gt;</tt></b>
<p>
This warning is issued if a dictionary contains categories and category checking 
is enabled but no category is defined for the named data item.
<p>
<b><tt>No name defined in block</tt></b><br />
<b><tt>No name in the block matches the block name</tt></b>
<p>
These messages are issued if a dictionary save-frame or data block contains no 
name definition or if all the names defined fail to match the block name.
<p>
<b><tt>No type specified for name &lt;name&gt;</tt></b>
<p>
This message is issued if a type code is missing from a dictionary and type 
checking was requested in the <tt>dict_</tt> invocation.
<p>
<b><tt>One alias, looped names, linking to first</tt></b>
<p>
A DDL2 dictionary may contain a list of data names and a single alias outside of this loop.
 In this case the correct name to which to link the alias must be derived implicitly. 
If the save frame code matches the first name in the loop, no warning is issued, 
because the use of the block name was probably the intended result, but if no such 
match is found, this warning is issued.


<h2 id="References" align="center">References</div>
</h2>
<p>
<ul>
<li>
<div id="Bernstein_Brown_Gra&zcaron;ulis_2016">[Bernstein, Brown, Gra&zcaron;ulis <i>et al.</i>, 2016]</div>
Bernstein, H.J., Bollinger, J.C., Brown, I.D., Gra&zcaron;ulis, S., Hester, J.R., McMahon, B., Spadaccini, N., Westbrook, J.D. and Westrip, S.P., 2016. Specification of the crystallographic information file format, version 2.0. J. Appl. Cryst., 49(1), 277 -- 284.
</li>
<li>
<div id="Bernstein_1997">[Bernstein, 1997]</div>
Bernstein, H. J., 1997.  CIF2cif.  CIF Copy program.
</li>
<li> 
<a href=http://www.bernstein-plus-sons.com/software/cifcif></div>
http://www.bernstein-plus-sons.com/software/cifcif</li>
<li>
<div id="Bernstein_Bernstein_1996">[Bernstein, Bernstein, 1996]</div>
Bernstein, F.C. and Bernstein, H.J., 1996. Translating mmCIF data into PDB entries. 
Acta Crystallographica Section A, 52, C576.
</li>
<li>
<div id="Bernstein_Bernstein_Bourne_1998">[Bernstein, Bernstein, Bourne, 1998]</div>
Bernstein, H.J., Bernstein, F.C. and Bourne, P.E., 1998. CIF applications. VIII. 
pdb2cif: translating PDB entries into mmCIF format. J. Appl. Cryst., 31(2), 282 -- 295.
</li>
<li>
<div id="Bernstein_Hall_1998">[Bernstein, Hall, 1998]</div>
Bernstein, H.J. and Hall, S.R., 1998. CIF applications. VII. CYCLOPS2: extending the validation of CIF data names. J. Appl. Cryst., 31(2), 278 -- 281.
</li>
<li>
<div id="Bernstein_et_al_1977'>[Bernstein, <i>et al.</i>, 1977]</div>
Bernstein, F.C., Koetzle, T.F., Williams, G.J., Meyer Jr, E.F., Brice, M.D., 
Rodgers, J.R., Kennard, O., Shimanouchi, T. and Tasumi, M., 1977. 
The Protein Data Bank: a computer-based archival file for macromolecular structures. 
J. Mol. Biol., 112(3), 535 -- 542.
</li>
<li>
<div id="Bourne_et_al_1996">[Bourne <i>et al.</i>, 1996]</div>
Bourne, P.E., Berman, H.M., McMahon, B., Watenpaugh, K.D., Westbrook, J.D. and 
Fitzgerald, P.M., 1997. [30] Macromolecular crystallographic information file. 
In Methods in enzymology (Vol. 277, 571 -- 590). Academic Press
</li>
<li>
<div id="Bourne_Bernstein_Bernstein_1996">[Bourne, Bernstein, Bernstein, 1996]</div>
Bourne, P.E., Bernstein, F.C. and Bernstein, H.J., 1996, August. 
Translating PDB entries into mmCIF. Based on "Translating PDB Entries into mmCIF", 
mmCIF workshop, IUCr meeting, Seattle Washington.
</li>
<li>
<div id="Fitzgerald_et_al_1996">[Fitzgerald <i>et al.</i> 1996]</div>
Fitzgerald, P.M.D., Berman, H., Bourne, P., McMahon, B., Watenpaugh, K. 
and Westbrook, J., 1996. The mmCIF dictionary: community review and final approval. 
Acta Cryst. A52, C575.
<li>
<div id="Hall_1993">[Hall, 1993]</div>
Hall, S.R., 1993. CIF applications. II. CIFIO: for CIF input/output in the Xtal system. 
J. Appl. Cryst., 26(3), 474 -- 479.
</li>
<li>
<div id="Hall_1993a">[Hall, 1993a]</div>
Hall, S.R., 1993. CIF applications. IV. <i>CIFtbx</i>: a tool box for manipulating CIFs. 
J. Appl. Cryst., 26(3), 482 -- 494.
</li>
<div id="Hall_Allen_Brown_1991">[Hall, Allen, Brown, 1991]</div>
Hall, S.R., Allen, F.H. and Brown, I.D., 1991. The crystallographic information file (CIF): 
a new standard archive file for crystallography. Acta Cryst.  A47(6), 655 -- 685.
</li>
<li>
<div id="Hall_Bernstein_1996">[Hall, Bernstein, 1996]</div>
Hall, S.R. and Bernstein, H.J., 1996. CIF applications. V. CIFtbx2: 
Extended tool box for manipulating CIFs. 
J. Appl. Cryst., 29(5), 598 -- 603.
</li>
<li>
<div id="Hall_Cook_1995">[Hall, Cook, 1995]</div>
Hall, S.R. and Cook, A.P., 1995. STAR dictionary definition language:
initial specification. J. Chem. Info. Comp. Sci., 35(5), 819 -- 825.
</li>
<li>
<div id="Hall_Spadaccini_1994">[Hall, Spadaccini, 1994]</div>
Hall, S.R. and Spadaccini, N., 1994. The STAR file: Detailed specifications. 
J. Chem. Info. Comp. Sci., 34(3), 505 -- 508.
</li>
<li>
<div id="McMahon_1995">[McMahon 1995]</div>
B. McMahon, "A Brief History of the DDL", COMCIFS, 1995.
<a href="http://www.iucr.ac.uk/iucr-top/cif/ddlhist.html">http://www.iucr.ac.uk/iucr-top/cif/ddlhist.html</div>
</li>
<li>
<div id="Spadaccini_Hall_2012">[Spadaccini, Hall, 2012]</div>
Spadaccini, N. and Hall, S.R., 2012. DDLm: A new dictionary definition language. J. Chem. Info. and Modeling, 52(8), 1907 -- 1916.
</li>
<li>
<div id="Toby_von_Dreele_Larson_2003">[Toby, von Dreele, Larson, 2003]</div>
Toby, B.H., von Dreele, R.B. and Larson, A.C., 2003. CIF applications. XIV. Reporting of 
Rietveld results using pdCIF: GSAS2CIF. J. Appl. Cryst., 36(5), 1290 -- 1294.
</li>
<li>
<div id="Westbrook_Hall_1995">[Westbrook, Hall, 1995]</div>
Westrook, J.D. and Hall, S.R., mmcif ddl dictionary, 
<a href=https://mmcif.wwpdb.org/dictionaries/ascii/mmcif_ddl.dic>https://mmcif.wwpdb.org/dictionaries/ascii/mmcif_ddl.dic</div>
</li>
</ul>

<h1 id="APPENDIX_A" align="center">APPENDIX A</h2>
<p>
<h3 align="left">Usage Restrictions and Policy</h3>
<p>
The first releases of CIFtbx were released under "The IUCr Policy Use of the Crystallographic 
Information File (CIF), then under a the open source "RasLic" opne source license, and most 
recently under the terms of the GNU General Public License as published by the Free Software 
Foundation; either version 2 of the License 
<a href=https://www.gnu.org/licenses/old-licenses/gpl-2.0.en.html target="_blank">
https://www.gnu.org/licenses/old-licenses/gpl-2.0.en.html</a>, 
or (at your option) any later version.  Alternatively you may redistribute and/or modify the 
CIFtbx API (but not the programs) under the terms of the GNU Lesser General Public License 
as published by the Free Software Foundation; either version 2.1 of the License 
https://www.gnu.org/licenses/old-licenses/lgpl-2.1.en.html, or (at your option) any later version.
In addition, this book, as a document, alternatively may be distributed, remixed, adapted, and 
build upon in any medium or format, even for commercial purposes under the terms of the 
CC BY-SA 4.0 license published by Creative Commons (CC) 
https://creativecommons.org/licenses/by-sa/4.0/legalcode.en.  Copies of the relevant licenses
follow.

<p>
<hr />
<p>
<center>
<div id="GPL">GNU GENERAL PUBLIC LICENSE<div>
</center>
<p>
Version 2, June 1991
<p>
Copyright (C) 1989, 1991 Free Software Foundation, Inc.  
51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA
<p>
Everyone is permitted to copy and distribute verbatim copies
of this license document, but changing it is not allowed.
Preamble
<p>
The licenses for most software are designed to take away your freedom to share and change it. 
By contrast, the GNU General Public License is intended to guarantee your freedom to share 
and change free software--to make sure the software is free for all its users. This General 
Public License applies to most of the Free Software Foundation's software and to any other 
program whose authors commit to using it. (Some other Free Software Foundation software is 
covered by the GNU Lesser General Public License instead.) You can apply it to your programs, too.
<p>
When we speak of free software, we are referring to freedom, not price. Our General Public 
Licenses are designed to make sure that you have the freedom to distribute copies of free 
software (and charge for this service if you wish), that you receive source code or can 
get it if you want it, that you can change the software or use pieces of it in new free 
programs; and that you know you can do these things.
<p>
To protect your rights, we need to make restrictions that forbid anyone to deny you these 
rights or to ask you to surrender the rights. These restrictions translate to certain 
responsibilities for you if you distribute copies of the software, or if you modify it.
<p>
For example, if you distribute copies of such a program, whether gratis or for a fee, 
you must give the recipients all the rights that you have. You must make sure that they, 
too, receive or can get the source code. And you must show them these terms so they know 
their rights.
<p>
We protect your rights with two steps: (1) copyright the software, and (2) offer you 
this license which gives you legal permission to copy, distribute and/or modify 
the software.
<p>
Also, for each author's protection and ours, we want to make certain that everyone 
understands that there is no warranty for this free software. If the software is modified 
by someone else and passed on, we want its recipients to know that what they have is not 
the original, so that any problems introduced by others will not reflect on the original 
authors' reputations.
<p>
Finally, any free program is threatened constantly by software patents. We wish to avoid 
the danger that redistributors of a free program will individually obtain patent licenses, 
in effect making the program proprietary. To prevent this, we have made it clear that any 
patent must be licensed for everyone's free use or not licensed at all.
<p>
The precise terms and conditions for copying, distribution and modification follow.
<p>
TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION
<p>
0. This License applies to any program or other work which contains a notice placed by the 
copyright holder saying it may be distributed under the terms of this General Public License. 
The "Program", below, refers to any such program or work, and a "work based on the Program" 
means either the Program or any derivative work under copyright law: that is to say, a work 
containing the Program or a portion of it, either verbatim or with modifications and/or 
translated into another language. (Hereinafter, translation is included without limitation 
in the term "modification".) Each licensee is addressed as "you".
<p>
Activities other than copying, distribution and modification are not covered by this License; 
they are outside its scope. The act of running the Program is not restricted, and the output 
from the Program is covered only if its contents constitute a work based on the Program 
(independent of having been made by running the Program). Whether that is true depends on 
what the Program does.
<p>
1. You may copy and distribute verbatim copies of the Program's source code as you receive it, 
in any medium, provided that you conspicuously and appropriately publish on each copy an appropriate 
copyright notice and disclaimer of warranty; keep intact all the notices that refer to this 
License and to the absence of any warranty; and give any other recipients of the Program a 
copy of this License along with the Program.
<p>
You may charge a fee for the physical act of transferring a copy, and you may at your option 
offer warranty protection in exchange for a fee.
<p>
2. You may modify your copy or copies of the Program or any portion of it, thus forming a work 
based on the Program, and copy and distribute such modifications or work under the terms of 
Section 1 above, provided that you also meet all of these conditions:
<p>
a) You must cause the modified files to carry prominent notices stating that you changed the 
files and the date of any change.
<p>
b) You must cause any work that you distribute or publish, that in whole or in part contains or 
is derived from the Program or any part thereof, to be licensed as a whole at no charge to all 
third parties under the terms of this License.
<p>
c) If the modified program normally reads commands interactively when run, you must cause it, 
when started running for such interactive use in the most ordinary way, to print or display an 
announcement including an appropriate copyright notice and a notice that there is no warranty 
(or else, saying that you provide a warranty) and that users may redistribute the program under 
these conditions, and telling the user how to view a copy of this License. (Exception: if the 
Program itself is interactive but does not normally print such an announcement, your work based 
on the Program is not required to print an announcement.)
<p>
These requirements apply to the modified work as a whole. If identifiable sections of that work 
are not derived from the Program, and can be reasonably considered independent and separate works 
in themselves, then this License, and its terms, do not apply to those sections when you distribute 
them as separate works. But when you distribute the same sections as part of a whole which is a 
work based on the Program, the distribution of the whole must be on the terms of this License, 
whose permissions for other licensees extend to the entire whole, and thus to each and every 
part regardless of who wrote it.
<p>
Thus, it is not the intent of this section to claim rights or contest your rights to work written 
entirely by you; rather, the intent is to exercise the right to control the distribution of 
derivative or collective works based on the Program.
<p>
In addition, mere aggregation of another work not based on the Program with the Program (or with 
a work based on the Program) on a volume of a storage or distribution medium does not bring the 
other work under the scope of this License.
<p>
3. You may copy and distribute the Program (or a work based on it, under Section 2) in object code 
or executable form under the terms of Sections 1 and 2 above provided that you also do one of the 
following:
<p>
a) Accompany it with the complete corresponding machine-readable source code, which must be 
distributed under the terms of Sections 1 and 2 above on a medium customarily used for software 
interchange; or,
<p>
b) Accompany it with a written offer, valid for at least three years, to give any third party, 
for a charge no more than your cost of physically performing source distribution, a complete 
machine-readable copy of the corresponding source code, to be distributed under the terms of 
Sections 1 and 2 above on a medium customarily used for software interchange; or,
<p>
c) Accompany it with the information you received as to the offer to distribute corresponding 
source code. (This alternative is allowed only for noncommercial distribution and only if you 
received the program in object code or executable form with such an offer, in accord with 
Subsection b above.)
<p>
The source code for a work means the preferred form of the work for making modifications to it. 
For an executable work, complete source code means all the source code for all modules it contains, 
plus any associated interface definition files, plus the scripts used to control compilation 
and installation of the executable. However, as a special exception, the source code distributed 
need not include anything that is normally distributed (in either source or binary form) with the 
major components (compiler, kernel, and so on) of the operating system on which the executable runs, 
unless that component itself accompanies the executable.
<p>
If distribution of executable or object code is made by offering access to copy from a designated place, then offering equivalent access to copy the source code from the same place counts as distribution of the source code, even though third parties are not compelled to copy the source along with the object code.
<p>
4. You may not copy, modify, sublicense, or distribute the Program except as expressly provided under 
this License. Any attempt otherwise to copy, modify, sublicense or distribute the Program is void, 
and will automatically terminate your rights under this License. However, parties who have received 
copies, or rights, from you under this License will not have their licenses terminated so long as 
such parties remain in full compliance.
<p>
5. You are not required to accept this License, since you have not signed it. However, nothing else 
grants you permission to modify or distribute the Program or its derivative works. These actions 
are prohibited by law if you do not accept this License. Therefore, by modifying or distributing 
the Program (or any work based on the Program), you indicate your acceptance of this License to do 
so, and all its terms and conditions for copying, distributing or modifying the Program or works 
based on it.
<p>
6. Each time you redistribute the Program (or any work based on the Program), the recipient 
automatically receives a license from the original licensor to copy, distribute or modify the 
Program subject to these terms and conditions. You may not impose any further restrictions on 
the recipients' exercise of the rights granted herein. You are not responsible for enforcing 
compliance by third parties to this License.
<p>
7. If, as a consequence of a court judgment or allegation of patent infringement or for any other 
reason (not limited to patent issues), conditions are imposed on you (whether by court order, 
agreement or otherwise) that contradict the conditions of this License, they do not excuse you from 
the conditions of this License. If you cannot distribute so as to satisfy simultaneously your 
obligations under this License and any other pertinent obligations, then as a consequence you may 
not distribute the Program at all. For example, if a patent license would not permit royalty-free 
redistribution of the Program by all those who receive copies directly or indirectly through you, 
then the only way you could satisfy both it and this License would be to refrain entirely from 
distribution of the Program.
<p>
If any portion of this section is held invalid or unenforceable under any particular circumstance, 
the balance of the section is intended to apply and the section as a whole is intended to apply 
in other circumstances.
<p>
It is not the purpose of this section to induce you to infringe any patents or other property 
right claims or to contest validity of any such claims; this section has the sole purpose of 
protecting the integrity of the free software distribution system, which is implemented by 
public license practices. Many people have made generous contributions to the wide range of 
software distributed through that system in reliance on consistent application of that system; it 
is up to the author/donor to decide if he or she is willing to distribute software through any 
other system and a licensee cannot impose that choice.
<p>
This section is intended to make thoroughly clear what is believed to be a consequence of the 
rest of this License.
<p>
8. If the distribution and/or use of the Program is restricted in certain countries either by 
patents or by copyrighted interfaces, the original copyright holder who places the Program under 
this License may add an explicit geographical distribution limitation excluding those countries, 
so that distribution is permitted only in or among countries not thus excluded. In such case, 
this License incorporates the limitation as if written in the body of this License.
<p>
9. The Free Software Foundation may publish revised and/or new versions of the General Public 
License from time to time. Such new versions will be similar in spirit to the present version, 
but may differ in detail to address new problems or concerns.
<p>
Each version is given a distinguishing version number. If the Program specifies a version number 
of this License which applies to it and "any later version", you have the option of following the 
terms and conditions either of that version or of any later version published by the Free Software 
Foundation. If the Program does not specify a version number of this License, you may choose any 
version ever published by the Free Software Foundation.
<p>
10. If you wish to incorporate parts of the Program into other free programs whose distribution 
conditions are different, write to the author to ask for permission. For software which is 
copyrighted by the Free Software Foundation, write to the Free Software Foundation; we sometimes 
make exceptions for this. Our decision will be guided by the two goals of preserving the free 
status of all derivatives of our free software and of promoting the sharing and reuse of 
software generally.
<p>
NO WARRANTY
<p>
11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY FOR THE PROGRAM, TO THE 
EXTENT PERMITTED BY APPLICABLE LAW. EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS 
AND/OR OTHER PARTIES PROVIDE THE PROGRAM "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR 
IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR 
A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU. 
SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR CORRECTION.
<p>
12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING WILL ANY COPYRIGHT HOLDER, 
OR ANY OTHER PARTY WHO MAY MODIFY AND/OR REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO 
YOU FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF 
THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING 
RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO 
OPERATE WITH ANY OTHER PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE 
POSSIBILITY OF SUCH DAMAGES.
<p>
<hr />
<p>

<center>
<div id="LGPL">GNU LESSER GENERAL PUBLIC LICENSE</div>
</center>
<p>
Version 2.1, February 1999
<p>
Copyright (C) 1991, 1999 Free Software Foundation, Inc.
51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
Everyone is permitted to copy and distribute verbatim copies
of this license document, but changing it is not allowed.
<p>
[This is the first released version of the Lesser GPL.  It also counts
 as the successor of the GNU Library Public License, version 2, hence
 the version number 2.1.]
<p>
Preamble
<p>
The licenses for most software are designed to take away your freedom to share and change it. By contrast, the GNU General Public Licenses are intended to guarantee your freedom to share and change free software--to make sure the software is free for all its users.
<p>
This license, the Lesser General Public License, applies to some specially designated software packages--typically libraries--of the Free Software Foundation and other authors who decide to use it. You can use it too, but we suggest you first think carefully about whether this license or the ordinary General Public License is the better strategy to use in any particular case, based on the explanations below.
<p>
When we speak of free software, we are referring to freedom of use, not price. Our General Public Licenses are designed to make sure that you have the freedom to distribute copies of free software (and charge for this service if you wish); that you receive source code or can get it if you want it; that you can change the software and use pieces of it in new free programs; and that you are informed that you can do these things.
<p>
To protect your rights, we need to make restrictions that forbid distributors to deny you these rights or to ask you to surrender these rights. These restrictions translate to certain responsibilities for you if you distribute copies of the library or if you modify it.
<p>
For example, if you distribute copies of the library, whether gratis or for a fee, you must give the recipients all the rights that we gave you. You must make sure that they, too, receive or can get the source code. If you link other code with the library, you must provide complete object files to the recipients, so that they can relink them with the library after making changes to the library and recompiling it. And you must show them these terms so they know their rights.
<p>
We protect your rights with a two-step method: (1) we copyright the library, and (2) we offer you this license, which gives you legal permission to copy, distribute and/or modify the library.
<p>
To protect each distributor, we want to make it very clear that there is no warranty for the free library. Also, if the library is modified by someone else and passed on, the recipients should know that what they have is not the original version, so that the original author's reputation will not be affected by problems that might be introduced by others.
<p>
Finally, software patents pose a constant threat to the existence of any free program. We wish to make sure that a company cannot effectively restrict the users of a free program by obtaining a restrictive license from a patent holder. Therefore, we insist that any patent license obtained for a version of the library must be consistent with the full freedom of use specified in this license.
<p>
Most GNU software, including some libraries, is covered by the ordinary GNU General Public License. This license, the GNU Lesser General Public License, applies to certain designated libraries, and is quite different from the ordinary General Public License. We use this license for certain libraries in order to permit linking those libraries into non-free programs.
<p>
When a program is linked with a library, whether statically or using a shared library, the combination of the two is legally speaking a combined work, a derivative of the original library. The ordinary General Public License therefore permits such linking only if the entire combination fits its criteria of freedom. The Lesser General Public License permits more lax criteria for linking other code with the library.
<p>
We call this license the "Lesser" General Public License because it does Less to protect the user's freedom than the ordinary General Public License. It also provides other free software developers Less of an advantage over competing non-free programs. These disadvantages are the reason we use the ordinary General Public License for many libraries. However, the Lesser license provides advantages in certain special circumstances.
<p>
For example, on rare occasions, there may be a special need to encourage the widest possible use of a certain library, so that it becomes a de-facto standard. To achieve this, non-free programs must be allowed to use the library. A more frequent case is that a free library does the same job as widely used non-free libraries. In this case, there is little to gain by limiting the free library to free software only, so we use the Lesser General Public License.
<p>
In other cases, permission to use a particular library in non-free programs enables a greater number of people to use a large body of free software. For example, permission to use the GNU C Library in non-free programs enables many more people to use the whole GNU operating system, as well as its variant, the GNU/Linux operating system.
<p>
Although the Lesser General Public License is Less protective of the users' freedom, it does ensure that the user of a program that is linked with the Library has the freedom and the wherewithal to run that program using a modified version of the Library.
<p>
The precise terms and conditions for copying, distribution and modification follow. Pay close attention to the difference between a "work based on the library" and a "work that uses the library". The former contains code derived from the library, whereas the latter must be combined with the library in order to run.
<p>
TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION
<p>
0. This License Agreement applies to any software library or other program which contains a notice placed by the copyright holder or other authorized party saying it may be distributed under the terms of this Lesser General Public License (also called "this License"). Each licensee is addressed as "you".
<p>
A "library" means a collection of software functions and/or data prepared so as to be conveniently linked with application programs (which use some of those functions and data) to form executables.
<p>
The "Library", below, refers to any such software library or work which has been distributed under these terms. A "work based on the Library" means either the Library or any derivative work under copyright law: that is to say, a work containing the Library or a portion of it, either verbatim or with modifications and/or translated straightforwardly into another language. (Hereinafter, translation is included without limitation in the term "modification".)
<p>
"Source code" for a work means the preferred form of the work for making modifications to it. For a library, complete source code means all the source code for all modules it contains, plus any associated interface definition files, plus the scripts used to control compilation and installation of the library.
<p>
Activities other than copying, distribution and modification are not covered by this License; they are outside its scope. The act of running a program using the Library is not restricted, and output from such a program is covered only if its contents constitute a work based on the Library (independent of the use of the Library in a tool for writing it). Whether that is true depends on what the Library does and what the program that uses the Library does.
<p>
1. You may copy and distribute verbatim copies of the Library's complete source code as you receive it, in any medium, provided that you conspicuously and appropriately publish on each copy an appropriate copyright notice and disclaimer of warranty; keep intact all the notices that refer to this License and to the absence of any warranty; and distribute a copy of this License along with the Library.
<p>
You may charge a fee for the physical act of transferring a copy, and you may at your option offer warranty protection in exchange for a fee.
<p>
2. You may modify your copy or copies of the Library or any portion of it, thus forming a work based on the Library, and copy and distribute such modifications or work under the terms of Section 1 above, provided that you also meet all of these conditions:
<p>
a) The modified work must itself be a software library.
<p>
b) You must cause the files modified to carry prominent notices stating that you changed the files 
and the date of any change.
<p>
c) You must cause the whole of the work to be licensed at no charge to all third parties under the 
terms of this License.
<p>
d) If a facility in the modified Library refers to a function or a table of data to be supplied by 
an application program that uses the facility, other than as an argument passed when the facility 
is invoked, then you must make a good faith effort to ensure that, in the event an application does 
not supply such function or table, the facility still operates, and performs whatever part of its 
purpose remains meaningful.
<p>
(For example, a function in a library to compute square roots has a purpose that is entirely well-defined independent of the application. Therefore, Subsection 2d requires that any application-supplied function or table used by this function must be optional: if the application does not supply it, the square root function must still compute square roots.)
<p>
These requirements apply to the modified work as a whole. If identifiable sections of that work are not derived from the Library, and can be reasonably considered independent and separate works in themselves, then this License, and its terms, do not apply to those sections when you distribute them as separate works. But when you distribute the same sections as part of a whole which is a work based on the Library, the distribution of the whole must be on the terms of this License, whose permissions for other licensees extend to the entire whole, and thus to each and every part regardless of who wrote it.
<p>
Thus, it is not the intent of this section to claim rights or contest your rights to work written entirely by you; rather, the intent is to exercise the right to control the distribution of derivative or collective works based on the Library.
<p>
In addition, mere aggregation of another work not based on the Library with the Library (or with a work based on the Library) on a volume of a storage or distribution medium does not bring the other work under the scope of this License.
<p>
3. You may opt to apply the terms of the ordinary GNU General Public License instead of this License to a given copy of the Library. To do this, you must alter all the notices that refer to this License, so that they refer to the ordinary GNU General Public License, version 2, instead of to this License. (If a newer version than version 2 of the ordinary GNU General Public License has appeared, then you can specify that version instead if you wish.) Do not make any other change in these notices.
<p>
Once this change is made in a given copy, it is irreversible for that copy, so the ordinary GNU General Public License applies to all subsequent copies and derivative works made from that copy.
<p>
This option is useful when you wish to copy part of the code of the Library into a program that is not a library.
<p>
4. You may copy and distribute the Library (or a portion or derivative of it, under Section 2) in object code or executable form under the terms of Sections 1 and 2 above provided that you accompany it with the complete corresponding machine-readable source code, which must be distributed under the terms of Sections 1 and 2 above on a medium customarily used for software interchange.
<p>
If distribution of object code is made by offering access to copy from a designated place, then offering equivalent access to copy the source code from the same place satisfies the requirement to distribute the source code, even though third parties are not compelled to copy the source along with the object code.
<p>
5. A program that contains no derivative of any portion of the Library, but is designed to work with the Library by being compiled or linked with it, is called a "work that uses the Library". Such a work, in isolation, is not a derivative work of the Library, and therefore falls outside the scope of this License.
<p>
However, linking a "work that uses the Library" with the Library creates an executable that is a derivative of the Library (because it contains portions of the Library), rather than a "work that uses the library". The executable is therefore covered by this License. Section 6 states terms for distribution of such executables.
<p>
When a "work that uses the Library" uses material from a header file that is part of the Library, the object code for the work may be a derivative work of the Library even though the source code is not. Whether this is true is especially significant if the work can be linked without the Library, or if the work is itself a library. The threshold for this to be true is not precisely defined by law.
<p>
If such an object file uses only numerical parameters, data structure layouts and accessors, and small macros and small inline functions (ten lines or less in length), then the use of the object file is unrestricted, regardless of whether it is legally a derivative work. (Executables containing this object code plus portions of the Library will still fall under Section 6.)
<p>
Otherwise, if the work is a derivative of the Library, you may distribute the object code for the work under the terms of Section 6. Any executables containing that work also fall under Section 6, whether or not they are linked directly with the Library itself.
<p>
6. As an exception to the Sections above, you may also combine or link a "work that uses the Library" with the Library to produce a work containing portions of the Library, and distribute that work under terms of your choice, provided that the terms permit modification of the work for the customer's own use and reverse engineering for debugging such modifications.
<p>
You must give prominent notice with each copy of the work that the Library is used in it and that the Library and its use are covered by this License. You must supply a copy of this License. If the work during execution displays copyright notices, you must include the copyright notice for the Library among them, as well as a reference directing the user to the copy of this License. Also, you must do one of these things:
<p>
a) Accompany the work with the complete corresponding machine-readable source code for the Library including whatever changes were used in the work (which must be distributed under Sections 1 and 2 above); and, if the work is an executable linked with the Library, with the complete machine-readable "work that uses the Library", as object code and/or source code, so that the user can modify the Library and then relink to produce a modified executable containing the modified Library. (It is understood that the user who changes the contents of definitions files in the Library will not necessarily be able to recompile the application to use the modified definitions.)
<p>
b) Use a suitable shared library mechanism for linking with the Library. A suitable mechanism is one that (1) uses at run time a copy of the library already present on the user's computer system, rather than copying library functions into the executable, and (2) will operate properly with a modified version of the library, if the user installs one, as long as the modified version is interface-compatible with the version that the work was made with.
<p>
c) Accompany the work with a written offer, valid for at least three years, to give the same user the materials specified in Subsection 6a, above, for a charge no more than the cost of performing this distribution.
<p>
d) If distribution of the work is made by offering access to copy from a designated place, offer equivalent access to copy the above specified materials from the same place.
<p>
e) Verify that the user has already received a copy of these materials or that you have already sent this user a copy.
<p>
For an executable, the required form of the "work that uses the Library" must include any data and utility programs needed for reproducing the executable from it. However, as a special exception, the materials to be distributed need not include anything that is normally distributed (in either source or binary form) with the major components (compiler, kernel, and so on) of the operating system on which the executable runs, unless that component itself accompanies the executable.
<p>
It may happen that this requirement contradicts the license restrictions of other proprietary libraries that do not normally accompany the operating system. Such a contradiction means you cannot use both them and the Library together in an executable that you distribute.
<p>
7. You may place library facilities that are a work based on the Library side-by-side in a single library together with other library facilities not covered by this License, and distribute such a combined library, provided that the separate distribution of the work based on the Library and of the other library facilities is otherwise permitted, and provided that you do these two things:
<p>
a) Accompany the combined library with a copy of the same work based on the Library, uncombined with any other library facilities. This must be distributed under the terms of the Sections above.
<p>
b) Give prominent notice with the combined library of the fact that part of it is a work based on the Library, and explaining where to find the accompanying uncombined form of the same work.
<p>
8. You may not copy, modify, sublicense, link with, or distribute the Library except as expressly provided under this License. Any attempt otherwise to copy, modify, sublicense, link with, or distribute the Library is void, and will automatically terminate your rights under this License. However, parties who have received copies, or rights, from you under this License will not have their licenses terminated so long as such parties remain in full compliance.
<p>
9. You are not required to accept this License, since you have not signed it. However, nothing else grants you permission to modify or distribute the Library or its derivative works. These actions are prohibited by law if you do not accept this License. Therefore, by modifying or distributing the Library (or any work based on the Library), you indicate your acceptance of this License to do so, and all its terms and conditions for copying, distributing or modifying the Library or works based on it.
<p>
10. Each time you redistribute the Library (or any work based on the Library), the recipient automatically receives a license from the original licensor to copy, distribute, link with or modify the Library subject to these terms and conditions. You may not impose any further restrictions on the recipients' exercise of the rights granted herein. You are not responsible for enforcing compliance by third parties with this License.
<p>
11. If, as a consequence of a court judgment or allegation of patent infringement or for any other reason (not limited to patent issues), conditions are imposed on you (whether by court order, agreement or otherwise) that contradict the conditions of this License, they do not excuse you from the conditions of this License. If you cannot distribute so as to satisfy simultaneously your obligations under this License and any other pertinent obligations, then as a consequence you may not distribute the Library at all. For example, if a patent license would not permit royalty-free redistribution of the Library by all those who receive copies directly or indirectly through you, then the only way you could satisfy both it and this License would be to refrain entirely from distribution of the Library.
<p>
If any portion of this section is held invalid or unenforceable under any particular circumstance, the balance of the section is intended to apply, and the section as a whole is intended to apply in other circumstances.
<p>
It is not the purpose of this section to induce you to infringe any patents or other property right claims or to contest validity of any such claims; this section has the sole purpose of protecting the integrity of the free software distribution system which is implemented by public license practices. Many people have made generous contributions to the wide range of software distributed through that system in reliance on consistent application of that system; it is up to the author/donor to decide if he or she is willing to distribute software through any other system and a licensee cannot impose that choice.
<p>
This section is intended to make thoroughly clear what is believed to be a consequence of the rest of this License.
<p>
12. If the distribution and/or use of the Library is restricted in certain countries either by patents or by copyrighted interfaces, the original copyright holder who places the Library under this License may add an explicit geographical distribution limitation excluding those countries, so that distribution is permitted only in or among countries not thus excluded. In such case, this License incorporates the limitation as if written in the body of this License.
<p>
13. The Free Software Foundation may publish revised and/or new versions of the Lesser General Public License from time to time. Such new versions will be similar in spirit to the present version, but may differ in detail to address new problems or concerns.
<p>
Each version is given a distinguishing version number. If the Library specifies a version number of this License which applies to it and "any later version", you have the option of following the terms and conditions either of that version or of any later version published by the Free Software Foundation. If the Library does not specify a license version number, you may choose any version ever published by the Free Software Foundation.
<p>
14. If you wish to incorporate parts of the Library into other free programs whose distribution conditions are incompatible with these, write to the author to ask for permission. For software which is copyrighted by the Free Software Foundation, write to the Free Software Foundation; we sometimes make exceptions for this. Our decision will be guided by the two goals of preserving the free status of all derivatives of our free software and of promoting the sharing and reuse of software generally.
<p>
NO WARRANTY
<p>
15. BECAUSE THE LIBRARY IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY FOR THE LIBRARY, TO THE EXTENT PERMITTED BY APPLICABLE LAW. EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES PROVIDE THE LIBRARY "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE LIBRARY IS WITH YOU. SHOULD THE LIBRARY PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR CORRECTION.
<p>
16. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR REDISTRIBUTE THE LIBRARY AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE THE LIBRARY (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A FAILURE OF THE LIBRARY TO OPERATE WITH ANY OTHER SOFTWARE), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.
<p>
<p>
<hr />
<p>

<center>
<div id="RASLIC">RasMol License</div>
</center>
<p>
Creative endeavors depend on the lively exchange of ideas. There are laws and customs that establish rights and responsibilities for authors and the users of what authors create. This notice is not intended to prevent you from using the software and documents in this package, but to ensure that there are no misunderstandings about terms and conditions of such use.
<p>
Please read the following notice carefully. If you do not understand any portion of this notice, please seek appropriate professional legal advice before making use of the software and documents included in this software package. In addition to whatever other steps you may be obliged to take to respect the intellectual property rights of the various parties involved, if you do make use of the software and documents in this package, please give credit where credit is due by citing this package, its authors and the URL or other source from which you obtained it, or equivalent primary references in the literature with the same authors.
<p>
Some of the software and documents included within this software package are the intellectual property of various parties, and placement in this package does not in any way imply that any such rights have in any way been waived or diminished.
<p>
With respect to any software or documents for which a copyright exists, ALL
RIGHTS ARE RESERVED TO THE OWNERS OF SUCH COPYRIGHT.
<p>
Even though the authors of the various documents and software found here have made a good faith effort to ensure that the documents are correct and that the software performs according to its documentation, and we would greatly appreciate hearing of any problems you may encounter, the programs and documents any files created by the programs are provided AS IS without any warrantee as to correctness, merchantability or fitness for any particular or general use.
<p>
THE RESPONSIBILITY FOR ANY ADVERSE CONSEQUENCES FROM THE USE OF PROGRAMS OR DOCUMENTS OR ANY FILE OR FILES CREATED
<p>
BY USE OF THE PROGRAMS OR DOCUMENTS LIES SOLELY WITH THE USERS OF THE PROGRAMS OR DOCUMENTS OR FILE OR FILES AND NOT WITH AUTHORS OF THE PROGRAMS OR DOCUMENTS.
<p>
<p>
<hr />
<p>
<center>
<div id="IUCR_POLICY">The IUCr Policy Use of the Crystallographic Information File (CIF)<br />
on the
(Reproduced with permission from the IUCr Web Page)</div>
</center>
<p>
The Crystallographic Information File [Hall, Allen, Brown  91] is, as of January
1992, the recommended method for submitting publications to Acta Crystallographica Section C. The International Union of Crystallography holds the Copyright on the CIF, and has applied for Patents on the STAR File syntax which is the basis for the CIF format.
<p>
It is a principal objective of the IUCr to promote the use of CIF for the exchange and storage of scientific data. The IUCr's sponsorship of the CIF development was motivated by its responsibility to its scientific journals, which set the standards in crystallographic publishing. The IUCr intends that CIFs will be used increasingly for electronic submission of manuscripts to these journals in future. The IUCr recognises that, if the CIF and the STAR File are to be adopted as a means for universal data exchange, the syntax of these files must be strictly and uniformly adhered to. Even small deviations from the syntax would ultimately cause the demise of the universal file concept. Through its Copyrights and Patents the IUCr has taken the steps needed to ensure strict conformance with this syntax.
<p>
The IUCr policy on the use of the CIF and STAR File processes is as follows:
<p>
<ul>
<li>1 CIFs and STAR Files may be generated, stored or transmitted, withoutpermission or charge, 
provided their purpose is not specifically for profit or commercial gain, and provided that the published syntax is strictly adhered to.
</li>
<li>
2 Computer software may be developed for use with CIFs or STAR files,without permission or charge, 
provided it is distributed in the public domain. This condition also applies to software for which 
a charge is made, provided that its primary function is for use with files that satisfy condition 
1 and that it is distributed as a minor component of a larger package of software.
</li>
<li>
3 Permission will be granted for the use of CIFs and STAR Files forspecific commercial purposes 
(such as databases or network exchange processes), and for the distribution of commercial 
CIF/STAR software, on written application to the IUCr Executive Secretary, 2 Abbey Square, 
Chester CH1 2HU, England. The nature, terms and duration of the licences granted will be 
determined by the IUCr Executive and Finance Committees.
</li>
</ul>
<p>
In summary, the IUCr wishes to promote the use of the STAR File concepts as a standard universal 
data file. It will insist on strict compliance with the published syntax for all applications. To 
assist with this compliance, the IUCr provides public domain software for checking the logical 
integrity of a CIF, and for validating the data name definitions contained within a CIF. Detailed 
information on this software, and the associated dictionaries, may be obtained from the IUCr 
Office at 5 Abbey Square, Chester CH1 2HU, England.
<p>
<hr />
</font>
</body>
</html>
